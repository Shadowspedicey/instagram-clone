{"version":3,"sources":["state/reducers/isLoading.js","state/reducers/currentUser.js","state/reducers/snackbar.js","state/reducers/newPost.js","state/reducers/index.js","state/index.js","firebase.js","state/actions/snackbar.js","state/actions/newPost.js","assets/namelogo.png","assets/logo.png","assets/misc/loading.jpg","components/Navbar.js","state/actions/isLoading.js","components/LoadingPage.js","state/actions/currentUser.js","components/AccountAuth/ErrorMsg.js","assets/misc/email-verification.png","components/AccountAuth/SignUpPage.js","assets/misc/green-checkmark.png","components/AccountAuth/PasswordReset.js","assets/misc/lock.png","components/AccountAuth/LoginPage.js","assets/misc/red-x.png","components/AccountAuth/AccountVerification.js","components/FollowButton.js","components/VerifiedTick.js","components/FollowWindow.js","components/Posts/Like.js","components/Posts/Comment.js","components/Posts/Save.js","components/Posts/PostWindow.js","components/HomePage.js","components/Posts/PostCard.js","components/UserProfile.js","components/Posts/NewPost.js","components/Posts/PostPage.js","components/Inbox/Message.js","components/Inbox/Room.js","components/Inbox/Inbox.js","components/AccountEdit/ChangePassword.js","components/AccountEdit/EditProfile.js","components/AccountEdit/AccountEdit.js","App.js","index.js"],"names":["isLoading","state","action","type","currentUser","payload","defaultState","message","severity","open","snackbar","newPost","file","root","combineReducers","loading","isLoadingReducer","currentUserReducer","snackbarReducer","newPostReducer","store","createStore","rootReducer","window","__REDUX_DEVTOOLS_EXTENSION__","trace","app","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","db","getAnalytics","getFirestore","auth","getAuth","storage","getStorage","setSnackbar","setNewPost","Searchbar","dispatch","useDispatch","useSelector","useState","setIsLoading","usersCache","setUsersCache","options","setOptions","setOpen","inputValue","setInputValue","addToRecentSearches","uid","a","updateDoc","doc","user","timestamp","serverTimestamp","showRecentSearches","getDoc","then","Object","values","data","recentSearches","unformattedRecentSearches","sort","b","seconds","Promise","all","map","console","error","removeFromRecentSearches","e","stopPropagation","preventDefault","filter","option","deleteField","handleInputChange","newInput","target","value","users","length","getDocs","collection","docs","forEach","push","username","includes","slice","onOutsideClick","className","placeholder","onFocus","onChange","onClick","err","src","Loading","alt","to","profilePic","style","display","verified","title","realName","xmlns","fill","viewBox","d","Navbar","history","useHistory","addPostButton","useRef","info","isDropdownOpen","setIsDropdownOpen","playDropdownClose","setPlayDropdownClose","phoneQuery","useMediaQuery","query","closeDropdown","setTimeout","logOut","signOut","id","Logo","nameLogo","current","click","accept","ref","input","postPhoto","files","fillRule","clipRule","LoadingPage","setUser","ErrorMsg","props","text","SignUpPage","emailRef","realNameRef","usernameRef","passwordRef","isInfoValid","setInfoValid","emailVerificationTime","setEmailVerificationTime","verificationInterval","setVerificationInterval","errorMsg","setErrorMsg","useEffect","document","clearInterval","checkForm","emailValue","trim","match","checkEmail","checkFormWithDB","_username","resolve","usersRef","q","where","querySnapshot","handleSubmit","email","toLowerCase","password","createUserWithEmailAndPassword","defaultProfilePic","bio","saved","userDocRef","setDoc","sendEmailVerification","runEmailVerification","errorCode","code","setInterval","reload","emailVerified","emailVerificationIcon","fontWeight","color","onSubmit","PasswordReset","setIsInfoValid","isEmailSent","setIsEmailSent","sendPasswordResetEmail","greenCheckmark","LoginPage","signInWithEmailAndPassword","sendEmail","AccountVerification","mode","setMode","actionCode","setActionCode","status","setStatus","confirmPasswordRef","passwordResetDone","setPasswordResetDone","passwordResetEmail","setPasswordResetEmail","handleVerifyEmail","applyActionCode","ok","checkPassword","checkConfirmPassword","handleFormSubmitPassword","newPassword","confirmPasswordReset","handlePasswordReset","verifyPasswordResetCode","getParameterByName","handleLink","name","replace","results","RegExp","exec","location","href","decodeURIComponent","redX","FollowButton","isFollowing","setIsFollowing","following","checkIfFollowing","follow","alert","onbeforeunload","addToUsersFollowing","addToTargetsFollowers","unfollow","removeFromUsersFollowing","removeFromTargetsFollowers","userRefFollowing","runTransaction","t","get","sfDoc","exists","Error","newFollowingArray","update","merge","targetRefFollowers","followers","newFollowersArray","VerifiedTick","size","marginLeft","marginRight","width","height","FollowWindow","uids","closeFollowListWindow","newMessage","list","setList","uidToNumbers","split","char","Number","isInteger","parseInt","Math","abs","charCodeAt","join","getRoomID","targetUid","currentUserUID","targetUserUID","handleStartChat","roomID","members","getUidsInfo","n","person","startLoading","stopLoading","Like","postPath","isComment","isLiked","setIsLiked","likes","checkIfLiked","like","arrayUnion","unlike","arrayRemove","Comment","commentData","noPhoto","noTimestamp","noLike","noLikesCounter","noRemove","setLikesWindow","isCaption","refreshComments","commenterInfo","setCommenterInfo","getCommenterInfo","commenterUid","removeComment","deleteDoc","setInfo","paddingRight","comment","format","fromUnixTime","formatDistanceToNowStrict","Save","isSaved","setIsSaved","checkIfSaved","save","unsave","PostWindow","postID","isVertical","useLocation","addComment","userInfo","setUserInfo","setPostPath","postData","setPostData","comments","setComments","commentLoading","setCommentLoading","isDialogBoxOpen","setIsDialogBoxOpen","closeDialogBox","likesWindow","getUserData","userData","getPostComments","path","handleAddComment","nanoid","handleTextareaEnter","keyCode","shiftKey","deletePost","collectionGroup","postDoc","getData","pathname","navigator","clipboard","writeText","origin","photo","caption","fontSize","Date","getTime","getYear","onKeyDown","HomePage","postsRef","maxDate","setMaxDate","scroll","setScroll","olderPosts","setOlderPosts","postsToDisplay","setPostsToDisplay","setLeft","setNewLeft","getComputedStyle","handleScroll","winScroll","body","scrollTop","documentElement","scrollHeight","clientHeight","currentUserFollowing","maximumDate","posts","getPosts","getOlderPosts","addEventListener","removeEventListener","onLoad","post","PostCard","isHovered","setIsHovered","getPostData","commentsData","onMouseOver","onMouseLeave","position","inset","margin","UserProfile","useParams","userFollows","setUserFollows","userPosts","setUserPosts","isFollowingListWindowOpen","setIsFollowingListWindowOpen","isFollowersListWindowOpen","setIsFollowersListWindowOpen","getUserInfo","getUsersFollows","assign","getUsersPosts","fetchUserInfo","exact","activeClassName","foo","createImage","url","reject","image","Image","setAttribute","getRadianAngle","degreeValue","PI","getCroppedImg","imageSrc","pixelCrop","rotation","canvas","createElement","ctx","getContext","maxSize","max","safeArea","sqrt","translate","rotate","drawImage","getImageData","putImageData","round","x","y","toBlob","NewPost","photoUrl","setPhotoUrl","crop","setCrop","zoom","setZoom","setRotation","croppedAreaPixels","setCroppedAreaPixels","reader","FileReader","readAsDataURL","onloadend","result","captionRef","getState","share","croppedPhoto","postPhotoRef","uploadBytes","getDownloadURL","postUrl","zoomSpeed","onCropChange","onZoomChange","onRotationChange","onCropComplete","croppedArea","aspect","PostPage","postExists","setPostExists","morePosts","setMorePosts","isSmallScreen","setIsSmallScreen","handleResize","innerWidth","checkIfPostExists","getMorePosts","limit","Message","messageInfo","isSent","Room","messageRef","otherUser","setOtherUser","messages","setMessages","getOtherUserInfo","roomInfo","otherUserUid","member","getMessages","orderBy","messagesArray","sendMessage","lastMessage","lastUpdated","unsubscribe","onSnapshot","alignItems","i","Inbox","currentUserFollows","setCurrentUserFollows","recentChats","setRecentChats","isNewMessageBoxOpen","setIsNewMessageBoxOpen","closeNewMessageBox","formatDate","date","dateStringArray","getChats","chats","chat","ChangePassword","oldPasswordRef","newPasswordRef","handleOnChange","oldPassword","confirmPassword","credentials","EmailAuthProvider","credential","reauthenticateWithCredential","updatePassword","htmlFor","EditProfile","isPhotoLoading","setIsPhotoLoading","isPhotoChangerBoxOpen","setIsPhotoChangerBoxOpen","uploadRef","nameRef","bioRef","openPhotoBox","openPhotoUpload","closePhotoBox","removePhoto","updateUserLocally","uploadPhoto","uploadedPhoto","photoRef","uploadedPhotoURL","handleChange","handleNameChange","handleUsernameChange","handleBioChange","handleEmailChange","updateEmail","defaultValue","AccountEdit","component","App","navbarVisibility","setNavbarVisibility","isLoggedIn","handleClose","onAuthStateChanged","paddingTop","Snackbar","autoHideDuration","onClose","anchorOrigin","vertical","horizontal","TransitionComponent","Slide","Alert","icon","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.b5c886ce.chunk.js","sourcesContent":["const isLoading = (state = true, action) =>\r\n{\r\n\tswitch (action.type)\r\n\t{\r\n\t\tcase \"START_LOADING\":\r\n\t\t\treturn state = true;\r\n\r\n\t\tcase \"STOP_LOADING\":\r\n\t\t\treturn state = false;\r\n\t\t\t\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n};\r\n\r\nexport default isLoading;\r\n","const currentUser = (state = null, action) =>\r\n{\r\n\tswitch (action.type)\r\n\t{\r\n\t\tcase \"SET_CURRENT_USER\":\r\n\t\t\treturn state = action.payload;\r\n\r\n\t\tcase \"SIGN_OUT\":\r\n\t\t\treturn state = null;\r\n\t\t\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n};\r\n\r\nexport default currentUser;\r\n","const defaultState =\r\n{\r\n\tmessage: \"Empty\", \r\n\tseverity: \"success\",\r\n\topen: false,\r\n};\r\n\r\nconst snackbar = (state = defaultState, action) =>\r\n{\r\n\tswitch (action.type)\r\n\t{\r\n\t\tcase \"SET_SNACKBAR\":\r\n\t\t\treturn state =\r\n\t\t\t{\r\n\t\t\t\tmessage: action.payload.message,\r\n\t\t\t\tseverity: action.payload.severity,\r\n\t\t\t\topen: true,\r\n\t\t\t};\r\n\r\n\t\tcase \"OPEN_SNACKBAR\":\r\n\t\t\treturn state = {...state, open: true};\r\n\r\n\t\tcase \"CLOSE_SNACKBAR\":\r\n\t\t\treturn state = {...state, open: false};\r\n\t\t\t\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n};\r\n\r\nexport default snackbar;\r\n","const newPost = (state = null, action) =>\r\n{\r\n\tswitch (action.type)\r\n\t{\r\n\t\tcase \"SET_NEW_POST\":\r\n\t\t\treturn state = action.payload.file;\r\n\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n};\r\n\r\nexport default newPost;\r\n","import { combineReducers } from \"redux\";\r\nimport isLoadingReducer from \"./isLoading\";\r\nimport currentUserReducer from \"./currentUser\";\r\nimport snackbarReducer from \"./snackbar\";\r\nimport newPostReducer from \"./newPost\";\r\n\r\nconst root = combineReducers(\r\n\t{\r\n\t\tloading: isLoadingReducer,\r\n\t\tcurrentUser: currentUserReducer,\r\n\t\tsnackbar: snackbarReducer,\r\n\t\tnewPost: newPostReducer,\r\n\t}\r\n);\r\n\r\nexport default root;\r\n","import { createStore } from \"redux\";\r\nimport rootReducer from \"./reducers\";\r\n\r\nconst store = createStore(rootReducer, window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__({ trace: true }));\r\n\r\nexport default store;\r\n","import { initializeApp } from \"firebase/app\";\r\nimport { getAnalytics } from \"firebase/analytics\";\r\nimport { getFirestore } from \"firebase/firestore\";\r\nimport { getAuth } from \"firebase/auth\";\r\nimport { getStorage } from \"firebase/storage\";\r\n\r\nconst firebaseConfig =\r\n{\r\n\tapiKey: \"AIzaSyAKrGd-3EdtXZUrsR9H3MOL-mTUS2XjDt8\",\r\n\tauthDomain: \"instadicey.firebaseapp.com\",\r\n\tprojectId: \"instadicey\",\r\n\tstorageBucket: \"instadicey.appspot.com\",\r\n\tmessagingSenderId: \"534824914170\",\r\n\tappId: \"1:534824914170:web:563f979c0b305ebbc54d43\",\r\n\tmeasurementId: \"G-VJDYJCZNQJ\",\r\n};\r\n\r\nexport const app = initializeApp(firebaseConfig);\r\nexport const analytics = getAnalytics(app);\r\nexport const db = getFirestore(app);\r\nexport const auth = getAuth(app);\r\nexport const storage = getStorage(app);\r\n","export const setSnackbar = (message, severity) =>\r\n{\r\n\treturn {\r\n\t\ttype: \"SET_SNACKBAR\",\r\n\t\tpayload:\r\n\t\t{\r\n\t\t\tmessage,\r\n\t\t\tseverity,\r\n\t\t}\r\n\t};\r\n};\r\n\r\nexport const closeSnackbar = () =>\r\n{\r\n\treturn {\r\n\t\ttype: \"CLOSE_SNACKBAR\",\r\n\t};\r\n};\r\n","export const setNewPost = file =>\r\n{\r\n\treturn {\r\n\t\ttype: \"SET_NEW_POST\",\r\n\t\tpayload:\r\n\t\t{\r\n\t\t\tfile,\r\n\t\t}\r\n\t};\r\n};\r\n","export default __webpack_public_path__ + \"static/media/namelogo.37ef1c08.png\";","export default __webpack_public_path__ + \"static/media/logo.d4e48eb0.png\";","export default __webpack_public_path__ + \"static/media/loading.42aaa181.jpg\";","import { useRef, useState } from \"react\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { auth, db } from \"../firebase\";\r\nimport { signOut } from \"@firebase/auth\";\r\nimport { collection, deleteField, doc, getDoc, getDocs, serverTimestamp,  updateDoc } from \"@firebase/firestore\";\r\nimport OutsideClickHandler from \"react-outside-click-handler\";\r\nimport { useMediaQuery } from \"react-responsive\";\r\nimport { startLoading, stopLoading } from \"../state/actions/isLoading\";\r\nimport { setSnackbar } from \"../state/actions/snackbar\";\r\nimport { setNewPost } from \"../state/actions/newPost\";\r\nimport nameLogo from \"../assets/namelogo.png\";\r\nimport Logo from \"../assets/logo.png\";\r\nimport Loading from \"../assets/misc/loading.jpg\";\r\n\r\nconst Navbar = () =>\r\n{\r\n\tconst history = useHistory();\r\n\tconst dispatch = useDispatch();\r\n\tconst addPostButton = useRef();\r\n\tconst { username, profilePic } = useSelector(state => state.currentUser.info) || \"\";\r\n\tconst [isDropdownOpen, setIsDropdownOpen] = useState(false);\r\n\tconst [playDropdownClose, setPlayDropdownClose] = useState(false);\r\n\tconst phoneQuery = useMediaQuery({query: \"(max-width: 600px)\"});\r\n\r\n\tconst handleNewPostChange = input =>\r\n\t{\r\n\t\tconst postPhoto = input.target.files[0];\r\n\t\taddPostButton.current.value = null;\r\n\t\tdispatch(setNewPost(postPhoto));\r\n\t\thistory.push(\"/create/style\");\r\n\t};\r\n\r\n\tconst openDropdown = () => setIsDropdownOpen(true);\r\n\tconst closeDropdown = e =>\r\n\t{\r\n\t\te.stopPropagation();\r\n\t\tsetPlayDropdownClose(true);\r\n\t\tsetTimeout(() => { setIsDropdownOpen(false); setPlayDropdownClose(false); }, 125);\r\n\t};\r\n\t\r\n\tconst logOut = async () =>\r\n\t{\r\n\t\tdispatch(startLoading());\r\n\t\tawait signOut(auth);\r\n\t\thistory.push(\"/\");\r\n\t\tdispatch(stopLoading());\r\n\t};\r\n\r\n\treturn(\r\n\t\t<nav id=\"main-navbar\">\r\n\t\t\t<div className=\"logo\"><Link to=\"/\"><img src={phoneQuery ? Logo : nameLogo} alt=\"Instadicey\"></img></Link></div>\r\n\t\t\t<li><Searchbar/></li>\r\n\t\t\t<ul>\r\n\t\t\t\t<li><button className=\"add-post icon\" onClick={() => addPostButton.current.click()}><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M24 10h-10v-10h-4v10h-10v4h10v10h4v-10h10z\"/></svg></button></li>\r\n\t\t\t\t<input accept=\"image/png, image/jpg, image/jpeg, image/pjpeg, image/jfif, image/pjp\" type=\"file\" ref={addPostButton} onChange={handleNewPostChange}></input>\r\n\t\t\t\t<li><Link to=\"/\" className=\"icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M21 13v10h-6v-6h-6v6h-6v-10h-3l12-12 12 12h-3zm-1-5.907v-5.093h-3v2.093l3 3z\"/></svg></Link></li>\r\n\t\t\t\t<li><Link to=\"/direct/inbox\" className=\"icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M12 12.713l-11.985-9.713h23.97l-11.985 9.713zm0 2.574l-12-9.725v15.438h24v-15.438l-12 9.725z\"/></svg></Link></li>\r\n\t\t\t\t<li className=\"profile\" onClick={openDropdown}>\r\n\t\t\t\t\t<div className=\"icon\"><img src={profilePic} alt=\"Profile Pic\"></img></div>\r\n\t\t\t\t\t{ isDropdownOpen &&\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<div className=\"dropdown-container\" onClick={closeDropdown}></div>\r\n\t\t\t\t\t\t\t<div className={`dropdown outlined ${playDropdownClose ? \"closed\" : \"\"}`}>\r\n\t\t\t\t\t\t\t\t<span className=\"arrow\"></span>\r\n\t\t\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t<Link to={`/${username}`} onClick={closeDropdown}>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg className=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M12 0c6.623 0 12 5.377 12 12s-5.377 12-12 12-12-5.377-12-12 5.377-12 12-12zm8.127 19.41c-.282-.401-.772-.654-1.624-.85-3.848-.906-4.097-1.501-4.352-2.059-.259-.565-.19-1.23.205-1.977 1.726-3.257 2.09-6.024 1.027-7.79-.674-1.119-1.875-1.734-3.383-1.734-1.521 0-2.732.626-3.409 1.763-1.066 1.789-.693 4.544 1.049 7.757.402.742.476 1.406.22 1.974-.265.586-.611 1.19-4.365 2.066-.852.196-1.342.449-1.623.848 2.012 2.207 4.91 3.592 8.128 3.592s6.115-1.385 8.127-3.59zm.65-.782c1.395-1.844 2.223-4.14 2.223-6.628 0-6.071-4.929-11-11-11s-11 4.929-11 11c0 2.487.827 4.783 2.222 6.626.409-.452 1.049-.81 2.049-1.041 2.025-.462 3.376-.836 3.678-1.502.122-.272.061-.628-.188-1.087-1.917-3.535-2.282-6.641-1.03-8.745.853-1.431 2.408-2.251 4.269-2.251 1.845 0 3.391.808 4.24 2.218 1.251 2.079.896 5.195-1 8.774-.245.463-.304.821-.179 1.094.305.668 1.644 1.038 3.667 1.499 1 .23 1.64.59 2.049 1.043z\"/></svg>\r\n\t\t\t\t\t\t\t\t\t\t\tProfile\r\n\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t<Link to={`/${username}/saved`} onClick={closeDropdown}>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg className=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M5 0v24l7-6 7 6v-24h-14zm1 1h12v20.827l-6-5.144-6 5.144v-20.827z\"/></svg>\r\n\t\t\t\t\t\t\t\t\t\t\tSaved\r\n\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t<Link to=\"/accounts/edit\" onClick={closeDropdown}>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg className=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M12 8.666c-1.838 0-3.333 1.496-3.333 3.334s1.495 3.333 3.333 3.333 3.333-1.495 3.333-3.333-1.495-3.334-3.333-3.334m0 7.667c-2.39 0-4.333-1.943-4.333-4.333s1.943-4.334 4.333-4.334 4.333 1.944 4.333 4.334c0 2.39-1.943 4.333-4.333 4.333m-1.193 6.667h2.386c.379-1.104.668-2.451 2.107-3.05 1.496-.617 2.666.196 3.635.672l1.686-1.688c-.508-1.047-1.266-2.199-.669-3.641.567-1.369 1.739-1.663 3.048-2.099v-2.388c-1.235-.421-2.471-.708-3.047-2.098-.572-1.38.057-2.395.669-3.643l-1.687-1.686c-1.117.547-2.221 1.257-3.642.668-1.374-.571-1.656-1.734-2.1-3.047h-2.386c-.424 1.231-.704 2.468-2.099 3.046-.365.153-.718.226-1.077.226-.843 0-1.539-.392-2.566-.893l-1.687 1.686c.574 1.175 1.251 2.237.669 3.643-.571 1.375-1.734 1.654-3.047 2.098v2.388c1.226.418 2.468.705 3.047 2.098.581 1.403-.075 2.432-.669 3.643l1.687 1.687c1.45-.725 2.355-1.204 3.642-.669 1.378.572 1.655 1.738 2.1 3.047m3.094 1h-3.803c-.681-1.918-.785-2.713-1.773-3.123-1.005-.419-1.731.132-3.466.952l-2.689-2.689c.873-1.837 1.367-2.465.953-3.465-.412-.991-1.192-1.087-3.123-1.773v-3.804c1.906-.678 2.712-.782 3.123-1.773.411-.991-.071-1.613-.953-3.466l2.689-2.688c1.741.828 2.466 1.365 3.465.953.992-.412 1.082-1.185 1.775-3.124h3.802c.682 1.918.788 2.714 1.774 3.123 1.001.416 1.709-.119 3.467-.952l2.687 2.688c-.878 1.847-1.361 2.477-.952 3.465.411.992 1.192 1.087 3.123 1.774v3.805c-1.906.677-2.713.782-3.124 1.773-.403.975.044 1.561.954 3.464l-2.688 2.689c-1.728-.82-2.467-1.37-3.456-.955-.988.41-1.08 1.146-1.785 3.126\"/></svg>\r\n\t\t\t\t\t\t\t\t\t\t\tSettings\r\n\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t<li className=\"log-out\" onClick={() => { logOut(); }}>\r\n\t\t\t\t\t\t\t\t\t\tLog Out\r\n\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t}\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t</nav>\r\n\t);\r\n};\r\n\r\nconst Searchbar = () =>\r\n{\r\n\tconst dispatch = useDispatch();\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\tconst [usersCache, setUsersCache] = useState(null);\r\n\tconst [options, setOptions] = useState([]);\r\n\tconst [open, setOpen] = useState(false);\r\n\tconst [inputValue, setInputValue] = useState(\"\");\r\n\r\n\tconst addToRecentSearches = async uid =>\r\n\t{\r\n\t\tawait updateDoc(doc(db, \"users\", currentUser.user.uid),\r\n\t\t\t{\r\n\t\t\t\t[\"recentSearches.\" + uid]: {uid, timestamp: serverTimestamp()},\r\n\t\t\t});\r\n\t};\r\n\r\n\tconst showRecentSearches = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tsetIsLoading(true);\r\n\t\t\tconst unformattedRecentSearches = await getDoc(doc(db, \"users\", currentUser.user.uid)).then(doc => Object.values(doc.data().recentSearches));\r\n\t\t\tunformattedRecentSearches.sort((a, b) => a.timestamp.seconds < b.timestamp.seconds ? 1 : -1);\r\n\t\t\tconst recentSearches = await Promise.all(unformattedRecentSearches.map(async user => await getDoc(doc(db, \"users\", user.uid)).then(doc => doc.data())));\r\n\t\t\tsetOptions(recentSearches);\r\n\t\t\tsetIsLoading(false);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tdispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\t\r\n\tconst removeFromRecentSearches = async (e, uid) =>\r\n\t{\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t\t\r\n\t\ttry\r\n\t\t{\r\n\t\t\tsetOptions(options.filter(option => option.uid !== uid));\r\n\t\t\tawait updateDoc(doc(db, \"users\", currentUser.user.uid),\r\n\t\t\t\t{\r\n\t\t\t\t\t[\"recentSearches.\" + uid]: deleteField(),\r\n\t\t\t\t});\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t}\r\n\t};\r\n\t\r\n\tconst clearRecentSearches = () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tsetOptions([]);\r\n\t\t\tupdateDoc(doc(db, \"users\", currentUser.user.uid), {recentSearches: []});\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tdispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\t\r\n\tconst handleInputChange = async (e) =>\r\n\t{\r\n\t\tconst newInput = e.target.value;\r\n\t\tsetInputValue(newInput);\r\n\t\tif (newInput === \"\") return showRecentSearches();\r\n\t\t\r\n\t\tsetIsLoading(true);\r\n\t\tlet users = usersCache || [];\r\n\t\tif (users.length === 0)\r\n\t\t{\r\n\t\t\ttry\r\n\t\t\t{\r\n\t\t\t\tconst querySnapshot = await getDocs(collection(db, \"users\"));\r\n\t\t\t\tquerySnapshot.docs.forEach(doc => users.push(doc.data()));\r\n\t\t\t\tsetUsersCache(users);\r\n\t\t\t} catch (err)\r\n\t\t\t{\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\tdispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t\t}\r\n\t\t}\r\n\t\tusers = users.filter(user => user.username.includes(newInput)).slice(0, 15);\r\n\t\tsetOptions(users);\r\n\t\tsetIsLoading(false);\r\n\t};\r\n\r\n\tconst handleOnOpen = () =>\r\n\t{\r\n\t\tsetOpen(true);\r\n\t\tif (inputValue !== \"\") return;\r\n\t\tshowRecentSearches();\r\n\t};\r\n\tconst handleOnClose = () => setOpen(false);\r\n\r\n\tconst handleElementClick = uid =>\r\n\t{\r\n\t\tsetOpen(false);\r\n\t\tsetInputValue(\"\");\r\n\t\taddToRecentSearches(uid);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<OutsideClickHandler onOutsideClick={handleOnClose}>\r\n\t\t\t<div className=\"searchbar-container\">\r\n\t\t\t\t<input \r\n\t\t\t\t\tclassName=\"search\"\r\n\t\t\t\t\tplaceholder=\"Search\"\r\n\t\t\t\t\tonFocus={handleOnOpen}\r\n\t\t\t\t\tonChange={handleInputChange}\r\n\t\t\t\t\tvalue={inputValue}\r\n\t\t\t\t/>\r\n\t\t\t\t{\r\n\t\t\t\t\topen\r\n\t\t\t\t\t\t?\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<span className=\"arrow\"></span>\r\n\t\t\t\t\t\t\t<ul className=\"search-list outlined\">\r\n\t\t\t\t\t\t\t\t{inputValue === \"\" && !isLoading ? <div className=\"recent\">Recent<button className=\"text\" onClick={clearRecentSearches}>Clear All</button></div> : null}\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tisLoading\r\n\t\t\t\t\t\t\t\t\t\t? <div className=\"loading\"><img src={Loading} alt=\"loading...\"></img></div>\r\n\t\t\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t\t\toptions.map(option =>\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\t<li key={option.username}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Link to={`/${option.username}`} onClick={() => handleElementClick(option.uid)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"img-container outlined round\"><img src={option.profilePic} alt={`${option.username}'s Profile Pic'`}></img></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div style={{display: \"flex\"}}><span className=\"username\">{option.username}</span> {option.verified ? <div className=\"verified\" title=\"Verified\"></div> : null}</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"real-name\">{option.realName}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"remove\" onClick={e => removeFromRecentSearches(e, option.uid)}><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" className=\"bi bi-x-lg\" viewBox=\"0 0 16 16\"><path d=\"M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z\"/></svg></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t))\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t: null\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t</OutsideClickHandler>\r\n\t);\r\n};\r\n\r\nexport default Navbar;\r\n","export const startLoading = () =>\r\n{\r\n\treturn {\r\n\t\ttype: \"START_LOADING\",\r\n\t};\r\n};\r\n\r\nexport const stopLoading = () =>\r\n{\r\n\treturn {\r\n\t\ttype: \"STOP_LOADING\",\r\n\t};\r\n};\r\n","import Logo from \"../assets/logo.png\";\r\n\r\nconst LoadingPage = () =>\r\n{\r\n\treturn(\r\n\t\t<div className=\"loading-page\">\r\n\t\t\t<div className=\"loading\"><img src={Logo} alt=\"Logo\"></img></div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default LoadingPage;\r\n","export const setUser = user =>\r\n{\r\n\treturn {\r\n\t\ttype: \"SET_CURRENT_USER\",\r\n\t\tpayload: user,\r\n\t};\r\n};\r\n\r\nexport const signOut = () =>\r\n{\r\n\treturn {\r\n\t\ttype: \"SIGN_OUT\",\r\n\t};\r\n};\r\n","const ErrorMsg = props => <div className=\"error-msg\">{props.text}</div>;\r\nexport default ErrorMsg;\r\n","export default __webpack_public_path__ + \"static/media/email-verification.ef786c0a.png\";","import { useEffect, useRef, useState } from \"react\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { auth, db } from \"../../firebase\";\r\nimport { createUserWithEmailAndPassword, sendEmailVerification, signOut } from \"firebase/auth\";\r\nimport { collection, doc, getDocs, setDoc, query, where, serverTimestamp } from \"@firebase/firestore\";\r\nimport { startLoading, stopLoading } from \"../../state/actions/isLoading\";\r\nimport { setUser } from \"../../state/actions/currentUser\";\r\nimport ErrorMsg from \"./ErrorMsg\";\r\nimport nameLogo from \"../../assets/namelogo.png\";\r\nimport emailVerificationIcon from \"../../assets/misc/email-verification.png\";\r\n\r\nconst SignUpPage = () =>\r\n{\r\n\tconst emailRef = useRef();\r\n\tconst realNameRef = useRef();\r\n\tconst usernameRef = useRef();\r\n\tconst passwordRef = useRef();\r\n\r\n\tconst history = useHistory();\r\n\tconst dispatch = useDispatch();\r\n\r\n\tconst [isInfoValid, setInfoValid] = useState(false);\r\n\tconst [emailVerificationTime, setEmailVerificationTime] = useState(false);\r\n\tconst [verificationInterval, setVerificationInterval] = useState();\r\n\tconst [errorMsg, setErrorMsg] = useState(null);\r\n\r\n\tuseEffect(() => document.title = \"Sign Up • Instadicey\", []);\r\n\tuseEffect(() => () => clearInterval(verificationInterval));\r\n\r\n\tconst checkEmail = () =>\r\n\t{\r\n\t\tconst emailValue = emailRef.current.value.trim();\r\n\t\tif (emailValue === \"\") return false;\r\n\t\t// eslint-disable-next-line no-control-regex\r\n\t\telse if (!emailValue.match(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])/))\r\n\t\t\treturn false;\r\n\t\telse return true;\r\n\t};\r\n\r\n\tconst checkPassword = () => passwordRef.current.value.length < 6 ? false : true;\r\n\r\n\tconst checkUsername = () => usernameRef.current.value.length > 20 || usernameRef.current.value.length === 0 || !usernameRef.current.value.match(/^[A-Za-z0-9]*$/) ? false : true;\r\n\r\n\tconst checkForm = () =>\r\n\t{\r\n\t\tif (checkEmail() && checkPassword() && checkUsername()) setInfoValid(true);\r\n\t\telse setInfoValid(false);\r\n\t};\r\n\r\n\tconst checkFormWithDB = (_username) =>\r\n\t{\r\n\t\treturn new Promise(async resolve =>\r\n\t\t{\r\n\t\t\tconst usersRef = collection(db, \"users\");\r\n\t\t\tconst q = query(usersRef, where(\"username\", \"==\", _username));\r\n\t\t\tconst querySnapshot = await getDocs(q);\r\n\t\t\tconsole.error(querySnapshot.docs.length);\r\n\t\t\tif (querySnapshot.docs.length !== 0)\r\n\t\t\t{\r\n\t\t\t\tsetErrorMsg(\"Username already taken\");\r\n\t\t\t\tresolve(false);\r\n\t\t\t} else resolve(true);\r\n\t\t});\r\n\t};\r\n\r\n\tconst handleSubmit = async  e =>\r\n\t{\r\n\t\te.preventDefault();\r\n\t\tif (!isInfoValid) return;\r\n\t\t\r\n\t\tconst email = emailRef.current.value.toLowerCase();\r\n\t\tconst realName = realNameRef.current.value;\r\n\t\tconst username = usernameRef.current.value.toLowerCase();\r\n\t\tconst password = passwordRef.current.value;\r\n\t\t\r\n\t\ttry\r\n\t\t{\r\n\t\t\tdispatch(startLoading());\r\n\r\n\t\t\tconst checkWithDB = await checkFormWithDB(username);\r\n\t\t\tif (!checkWithDB) return dispatch(stopLoading());\r\n\r\n\t\t\tconst { user } = await createUserWithEmailAndPassword(auth, email, password);\r\n\t\t\tconst info =\r\n\t\t\t{\r\n\t\t\t\trealName,\r\n\t\t\t\tusername,\r\n\t\t\t\tprofilePic: \"https://firebasestorage.googleapis.com/v0/b/instadicey.appspot.com/o/default%2FprofilePic.jpg?alt=media&token=3ac835a3-016e-470a-b7b3-f898d82cdbde\",\r\n\t\t\t\tdefaultProfilePic: true,\r\n\t\t\t\tbio: \"\",\r\n\t\t\t\tsaved: [],\r\n\t\t\t\trecentSearches: {},\r\n\t\t\t\tuid: auth.currentUser.uid,\r\n\t\t\t\ttimestamp: serverTimestamp(),\r\n\t\t\t};\r\n\t\t\tconst userDocRef = doc(db, \"users\", auth.currentUser.uid);\r\n\t\t\tawait setDoc(userDocRef, info);\r\n\t\t\tsetErrorMsg(null);\r\n\t\t\t\r\n\t\t\tawait sendEmailVerification(user);\r\n\t\t\tsetEmailVerificationTime(true);\r\n\t\t\trunEmailVerification(info);\r\n\r\n\t\t\tdispatch(stopLoading());\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconst errorCode = err.code;\r\n\t\t\tconsole.error(\"Error with signup\", err);\r\n\t\t\tif (errorCode === \"auth/email-already-in-use\")\r\n\t\t\t\tsetErrorMsg(\"Email already in use\");\r\n\t\t\tdispatch(stopLoading());\r\n\t\t}\r\n\t};\r\n\r\n\t// Runs after checking user info on sign up\r\n\tconst runEmailVerification = (info) =>\r\n\t{\r\n\t\tsetVerificationInterval(setInterval(async () =>\r\n\t\t{\r\n\t\t\tawait auth.currentUser.reload();\r\n\t\t\tif (auth.currentUser.emailVerified)\r\n\t\t\t{\r\n\t\t\t\tdispatch(setUser({user: auth.currentUser, info}));\r\n\t\t\t\thistory.push(\"\");\r\n\t\t\t};\r\n\t\t}, 5000));\r\n\t};\r\n\tuseEffect(() => signOut(auth), []);\r\n\r\n\tif (!emailVerificationTime)\r\n\t\treturn(\r\n\t\t\t<div id=\"signup-page\">\r\n\t\t\t\t<div id=\"signup-window\" className=\"outlined\">\r\n\t\t\t\t\t<div className=\"logo\"><img src={nameLogo} alt=\"Instadicey logo\"></img></div>\r\n\t\t\t\t\t{ \r\n\t\t\t\t\t\terrorMsg \r\n\t\t\t\t\t\t\t? <ErrorMsg text={errorMsg}/>\r\n\t\t\t\t\t\t\t: <span style={{fontWeight: \"bold\", color: \"rgba(50, 50, 50, 0.5)\"}}>Sign up now!</span> \r\n\t\t\t\t\t}\r\n\t\t\t\t\t<form className=\"info\" onSubmit={handleSubmit}>\r\n\t\t\t\t\t\t<input type=\"text\" placeholder=\"Email\" id=\"email\" ref={emailRef} onChange={checkForm}></input>\r\n\t\t\t\t\t\t<input type=\"text\" placeholder=\"Full Name\" id=\"name\" ref={realNameRef}></input>\r\n\t\t\t\t\t\t<input type=\"text\" placeholder=\"Username\" id=\"username\" ref={usernameRef} onChange={checkForm}></input>\r\n\t\t\t\t\t\t<input type=\"password\" placeholder=\"Password\" id=\"password\" ref={passwordRef} onChange={checkForm}></input>\r\n\t\t\t\t\t\t<button id=\"signup\" className={`${isInfoValid ? null : \"disabled\"}`}>Sign Up</button>\r\n\t\t\t\t\t</form>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"extra outlined\"><span>Have an account? <Link to=\"/\" className=\"button\">Log In</Link></span></div>\r\n\t\t\t</div>\r\n\t\t);\r\n\telse\r\n\t\treturn(\r\n\t\t\t<div id=\"email-verification-window\" className=\"outlined\">\r\n\t\t\t\t<div className=\"icon\"><img src={emailVerificationIcon} alt=\"email verification icon\"></img></div>\r\n\t\t\t\t<p className=\"header\">A verification link has been sent to your email</p>\r\n\t\t\t\t<p>Please click on the link sent to your email address and come back here to continue.</p>\r\n\t\t\t</div>\r\n\t\t);\r\n};\r\n\r\nexport default SignUpPage;\r\n","export default __webpack_public_path__ + \"static/media/green-checkmark.6fb350c8.png\";","import { useEffect, useRef, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { auth } from \"../../firebase\";\r\nimport { sendPasswordResetEmail } from \"@firebase/auth\";\r\nimport ErrorMsg from \"./ErrorMsg\";\r\nimport Lock from \"../../assets/misc/lock.png\";\r\nimport greenCheckmark from \"../../assets/misc/green-checkmark.png\";\r\nimport { useSelector } from \"react-redux\";\r\n\r\nconst PasswordReset = () =>\r\n{\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst emailRef = useRef();\r\n\tconst [isInfoValid, setIsInfoValid] = useState(false);\r\n\tconst [isEmailSent, setIsEmailSent] = useState(false);\r\n\tconst [errorMsg, setErrorMsg] = useState(null);\r\n\r\n\tuseEffect(() => document.title = \"Reset Password • Instadicey\", []);\r\n\r\n\tconst checkEmail = () =>\r\n\t{\r\n\t\tconst emailValue = emailRef.current.value;\r\n\t\tif (emailValue === \"\") return setIsInfoValid(false);\r\n\t\t// eslint-disable-next-line no-control-regex\r\n\t\telse if (!emailValue.match(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])/))\r\n\t\t\treturn setIsInfoValid(false);\r\n\t\telse return setIsInfoValid(true);\r\n\t};\r\n\r\n\tconst handleSubmit = async e =>\r\n\t{\r\n\t\te.preventDefault();\r\n\t\tif (!isInfoValid) return;\r\n\r\n\t\tconst email = emailRef.current.value;\r\n\t\ttry\r\n\t\t{\r\n\t\t\tsetErrorMsg(null);\r\n\t\t\tawait sendPasswordResetEmail(auth, email);\r\n\t\t\tsetIsEmailSent(true);\r\n\t\t}\r\n\t\tcatch (err)\r\n\t\t{\r\n\t\t\tif (err.code === \"auth/user-not-found\")\r\n\t\t\t\tsetErrorMsg(\"User not found\");\r\n\t\t\tconsole.error(\"Error with password reset\", err);\r\n\t\t}\r\n\t};\r\n\r\n\tif (isEmailSent)\r\n\t{\r\n\t\treturn(\r\n\t\t\t<div className=\"password-reset-window success outlined\">\r\n\t\t\t\t<div className=\"icon\"><img src={greenCheckmark} alt=\"Success\"></img></div>\r\n\t\t\t\t<h1>Email sent</h1>\r\n\t\t\t\t<p>Check your inbox and spam and follow the instructions</p>\r\n\t\t\t\t<div className=\"extra\">\r\n\t\t\t\t\t<Link to=\"/\">Back To Login</Link>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t} else\r\n\t{\r\n\t\treturn(\r\n\t\t\t<div className=\"password-reset-window outlined\">\r\n\t\t\t\t<div className=\"icon\"><img src={Lock} alt=\"locked out\"></img></div>\r\n\t\t\t\t<h1>Can't Log In?</h1>\r\n\t\t\t\t<p>It's all good, mate. just enter your email and we'll send you an email to reset your password right away!</p>\r\n\t\t\t\t{ errorMsg ? <ErrorMsg text={errorMsg}/> : null }\r\n\t\t\t\t<form onSubmit={handleSubmit}>\r\n\t\t\t\t\t<input type=\"text\" id=\"email\" placeholder=\"Email\" ref={emailRef} onChange={checkEmail}></input>\r\n\t\t\t\t\t<button id=\"reset\" className={`${isInfoValid ? null : \"disabled\"}`}>Send Email</button>\r\n\t\t\t\t</form>\r\n\t\t\t\t{ !currentUser &&\r\n\t\t\t\t\t<div className=\"extra outlined\">\r\n\t\t\t\t\t\t<Link to=\"/\">Back To Login</Link>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n};\r\n\r\nexport default PasswordReset;\r\n","export default \"data:image/png;base64,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\"","import { useState, useRef, useEffect } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { auth, db } from \"../../firebase\";\r\nimport { sendEmailVerification, signInWithEmailAndPassword, signOut } from \"firebase/auth\";\r\nimport { doc, getDoc } from \"@firebase/firestore\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { startLoading, stopLoading } from \"../../state/actions/isLoading\";\r\nimport { setUser } from \"../../state/actions/currentUser\";\r\nimport ErrorMsg from \"./ErrorMsg\";\r\nimport nameLogo from \"../../assets/namelogo.png\";\r\nimport \"./auth.css\";\r\n\r\nconst LoginPage = () =>\r\n{\r\n\tconst emailRef = useRef();\r\n\tconst passwordRef = useRef();\r\n\tconst dispatch = useDispatch();\r\n\r\n\tconst [isInfoValid, setInfoValid] = useState(false);\r\n\tconst [errorMsg, setErrorMsg] = useState(null);\r\n\r\n\tuseEffect(() => document.title = \"Login • Instadicey\", []);\r\n\r\n\tconst checkEmail = () =>\r\n\t{\r\n\t\tconst emailValue = emailRef.current.value;\r\n\t\tif (emailValue === \"\") return false;\r\n\t\t// eslint-disable-next-line no-control-regex\r\n\t\telse if (!emailValue.match(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])/))\r\n\t\t\treturn false;\r\n\t\telse return true;\r\n\t};\r\n\r\n\tconst checkPassword = () =>\r\n\t{\r\n\t\tconst passwordValue = passwordRef.current.value;\r\n\t\treturn passwordValue.length < 6 ? false : true;\r\n\t};\r\n\r\n\tconst checkForm = () =>\r\n\t{\r\n\t\tif (checkEmail() && checkPassword()) setInfoValid(true);\r\n\t\telse setInfoValid(false);\r\n\t};\r\n\r\n\tconst handleSubmit = async  e =>\r\n\t{\r\n\t\te.preventDefault();\r\n\t\tif (!isInfoValid) return;\r\n\r\n\t\tconst email = emailRef.current.value;\r\n\t\tconst password = passwordRef.current.value;\r\n\r\n\t\ttry\r\n\t\t{\r\n\t\t\tdispatch(startLoading());\r\n\t\t\tconst user = await signInWithEmailAndPassword(auth, email, password).then(data => data.user);\r\n\t\t\tif (!user.emailVerified)\r\n\t\t\t{\r\n\t\t\t\tsignOut(auth);\r\n\t\t\t\tconst sendEmail = async () =>\r\n\t\t\t\t{\r\n\t\t\t\t\tawait sendEmailVerification(user);\r\n\t\t\t\t\tsetErrorMsg(\"Email sent\");\r\n\t\t\t\t};\r\n\t\t\t\tsetErrorMsg(<div>Email not verified<br/><span className=\"link\" onClick={sendEmail}>click here</span> to send verification email</div>);\r\n\t\t\t\treturn dispatch(stopLoading());\r\n\t\t\t}\r\n\t\t\tconst info = await getDoc(doc(db, \"users\", user.uid)).then(doc => doc.data());\r\n\t\t\tdispatch(setUser({user, info}));\r\n\t\t\tdispatch(stopLoading());\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconst errorCode = err.code;\r\n\t\t\tconsole.error(\"Error with login\", err);\r\n\t\t\tif (errorCode === \"auth/wrong-password\" || errorCode === \"auth/user-not-found\")\r\n\t\t\t\tsetErrorMsg(\"Wrong email or password\");\r\n\t\t\telse if (errorCode === \"auth/too-many-requests\")\r\n\t\t\t\tsetErrorMsg(\"Please try again later\");\r\n\t\t\tdispatch(stopLoading());\r\n\t\t}\r\n\t};\r\n\r\n\treturn(\r\n\t\t<div id=\"login-page\">\r\n\t\t\t<div id=\"login-window\" className=\"outlined\">\r\n\t\t\t\t<div className=\"logo\"><img src={nameLogo} alt=\"Instadicey logo\"></img></div>\r\n\t\t\t\t{ errorMsg ? <ErrorMsg text={errorMsg}/> : null }\r\n\t\t\t\t<form className=\"info\" onSubmit={handleSubmit}>\r\n\t\t\t\t\t<input type=\"text\" placeholder=\"Email\" id=\"email\" ref={emailRef} onChange={checkForm}></input>\r\n\t\t\t\t\t<input type=\"password\" placeholder=\"Password\" id=\"password\" ref={passwordRef} onChange={checkForm}></input>\r\n\t\t\t\t\t<button id=\"login\" className={`${isInfoValid ? null : \"disabled\"}`}>Log In</button>\r\n\t\t\t\t</form>\r\n\t\t\t\t<Link to=\"accounts/password-reset\">Forgot password?</Link>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"extra outlined\"><span>Don't have an account? <Link to=\"/accounts/email-signup\" className=\"button\">Sign Up</Link></span></div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default LoginPage;\r\n","export default __webpack_public_path__ + \"static/media/red-x.1684dcf4.png\";","/* eslint-disable react-hooks/exhaustive-deps */\r\nimport { applyActionCode, confirmPasswordReset, verifyPasswordResetCode } from \"@firebase/auth\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { auth } from \"../../firebase\";\r\nimport { startLoading, stopLoading } from \"../../state/actions/isLoading\";\r\nimport Logo from \"../../assets/logo.png\";\r\nimport greenCheckmark from \"../../assets/misc/green-checkmark.png\";\r\nimport redX from \"../../assets/misc/red-x.png\";\r\n\r\nconst AccountVerification = () =>\r\n{\r\n\tconst dispatch = useDispatch();\r\n\tconst [mode, setMode] = useState(\"\");\r\n\tconst [actionCode, setActionCode] = useState(\"\");\r\n\tconst [status, setStatus] = useState({});\r\n\r\n\tconst passwordRef = useRef();\r\n\tconst confirmPasswordRef = useRef();\r\n\tconst [passwordResetDone, setPasswordResetDone] = useState(false);\r\n\tconst [passwordResetEmail, setPasswordResetEmail] = useState(\"\");\r\n\tconst [isInfoValid, setIsInfoValid] = useState(false);\r\n\r\n\tuseEffect(() => document.title = \"Verification • Instadicey\", []);\r\n\r\n\tconst handleVerifyEmail = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tawait applyActionCode(auth, actionCode);\r\n\t\t\tsetStatus({\r\n\t\t\t\ttype: \"email-verification\",\r\n\t\t\t\tok: true,\r\n\t\t\t});\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tsetStatus({\r\n\t\t\t\ttype: \"email-verification\",\r\n\t\t\t\tok: false,\r\n\t\t\t});\r\n\t\t}\r\n\t\tdispatch(stopLoading());\r\n\t};\r\n\r\n\tconst checkForm = () => checkPassword() && checkConfirmPassword() ? setIsInfoValid(true) : setIsInfoValid(false);\r\n\tconst checkPassword = () => passwordRef.current.value.length < 6 ? false : true;\r\n\tconst checkConfirmPassword = () => confirmPasswordRef.current.value === passwordRef.current.value ? true : false;\r\n\tconst handleFormSubmitPassword = async e =>\r\n\t{\r\n\t\te.preventDefault();\r\n\t\tif (!isInfoValid) return;\r\n\r\n\t\tconst newPassword = passwordRef.current.value;\r\n\t\ttry\r\n\t\t{\r\n\t\t\tawait confirmPasswordReset(auth, actionCode, newPassword);\r\n\t\t\tsetPasswordResetDone(true);\r\n\t\t\tsetStatus({\r\n\t\t\t\ttype: \"password-reset\",\r\n\t\t\t\tok: true,\r\n\t\t\t});\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(\"error with confirming password\", err);\r\n\t\t\tsetStatus({\r\n\t\t\t\ttype: \"password-reset\",\r\n\t\t\t\tok: false,\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tconst handlePasswordReset = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tconst email = await verifyPasswordResetCode(auth, actionCode);\r\n\t\t\tsetPasswordResetEmail(email);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(\"Invalid code\", err);\r\n\t\t\tsetStatus({\r\n\t\t\t\ttype: \"password-reset\",\r\n\t\t\t\tok: false,\r\n\t\t\t});\r\n\t\t}\r\n\t\tdispatch(stopLoading());\r\n\t};\r\n\r\n\tconst handleLink = () =>\r\n\t{\r\n\t\tswitch (mode)\r\n\t\t{\r\n\t\t\tcase \"verifyEmail\":\r\n\t\t\t\thandleVerifyEmail();\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"resetPassword\":\r\n\t\t\t\thandlePasswordReset();\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tdispatch(startLoading());\r\n\t\tsetMode(getParameterByName(\"mode\"));\r\n\t\tsetActionCode(getParameterByName(\"oobCode\"));\r\n\t\thandleLink();\r\n\t}, [mode]);\r\n\r\n\tconst getParameterByName = name =>\r\n\t{\r\n\t\tname = name.replace(/[[]/,\"\\\\[\").replace(/[\\]]/,\"\\\\]\");\r\n\t\tvar regexS = \"[\\\\?&]\"+name+\"=([^&#]*)\";\r\n\t\tvar regex = new RegExp(regexS);\r\n\t\tvar results = regex.exec(window.location.href);\r\n\t\tif (results == null)\r\n\t\t\treturn \"\";\r\n\t\telse\r\n\t\t\treturn decodeURIComponent(results[1].replace(/\\+/g, \" \"));\r\n\t};\r\n\r\n\r\n\tif (mode === \"resetPassword\" && !passwordResetDone && status.ok !== false)\r\n\t{\r\n\t\treturn(\r\n\t\t\t<div className=\"verification-window outlined password-reset\">\r\n\t\t\t\t<div className=\"icon\"><img src={Logo} alt=\"logo\"></img></div>\r\n\t\t\t\t<div className=\"email-div\">\r\n\t\t\t\t\t<h2>Your Email:</h2>\r\n\t\t\t\t\t<span>{passwordResetEmail}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<form onSubmit={handleFormSubmitPassword}>\r\n\t\t\t\t\t<input type=\"password\" id=\"password\" placeholder=\"Password (at least 6 characters)\" ref={passwordRef} onChange={checkForm}></input>\r\n\t\t\t\t\t<input type=\"password\" id=\"confirm password\" placeholder=\"Confirm Password\" ref={confirmPasswordRef} onChange={checkForm}></input>\r\n\t\t\t\t\t<button className={`${isInfoValid ? null : \"disabled\"}`}>Reset Password</button>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t);\r\n\t} else if (status.ok)\r\n\t{\r\n\t\treturn(\r\n\t\t\t<div className=\"verification-window success outlined\">\r\n\t\t\t\t<div className=\"icon\"><img src={greenCheckmark} alt=\"success\"></img></div>\r\n\t\t\t\t{\r\n\t\t\t\t\tstatus.type === \"email-verification\"\r\n\t\t\t\t\t\t? \r\n\t\t\t\t\t\t<div className=\"text-div\">\r\n\t\t\t\t\t\t\t<h1>Your email address has been verified</h1>\r\n\t\t\t\t\t\t\t<p>Please go back to the sign up page to continue.</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t: status.type === \"password-reset\"\r\n\t\t\t\t\t\t\t?\r\n\t\t\t\t\t\t\t<div className=\"text-div\">\r\n\t\t\t\t\t\t\t\t<h1>Your password has been reset</h1>\r\n\t\t\t\t\t\t\t\t<p>You can now log in with the new password.</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t: null\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t);\r\n\t} else if (status.ok === false)\r\n\t{\r\n\t\treturn(\r\n\t\t\t<div className=\"verification-window failed outlined\">\r\n\t\t\t\t<div className=\"icon\"><img src={redX} alt=\"failed\"></img></div>\r\n\t\t\t\t{\r\n\t\t\t\t\tstatus.type === \"email-verification\"\r\n\t\t\t\t\t\t? \r\n\t\t\t\t\t\t<div className=\"text-div\">\r\n\t\t\t\t\t\t\t<h1>An error has occured</h1>\r\n\t\t\t\t\t\t\t<p>This email address is already verified or the link might have expired.</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t: status.type === \"password-reset\"\r\n\t\t\t\t\t\t\t?\r\n\t\t\t\t\t\t\t<div className=\"text-div\">\r\n\t\t\t\t\t\t\t\t<h1>An error has occured</h1>\r\n\t\t\t\t\t\t\t\t<p>Please try to reset the password again.</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t: null\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\telse return null;\r\n};\r\n\r\nexport default AccountVerification;\r\n","import { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { doc, setDoc, getDoc, runTransaction } from \"@firebase/firestore\";\r\nimport { db } from \"../firebase\";\r\nimport Loading from \"../assets/misc/loading.jpg\";\r\nimport { setSnackbar } from \"../state/actions/snackbar\";\r\n\r\nconst FollowButton = ({ target }) =>\r\n{\r\n\tconst dispatch = useDispatch();\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst [isLoading, setIsLoading] = useState(null);\r\n\tconst [isFollowing, setIsFollowing] = useState(false);\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst checkIfFollowing = async () =>\r\n\t\t{\r\n\t\t\tif (!currentUser) return;\r\n\t\t\tsetIsLoading(true);\r\n\t\t\tconst currentUserFollowing = await getDoc(doc(db, \"users\", currentUser.user.uid, \"user_follows\", \"following\")).then(doc => doc.data()).then(data => data ? data.following : []);\r\n\t\t\tif (currentUserFollowing.includes(target.uid)) setIsFollowing(true);\r\n\t\t\telse setIsFollowing(false);\r\n\t\t\tsetIsLoading(false);\r\n\t\t};\r\n\t\tcheckIfFollowing();\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, [currentUser, target]);\r\n\r\n\tconst follow = async () =>\r\n\t{\r\n\t\tif (!currentUser) return alert(\"sign in\");\r\n\t\twindow.onbeforeunload = () => \"\";\r\n\t\tsetIsLoading(true);\r\n\t\tawait addToUsersFollowing();\r\n\t\tawait addToTargetsFollowers();\r\n\t\tsetIsFollowing(true);\r\n\t\tsetIsLoading(false);\r\n\t\twindow.onbeforeunload = null;\r\n\t};\r\n\tconst unfollow = async () =>\r\n\t{\r\n\t\twindow.onbeforeunload = () => \"\";\r\n\t\tsetIsLoading(true);\r\n\t\tawait removeFromUsersFollowing();\r\n\t\tawait removeFromTargetsFollowers();\r\n\t\tsetIsFollowing(false);\r\n\t\tsetIsLoading(false);\r\n\t\twindow.onbeforeunload = null;\r\n\t};\r\n\r\n\tconst addToUsersFollowing = async () =>\r\n\t{\r\n\t\tconst userRefFollowing = doc(db, \"users\", currentUser.user.uid, \"user_follows\", \"following\");\r\n\t\ttry\r\n\t\t{\r\n\t\t\tawait runTransaction(db, async t =>\r\n\t\t\t{\r\n\t\t\t\tconst sfDoc = await t.get(userRefFollowing);\r\n\t\t\t\tif (!sfDoc.exists()) throw new Error(\"Document does not exist\");\r\n\t\t\t\tconst newFollowingArray = [...sfDoc.data().following, target.uid];\r\n\t\t\t\tt.update(userRefFollowing, { following: newFollowingArray }, { merge: true });\r\n\t\t\t});\r\n\t\t}\r\n\t\tcatch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tif (err.message === \"Document does not exist\")\r\n\t\t\t{\r\n\t\t\t\tawait setDoc(userRefFollowing,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfollowing: [target.uid]\r\n\t\t\t\t\t}, {merge: true});\r\n\t\t\t}\r\n\t\t\telse dispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\tconst removeFromUsersFollowing = async () =>\r\n\t{\r\n\t\tconst userRefFollowing = doc(db, \"users\", currentUser.info.uid, \"user_follows\", \"following\");\r\n\t\ttry\r\n\t\t{\r\n\t\t\tawait runTransaction(db, async t =>\r\n\t\t\t{\r\n\t\t\t\tconst sfDoc = await t.get(userRefFollowing);\r\n\t\t\t\tif (!sfDoc.exists()) throw new Error(\"Document does not exist\");\r\n\t\t\t\tif (!sfDoc.data().following.includes(target.uid)) throw new Error(\"User already not followed\");\r\n\t\t\t\tconst newFollowingArray = sfDoc.data().following.filter(user => user !== target.uid);\r\n\t\t\t\tt.update(userRefFollowing, { following: newFollowingArray }, { merge: true });\r\n\t\t\t});\r\n\t\t}\r\n\t\tcatch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tdispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\r\n\tconst addToTargetsFollowers = async () =>\r\n\t{\r\n\t\tconst targetRefFollowers = doc(db, \"users\", target.uid, \"user_follows\", \"followers\");\r\n\t\ttry\r\n\t\t{\r\n\t\t\tawait runTransaction(db, async t =>\r\n\t\t\t{\r\n\t\t\t\tconst sfDoc = await t.get(targetRefFollowers);\r\n\t\t\t\tif (!sfDoc.exists()) throw new Error(\"Document does not exist\");\r\n\t\t\t\tif (sfDoc.data().followers.includes(currentUser.user.uid)) throw new Error(\"User already followed\");\r\n\t\t\t\tconst newFollowersArray = [...sfDoc.data().followers, currentUser.user.uid];\r\n\t\t\t\tt.update(targetRefFollowers, { followers: newFollowersArray }, { merge: true });\r\n\t\t\t});\r\n\t\t}\r\n\t\tcatch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tif (err.message === \"Document does not exist\")\r\n\t\t\t{\r\n\t\t\t\tawait setDoc(targetRefFollowers,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfollowers: [currentUser.user.uid]\r\n\t\t\t\t\t}, {merge: true});\r\n\t\t\t}\r\n\t\t\telse dispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\tconst removeFromTargetsFollowers = async () =>\r\n\t{\r\n\t\tconst targetRefFollowers = doc(db, \"users\", target.uid, \"user_follows\", \"followers\");\r\n\t\ttry\r\n\t\t{\r\n\t\t\tawait runTransaction(db, async t =>\r\n\t\t\t{\r\n\t\t\t\tconst sfDoc = await t.get(targetRefFollowers);\r\n\t\t\t\tif (!sfDoc.exists()) throw new Error(\"Document does not exist\");\r\n\t\t\t\tconst newFollowersArray = sfDoc.data().followers.filter(user => user !== currentUser.user.uid);\r\n\t\t\t\tt.update(targetRefFollowers, { followers: newFollowersArray }, { merge: true });\r\n\t\t\t});\r\n\t\t}\r\n\t\tcatch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tdispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\r\n\tif (isLoading) return <button className=\"follow-btn loading\"><div><img src={Loading} alt=\"loading\"></img></div></button>;\r\n\tif (isFollowing)\r\n\t\treturn <button className=\"follow-btn unfollow\" onClick={unfollow}>Unfollow</button>;\r\n\telse\r\n\t\treturn <button className=\"follow-btn follow\" onClick={follow}>Follow</button>;\r\n};\r\n\r\nexport default FollowButton;\r\n","const VerifiedTick = ({size = 24, user, marginLeft = 10, marginRight = 0}) =>\r\n{\r\n\tif (user.verified) return(\r\n\t\t<span className=\"verified\" style={{marginLeft, marginRight}}>\r\n\t\t\t<svg xmlns='http://www.w3.org/2000/svg' width={size} height={size} viewBox='0 0 24 24'><path d='M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm-1.959 17l-4.5-4.319 1.395-1.435 3.08 2.937 7.021-7.183 1.422 1.409-8.418 8.591z'/></svg>\r\n\t\t</span>\r\n\t);\r\n\telse return null;\r\n};\r\n\r\nexport default VerifiedTick;\r\n","import { doc, getDoc, setDoc } from \"@firebase/firestore\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { db } from \"../firebase\";\r\nimport FollowButton from \"./FollowButton\";\r\nimport VerifiedTick from \"./VerifiedTick\";\r\n\r\nconst FollowWindow = props =>\r\n{\r\n\tconst { title, uids, closeFollowListWindow, newMessage } = props;\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst [list, setList] = useState(null);\r\n\tconst [isLoading, setIsLoading] = useState(true);\r\n\r\n\tconst uidToNumbers = uid =>\r\n\t{\r\n\t\tconst uidCharactersArrary = uid.split(\"\");\r\n\t\tconst uidNumbersArray = uidCharactersArrary.map(char => Number.isInteger(parseInt(char)) ? char : `${Math.abs(char.charCodeAt(0) - 97)}`);\r\n\t\tconst newUid = uidNumbersArray.join(\"\").slice(0, 25);\r\n\t\treturn newUid;\r\n\t};\r\n\t\r\n\tconst getRoomID = targetUid =>\r\n\t{\r\n\t\tconst currentUserUID = uidToNumbers(currentUser.user.uid);\r\n\t\tconst targetUserUID = uidToNumbers(targetUid);\r\n\t\tconst roomID = currentUserUID > targetUserUID ? `${currentUserUID}${targetUserUID}` : `${targetUserUID}${currentUserUID}`;\r\n\t\treturn roomID;\r\n\t};\r\n\r\n\tconst handleStartChat = async (targetUid, roomID) =>\r\n\t{\r\n\t\tcloseFollowListWindow();\r\n\t\tawait setDoc(doc(db, \"chats\", roomID),\r\n\t\t\t{\r\n\t\t\t\tid: roomID,\r\n\t\t\t\tmembers:\r\n\t\t\t\t[\r\n\t\t\t\t\ttargetUid,\r\n\t\t\t\t\tcurrentUser.user.uid,\r\n\t\t\t\t]\r\n\t\t\t}, {merge: true});\r\n\t};\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst getUidsInfo = async () =>\r\n\t\t{\r\n\t\t\tconst data = await Promise.all(uids.map(uid => getDoc(doc(db, \"users\", uid)).then(doc => doc.data())));\r\n\t\t\tsetList(data);\r\n\t\t\tsetIsLoading(false);\r\n\t\t};\r\n\t\tgetUidsInfo();\r\n\t}, [uids]);\r\n\r\n\treturn(\r\n\t\t<div className=\"backdrop container\" onClick={closeFollowListWindow}>\r\n\t\t\t<div className=\"follow-list-window\" onClick={e => e.stopPropagation()}>\r\n\t\t\t\t<div className=\"header\">\r\n\t\t\t\t\t<h1>{title}</h1>\r\n\t\t\t\t\t<span className=\"close\" onClick={closeFollowListWindow}>X</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t{ isLoading\r\n\t\t\t\t\t? \r\n\t\t\t\t\t<ul className=\"loading\">\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t[0,1,2,3,4,5,6,7,8].map(n =>\r\n\t\t\t\t\t\t\t\t<li className=\"person\" key={n}>\r\n\t\t\t\t\t\t\t\t\t<div className=\"profile\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"profile-pic\"></div>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"info\">\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"real-name\"></span>\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"username\"></span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t\t:\r\n\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tnewMessage\r\n\t\t\t\t\t\t\t\t?\r\n\t\t\t\t\t\t\t\tlist.map(person => \r\n\t\t\t\t\t\t\t\t\t<Link to={`/direct/t/${getRoomID(person.uid)}`} className=\"person\" key={person.uid} onClick={() => handleStartChat(person.uid, getRoomID(person.uid))}>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"profile\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"profile-pic\"><img src={person.profilePic} alt={`${person.username}'s Pic`}></img></div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div style={{display: \"flex\"}}><span className=\"username\">{person.username}</span></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"real-name\">{person.realName}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\tlist.map(person => \r\n\t\t\t\t\t\t\t\t\t<li className=\"person\" key={person.uid}>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"profile\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Link to={`${person.username}`}><div className=\"profile-pic\"><img src={person.profilePic} alt={`${person.username}'s Pic`}></img></div></Link>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div style={{display: \"flex\"}}><Link to={`/${person.username}`} className=\"username\">{person.username}</Link> <VerifiedTick user={person} size={15} marginLeft={7.5}/></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"real-name\">{person.realName}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t{currentUser && currentUser.user.uid === person.uid ? null : <FollowButton target={person} startLoading={() => setIsLoading(true)} stopLoading={() => setIsLoading(false)}/>}\r\n\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default FollowWindow;\r\n","import { arrayRemove, arrayUnion, doc, updateDoc } from \"@firebase/firestore\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { db } from \"../../firebase\";\r\nimport { setSnackbar } from \"../../state/actions/snackbar\";\r\n\r\nconst Like = ({size = 25, target, postPath, isComment}) =>\r\n{\r\n\tconst dispatch = useDispatch();\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst [isLiked, setIsLiked] = useState(false);\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst checkIfLiked = async () =>\r\n\t\t{\r\n\t\t\tif (!currentUser) return;\r\n\t\t\tif (target.likes.includes(currentUser.user.uid)) setIsLiked(true);\r\n\t\t\telse setIsLiked(false);\r\n\t\t};\r\n\t\tcheckIfLiked();\r\n\t}, [currentUser, target]);\r\n\r\n\tconst like = async () =>\r\n\t{\r\n\t\tif (!currentUser) return alert(\"sign in\");\r\n\t\ttry\r\n\t\t{\r\n\t\t\tif (isComment)\r\n\t\t\t{\r\n\t\t\t\tawait updateDoc(doc(db, postPath, \"comments\", `${target.id}`),\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlikes: arrayUnion(currentUser.user.uid),\r\n\t\t\t\t\t});\r\n\t\t\t} else\r\n\t\t\t{\r\n\t\t\t\tawait updateDoc(doc(db, postPath),\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlikes: arrayUnion(currentUser.user.uid),\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tdispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t\tsetIsLiked(true);\r\n\t};\r\n\t\r\n\tconst unlike = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tif (isComment)\r\n\t\t\t{\r\n\t\t\t\tawait updateDoc(doc(db, postPath, \"comments\", `${target.id}`),\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlikes: arrayRemove(currentUser.user.uid),\r\n\t\t\t\t\t});\r\n\t\t\t} else\r\n\t\t\t{\r\n\t\t\t\tawait updateDoc(doc(db, postPath),\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlikes: arrayRemove(currentUser.user.uid),\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tdispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t\tsetIsLiked(false);\r\n\t};\r\n\r\n\tif (isLiked)\r\n\t\treturn(\r\n\t\t\t<button className=\"like liked icon\" onClick={unlike}>\r\n\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width={size} height={size} viewBox=\"0 0 24 24\"><path d=\"M12 4.248c-3.148-5.402-12-3.825-12 2.944 0 4.661 5.571 9.427 12 15.808 6.43-6.381 12-11.147 12-15.808 0-6.792-8.875-8.306-12-2.944z\"/></svg>\r\n\t\t\t</button>\r\n\t\t);\r\n\telse return(\r\n\t\t<button className=\"like icon\" onClick={like}>\r\n\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width={size} height={size} viewBox=\"0 0 24 24\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M12 21.593c-5.63-5.539-11-10.297-11-14.402 0-3.791 3.068-5.191 5.281-5.191 1.312 0 4.151.501 5.719 4.457 1.59-3.968 4.464-4.447 5.726-4.447 2.54 0 5.274 1.621 5.274 5.181 0 4.069-5.136 8.625-11 14.402m5.726-20.583c-2.203 0-4.446 1.042-5.726 3.238-1.285-2.206-3.522-3.248-5.719-3.248-3.183 0-6.281 2.187-6.281 6.191 0 4.661 5.571 9.429 12 15.809 6.43-6.38 12-11.148 12-15.809 0-4.011-3.095-6.181-6.274-6.181\"/></svg>\r\n\t\t</button>\r\n\t);\r\n};\r\n\r\nexport default Like;\r\n","import { deleteDoc, doc, getDoc } from \"@firebase/firestore\";\r\nimport { format, formatDistanceToNowStrict, fromUnixTime } from \"date-fns\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { db } from \"../../firebase\";\r\nimport VerifiedTick from \"../VerifiedTick\";\r\nimport Like from \"./Like\";\r\n\r\nconst Comment = ({ commentData, postPath, noPhoto, noTimestamp, noLike, noLikesCounter, noRemove, isCaption, setLikesWindow, refreshComments}) =>\r\n{\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst [commenterInfo, setCommenterInfo] = useState(null);\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\r\n\tconst getCommenterInfo = async () =>\r\n\t{\r\n\t\tconst commenterUid = commentData.user;\r\n\t\tconst commenterInfo = await getDoc(doc(db, \"users\", commenterUid)).then(doc => doc.data());\r\n\t\treturn commenterInfo;\r\n\t};\r\n\r\n\tconst removeComment = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tif (currentUser.user.uid !== commentData.user) throw new Error(\"Fuck off\");\r\n\t\t\tsetIsLoading(true);\r\n\t\t\tawait deleteDoc(doc(db, `${postPath}/comments/${commentData.id}`));\r\n\t\t\tawait refreshComments();\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tsetIsLoading(false);\r\n\t\t\tconsole.error(err);\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst setInfo = async () =>\r\n\t\t{\r\n\t\t\tconst info = await getCommenterInfo();\r\n\t\t\tsetCommenterInfo(info);\r\n\t\t};\r\n\t\tsetInfo();\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, []);\r\n\r\n\tif (!commenterInfo || !currentUser) return null;\r\n\treturn(\r\n\t\t<div className={`comment ${isLoading ? \"disabled\" : null}`} style={noLike ? null : {paddingRight: \"25px\"}}>\r\n\t\t\t{noPhoto || <Link to={`/${commenterInfo.username}`}><div className=\"profile-pic\"><img src={commenterInfo.profilePic} alt={`${commenterInfo.username}'s profile pic`}></img></div></Link>}\r\n\t\t\t<div className=\"info\">\r\n\t\t\t\t<div style={{display: \"inline-block\"}}>\r\n\t\t\t\t\t<Link to={`/${commenterInfo.username}`} className=\"username\">{commenterInfo.username}</Link>\r\n\t\t\t\t\t<VerifiedTick size={12.5} user={commenterInfo} marginLeft={0} marginRight={7.5}/>\r\n\t\t\t\t\t<span className=\"text\">{commentData.comment}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t{noTimestamp || <span className=\"timestamp\" title={format(fromUnixTime(commentData.timestamp.seconds), \"d MMM, yyyy\")}>{formatDistanceToNowStrict(fromUnixTime(commentData.timestamp.seconds))}</span>}\r\n\t\t\t\t\t{ noLikesCounter || commentData.likes.length === 0 ||\r\n\t\t\t\t\t\t<span className=\"likes\" onClick={() => setLikesWindow(commentData.likes)}>{commentData.likes.length} likes</span>\r\n\t\t\t\t\t}\r\n\t\t\t\t\t{(commentData.user === currentUser.user.uid && !noRemove) && <button className=\"icon\" style={{width: 15, height: 15}} onClick={removeComment}><svg width=\"15\" height=\"15\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M9 3h6v-1.75c0-.066-.026-.13-.073-.177-.047-.047-.111-.073-.177-.073h-5.5c-.066 0-.13.026-.177.073-.047.047-.073.111-.073.177v1.75zm11 1h-16v18c0 .552.448 1 1 1h14c.552 0 1-.448 1-1v-18zm-10 3.5c0-.276-.224-.5-.5-.5s-.5.224-.5.5v12c0 .276.224.5.5.5s.5-.224.5-.5v-12zm5 0c0-.276-.224-.5-.5-.5s-.5.224-.5.5v12c0 .276.224.5.5.5s.5-.224.5-.5v-12zm8-4.5v1h-2v18c0 1.105-.895 2-2 2h-14c-1.105 0-2-.895-2-2v-18h-2v-1h7v-2c0-.552.448-1 1-1h6c.552 0 1 .448 1 1v2h7z\"/></svg></button>}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t{noLike || <Like size={15} target={commentData} postPath={postPath} isComment/>}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Comment;\r\n","import { arrayRemove, arrayUnion, doc, getDoc, updateDoc } from \"@firebase/firestore\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { db } from \"../../firebase\";\r\nimport { setSnackbar } from \"../../state/actions/snackbar\";\r\n\r\nconst Save = ({size = 25, target}) =>\r\n{\r\n\tconst dispatch = useDispatch();\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst [isSaved, setIsSaved] = useState(false);\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst checkIfSaved = async () =>\r\n\t\t{\r\n\t\t\tif (!currentUser) return;\r\n\t\t\tconst currentUserSaved = await getDoc(doc(db, \"users\", currentUser.user.uid)).then(doc => doc.data().saved);\r\n\t\t\tif (currentUserSaved.includes(target.id)) setIsSaved(true);\r\n\t\t\telse setIsSaved(false);\r\n\t\t};\r\n\t\tcheckIfSaved();\r\n\t}, [currentUser, target]);\r\n\r\n\tconst save = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tif (!currentUser) throw new Error(\"User not signed in\");\r\n\t\t\tawait updateDoc(doc(db, \"users\", currentUser.user.uid),\r\n\t\t\t\t{\r\n\t\t\t\t\tsaved: arrayUnion(target.id),\r\n\t\t\t\t});\r\n\t\t\tsetIsSaved(true);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tif (err.message === \"User not signed in\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Please sign in first!\", \"error\"));\r\n\t\t\telse dispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\r\n\tconst unsave = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tawait updateDoc(doc(db, \"users\", currentUser.user.uid),\r\n\t\t\t\t{\r\n\t\t\t\t\tsaved: arrayRemove(target.id),\r\n\t\t\t\t});\r\n\t\t\tsetIsSaved(false);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tdispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\r\n\t if (isSaved) return(\r\n\t\t<button className=\"save saved icon\" onClick={unsave}>\r\n\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width={size} height={size} viewBox=\"0 0 24 24\"><path d=\"M18 24l-6-5.269-6 5.269v-24h12v24z\"/></svg>\r\n\t\t</button>\r\n\t);\r\n\telse return(\r\n\t\t<button className=\"save icon\" onClick={save}>\r\n\t\t\t<svg width={size} height={size} viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M5 0v24l7-6 7 6v-24h-14zm1 1h12v20.827l-6-5.144-6 5.144v-20.827z\"></path></svg>\r\n\t\t</button>\r\n\t);\r\n};\r\n\r\nexport default Save;\r\n","import { useRef, useState, useEffect } from \"react\";\r\nimport { Link, useHistory, useLocation } from \"react-router-dom\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { db } from \"../../firebase\";\r\nimport { collection, collectionGroup, deleteDoc, doc, getDoc, getDocs, query, serverTimestamp, setDoc, where } from \"@firebase/firestore\";\r\nimport { nanoid } from \"nanoid\";\r\nimport { format, formatDistanceToNowStrict, fromUnixTime, getYear } from \"date-fns\";\r\nimport { setSnackbar } from \"../../state/actions/snackbar\";\r\nimport FollowButton from \"../FollowButton\";\r\nimport FollowWindow from \"../FollowWindow\";\r\nimport Like from \"./Like\";\r\nimport Comment from \"./Comment\";\r\nimport Save from \"./Save\";\r\nimport VerifiedTick from \"../VerifiedTick\";\r\n\r\nconst PostWindow = ({postID, isVertical}) =>\r\n{\r\n\tconst history = useHistory();\r\n\tconst location = useLocation();\r\n\tconst addComment = useRef();\r\n\tconst dispatch = useDispatch();\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\r\n\tconst [userInfo, setUserInfo] = useState(null);\r\n\tconst [postPath, setPostPath] = useState(\"\");\r\n\tconst [postData, setPostData] = useState(null);\r\n\tconst [comments, setComments] = useState(null);\r\n\r\n\tconst [isInfoValid, setIsInfoValid] = useState(false);\r\n\tconst [commentLoading, setCommentLoading] = useState(false);\r\n\tconst [isDialogBoxOpen, setIsDialogBoxOpen] = useState(false);\r\n\tconst closeDialogBox = () => setIsDialogBoxOpen(false);\r\n\tconst [likesWindow, setLikesWindow] = useState(null);\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\treturn () => closeDialogBox();\r\n\t}, []);\r\n\r\n\tconst getUserData = async uid =>\r\n\t{\r\n\t\tconst userData = await getDoc(doc(db, \"users\", uid)).then(doc => doc.data());\r\n\t\tsetUserInfo(userData);\r\n\t};\r\n\r\n\tconst getPostComments = async (path = postPath) =>\r\n\t{\r\n\t\tlet comments = await getDocs(collection(db, `${path}/comments`))\r\n\t\t\t.then(querySnapshot => querySnapshot.docs.map(doc => doc.data()));\r\n\t\tsetComments(comments);\r\n\t};\r\n\r\n\tconst handleAddComment = async e =>\r\n\t{\r\n\t\te.preventDefault();\r\n\t\tif (!isInfoValid) return;\r\n\r\n\t\ttry\r\n\t\t{\r\n\t\t\tsetCommentLoading(true);\r\n\t\t\tconst comment = addComment.current.value;\r\n\t\t\tconst id = nanoid(32);\r\n\t\t\tif (comment.trim().length < 1)\r\n\t\t\t\tthrow new Error(\"Comment is empty\");\r\n\t\t\tif (comment.length > 2200)\r\n\t\t\t\tthrow new Error(\"Comment too long\");\r\n\t\t\tawait setDoc(doc(db, `${postPath}/comments/${id}`),\r\n\t\t\t\t{\r\n\t\t\t\t\tcomment,\r\n\t\t\t\t\tlikes: [],\r\n\t\t\t\t\tuser: currentUser.user.uid,\r\n\t\t\t\t\tid,\r\n\t\t\t\t\ttimestamp: serverTimestamp(),\r\n\t\t\t\t});\r\n\t\t\tawait getPostComments(postPath);\r\n\t\t\tsetCommentLoading(false);\r\n\t\t\taddComment.current.value = \"\";\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tif (err.message === \"Comment is empty\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Please enter a password.\", \"error\"));\r\n\t\t\telse if (err.message === \"Comment too long\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Comment too long. max is 2200 characters.\", \"error\"));\r\n\t\t\telse dispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleTextareaEnter = e =>\r\n\t{\r\n\t\tif(e.keyCode === 13 && e.shiftKey === false)\r\n\t\t{\r\n\t\t\te.preventDefault();\r\n\t\t\thandleAddComment(e);\r\n\t\t}\r\n\t};\r\n\r\n\tconst deletePost = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tif (currentUser.user.uid !== postData.user) throw new Error(\"Fuck off\");\r\n\t\t\tsetIsLoading(true);\r\n\t\t\tawait deleteDoc(doc(db, postPath));\r\n\t\t\thistory.push(\"/\");\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tsetIsLoading(false);\r\n\t\t\tconsole.error(err);\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst getData = async () =>\r\n\t\t{\r\n\t\t\t//dispatch(startLoading());\r\n\t\t\tconst postDoc = await getDocs(query(collectionGroup(db, \"user_posts\"), where(\"id\", \"==\", `${postID}`)))\r\n\t\t\t\t.then(querySnapshot => querySnapshot.docs[0]);\r\n\t\t\tsetPostData(postDoc.data());\r\n\t\t\tawait getUserData(postDoc.data().user);\r\n\t\t\tconst path = postDoc.ref.path;\r\n\t\t\tsetPostPath(path);\r\n\t\t\tawait getPostComments(path);\r\n\t\t\t//dispatch(stopLoading());\r\n\t\t};\r\n\t\tgetData();\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, []);\r\n\r\n\tif (!currentUser || !postData || !comments) return null;\r\n\tif (isVertical)\r\n\t\treturn(\r\n\t\t\t<div className=\"post-window outlined vertical\">\r\n\t\t\t\t{ likesWindow\r\n\t\t\t\t\t? <FollowWindow title=\"Likes\" uids={likesWindow} closeFollowListWindow={() => setLikesWindow(null)}/>\r\n\t\t\t\t\t: null\r\n\t\t\t\t}\r\n\t\t\t\t{ isDialogBoxOpen &&\r\n\t\t\t\t<div className=\"dialog-box-container\" onClick={closeDialogBox}>\r\n\t\t\t\t\t<div className=\"dialog-box\" onClick={e => e.stopPropagation()}>\r\n\t\t\t\t\t\t{location.pathname !== \"/\" ? null : <button className=\"text\" onClick={() => history.push(`/p/${postData.id}`)}>Go to post</button>}\r\n\t\t\t\t\t\t{location.pathname !== \"/\" ? null : <button className=\"text\" onClick={() => { navigator.clipboard.writeText(`${window.location.origin}/#/p/${postID}`); closeDialogBox(); }}>Copy Link</button>}\r\n\t\t\t\t\t\t{currentUser.user.uid === postData.user && <button className=\"remove text\" onClick={deletePost}>Delete</button>}\r\n\t\t\t\t\t\t<button className=\"cancel text\" onClick={closeDialogBox}>Cancel</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t\t<div className=\"poster\">\r\n\t\t\t\t\t<Link to={`/${userInfo.username}`}><div className=\"profile-pic outlined round\"><img src={userInfo.profilePic} alt=\"Profile Pic\"></img></div></Link>\r\n\t\t\t\t\t<Link to={`/${userInfo.username}`} className=\"username\">{userInfo.username}</Link>\r\n\t\t\t\t\t<button className=\"icon\" style={{width: 15, height: 15}} onClick={() => setIsDialogBoxOpen(true)}><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6 12c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3zm9 0c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3zm9 0c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3z\"/></svg></button>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"post-photo\">\r\n\t\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t\t<img src={postData.photo} alt={postData.caption}></img>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"side\">\r\n\t\t\t\t\t<div className=\"info\">\r\n\t\t\t\t\t\t<div className=\"interactions\">\r\n\t\t\t\t\t\t\t<div style={{display: \"flex\"}}>\r\n\t\t\t\t\t\t\t\t<Like target={postData} postPath={postPath}/>\r\n\t\t\t\t\t\t\t\t<button className=\"comment-bubble icon\"><svg width=\"25\" height=\"25\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M12 1c-6.338 0-12 4.226-12 10.007 0 2.05.739 4.063 2.047 5.625l-1.993 6.368 6.946-3c1.705.439 3.334.641 4.864.641 7.174 0 12.136-4.439 12.136-9.634 0-5.812-5.701-10.007-12-10.007m0 1c6.065 0 11 4.041 11 9.007 0 4.922-4.787 8.634-11.136 8.634-1.881 0-3.401-.299-4.946-.695l-5.258 2.271 1.505-4.808c-1.308-1.564-2.165-3.128-2.165-5.402 0-4.966 4.935-9.007 11-9.007\"/></svg></button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<Save target={postData}/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<span className=\"likes\" onClick={() => setLikesWindow(postData.likes)}><span className=\"number\">{postData.likes.length}</span> likes</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"comments\">\r\n\t\t\t\t\t\t{ postData.caption.length === 0 ||\r\n\t\t\t\t\t\t\t<Comment\r\n\t\t\t\t\t\t\t\tcommentData={{user: postData.user, comment: postData.caption, timestamp: postData.timestamp}}\r\n\t\t\t\t\t\t\t\tnoLike\r\n\t\t\t\t\t\t\t\tnoPhoto\r\n\t\t\t\t\t\t\t\tnoTimestamp\r\n\t\t\t\t\t\t\t\tnoLikesCounter\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t{comments.length > 2 && <Link to={`/p/${postID}`} style={{color: \"#8e8e8e\", fontSize: \"0.9em\", fontWeight: \"500\"}}>View all {comments.length} comments</Link>}\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcomments.slice(0, 2).map(comment =>\r\n\t\t\t\t\t\t\t\t<Comment\r\n\t\t\t\t\t\t\t\t\tcommentData={comment}\r\n\t\t\t\t\t\t\t\t\tpostPath={postPath}\r\n\t\t\t\t\t\t\t\t\tkey={comment.id}\r\n\t\t\t\t\t\t\t\t\tsetLikesWindow={setLikesWindow}\r\n\t\t\t\t\t\t\t\t\trefreshComments={getPostComments}\r\n\t\t\t\t\t\t\t\t\tnoPhoto\r\n\t\t\t\t\t\t\t\t\tnoTimestamp\r\n\t\t\t\t\t\t\t\t\tnoLikesCounter\r\n\t\t\t\t\t\t\t\t\tnoRemove\r\n\t\t\t\t\t\t\t\t/>)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t<span className=\"timestamp\" title={format(fromUnixTime(postData.timestamp.seconds), \"d MMM, yyyy\")}>\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tnew Date().getTime() / 1000 - postData.timestamp.seconds > 604800\r\n\t\t\t\t\t\t\t\t\t?\tgetYear(fromUnixTime(postData.timestamp.seconds)) === getYear(new Date())\r\n\t\t\t\t\t\t\t\t\t\t? format(fromUnixTime(postData.timestamp.seconds), \"d MMMM\")\r\n\t\t\t\t\t\t\t\t\t\t: format(fromUnixTime(postData.timestamp.seconds), \"d MMMM, yyyy\")\r\n\t\t\t\t\t\t\t\t\t: formatDistanceToNowStrict(fromUnixTime(postData.timestamp.seconds))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<form className=\"add-comment-container\" onSubmit={handleAddComment}>\r\n\t\t\t\t\t\t<textarea className={commentLoading ? \"add-comment disabled\" : \"add-comment\"} placeholder=\"Add a comment...\" ref={addComment} onChange={() => addComment.current.value.length > 0 ? setIsInfoValid(true) : setIsInfoValid(false)} onKeyDown={handleTextareaEnter}/>\r\n\t\t\t\t\t\t<button className={`${isInfoValid ? \"text\" : \"text disabled\"}`}>Post</button>\r\n\t\t\t\t\t</form>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\telse return(\r\n\t\t<div className={`post-window outlined ${isLoading ? \"disabled\" : \"\"}`}>\r\n\t\t\t{ likesWindow\r\n\t\t\t\t? <FollowWindow title=\"Likes\" uids={likesWindow} closeFollowListWindow={() => setLikesWindow(null)}/>\r\n\t\t\t\t: null\r\n\t\t\t}\r\n\t\t\t{ isDialogBoxOpen &&\r\n\t\t\t\t<div className=\"dialog-box-container\" onClick={closeDialogBox}>\r\n\t\t\t\t\t<div className=\"dialog-box\" onClick={e => e.stopPropagation()}>\r\n\t\t\t\t\t\t{currentUser.user.uid === postData.user && <button className=\"remove text\" onClick={deletePost}>Delete</button>}\r\n\t\t\t\t\t\t<button className=\"cancel text\" onClick={closeDialogBox}>Cancel</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t}\r\n\t\t\t<img src={postData.photo} alt={postData.caption}></img>\r\n\t\t\t<div className=\"side\">\r\n\t\t\t\t<div className=\"poster\">\r\n\t\t\t\t\t<Link to={`/${userInfo.username}`}><div className=\"profile-pic outlined round\"><img src={userInfo.profilePic} alt=\"Profile Pic\"></img></div></Link>\r\n\t\t\t\t\t<Link to={`/${userInfo.username}`} className=\"username\">{userInfo.username}</Link>\r\n\t\t\t\t\t<VerifiedTick size={15} user={userInfo} marginLeft={7.5}/>\r\n\t\t\t\t\t{postData.user === currentUser.user.uid && <button className=\"icon\" style={{width: 15, height: 15}} onClick={() => setIsDialogBoxOpen(true)}><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6 12c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3zm9 0c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3zm9 0c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3z\"/></svg></button>}\r\n\t\t\t\t\t{currentUser.info.uid === userInfo.uid ? null : <FollowButton target={userInfo}></FollowButton>}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"comments\">\r\n\t\t\t\t\t{ postData.caption.length === 0 ||\r\n\t\t\t\t\t\t<Comment\r\n\t\t\t\t\t\t\tcommentData={{user: postData.user, comment: postData.caption, timestamp: postData.timestamp}}\r\n\t\t\t\t\t\t\tnoLike\r\n\t\t\t\t\t\t\tnoLikesCounter\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t}\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcomments.map(comment =>\r\n\t\t\t\t\t\t\t<Comment\r\n\t\t\t\t\t\t\t\tcommentData={comment}\r\n\t\t\t\t\t\t\t\tpostPath={postPath}\r\n\t\t\t\t\t\t\t\tkey={comment.id}\r\n\t\t\t\t\t\t\t\tsetLikesWindow={setLikesWindow}\r\n\t\t\t\t\t\t\t\trefreshComments={getPostComments}\r\n\t\t\t\t\t\t\t/>)\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"info\">\r\n\t\t\t\t\t<div className=\"interactions\">\r\n\t\t\t\t\t\t<div style={{display: \"flex\"}}>\r\n\t\t\t\t\t\t\t<Like target={postData} postPath={postPath}/>\r\n\t\t\t\t\t\t\t<button className=\"comment-bubble icon\"><svg width=\"25\" height=\"25\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M12 1c-6.338 0-12 4.226-12 10.007 0 2.05.739 4.063 2.047 5.625l-1.993 6.368 6.946-3c1.705.439 3.334.641 4.864.641 7.174 0 12.136-4.439 12.136-9.634 0-5.812-5.701-10.007-12-10.007m0 1c6.065 0 11 4.041 11 9.007 0 4.922-4.787 8.634-11.136 8.634-1.881 0-3.401-.299-4.946-.695l-5.258 2.271 1.505-4.808c-1.308-1.564-2.165-3.128-2.165-5.402 0-4.966 4.935-9.007 11-9.007\"/></svg></button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<Save target={postData}/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<span className=\"likes\" onClick={() => setLikesWindow(postData.likes)}><span className=\"number\">{postData.likes.length}</span> likes</span>\r\n\t\t\t\t\t<span className=\"timestamp\" title={format(fromUnixTime(postData.timestamp.seconds), \"d MMM, yyyy\")}>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tgetYear(fromUnixTime(postData.timestamp.seconds)) === getYear(new Date())\r\n\t\t\t\t\t\t\t\t? format(fromUnixTime(postData.timestamp.seconds), \"d MMMM\")\r\n\t\t\t\t\t\t\t\t: format(fromUnixTime(postData.timestamp.seconds), \"d MMMM, yyyy\")\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<form className=\"add-comment-container\" onSubmit={handleAddComment}>\r\n\t\t\t\t\t<textarea className={commentLoading ? \"add-comment disabled\" : \"add-comment\"} placeholder=\"Add a comment...\" ref={addComment} onChange={() => addComment.current.value.length > 0 ? setIsInfoValid(true) : setIsInfoValid(false)} onKeyDown={handleTextareaEnter}/>\r\n\t\t\t\t\t<button className={`${isInfoValid ? \"text\" : \"text disabled\"}`}>Post</button>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default PostWindow;\r\n","import { collectionGroup, doc, getDoc, getDocs, query, where } from \"@firebase/firestore\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { useMediaQuery } from \"react-responsive\";\r\nimport { db } from \"../firebase\";\r\nimport { startLoading, stopLoading } from \"../state/actions/isLoading\";\r\nimport PostWindow from \"./Posts/PostWindow\";\r\n\r\nconst HomePage = () =>\r\n{\r\n\tconst postsRef = useRef();\r\n\tconst dispatch = useDispatch();\r\n\tconst currentUser = useSelector(state => state.currentUser.info);\r\n\tconst [maxDate, setMaxDate] = useState(null);\r\n\tconst [scroll, setScroll] = useState(0);\r\n\tconst [olderPosts, setOlderPosts] = useState(null);\r\n\tconst [postsToDisplay, setPostsToDisplay] = useState(null);\r\n\tconst [left, setLeft] = useState(null);\r\n\tconst setNewLeft = () => postsRef.current ? setLeft(parseInt(window.getComputedStyle(postsRef.current).marginLeft) + parseInt(window.getComputedStyle(postsRef.current).width)) : null;\r\n\tconst smallScreenQuery = useMediaQuery({query: \"(max-width: 1024px)\"});\r\n\r\n\tconst handleScroll = () =>\r\n\t{\r\n\t\tconst winScroll = document.body.scrollTop || document.documentElement.scrollTop;\r\n\t\tconst height = document.documentElement.scrollHeight - document.documentElement.clientHeight;\r\n  \tsetScroll(winScroll / height * 100);\r\n\t};\r\n\tuseEffect(handleScroll, []);\r\n\r\n\tuseEffect(() => document.title = \"Instadicey\", []);\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst getPosts = async () =>\r\n\t\t{\r\n\t\t\tif (!currentUser) return;\r\n\t\t\tdispatch(startLoading());\r\n\t\t\tconst currentUserFollowing = await getDoc(doc(db, \"users\", currentUser.uid, \"user_follows\", \"following\"))\r\n\t\t\t\t.then(doc => doc.data())\r\n\t\t\t\t.then(data => data ? data.following : []);\r\n\t\t\tif (currentUserFollowing.length > 0)\r\n\t\t\t{\r\n\t\t\t\tconst maximumDate = new Date(new Date().getTime() - (3 * 24 * 60 * 60 * 1000));\r\n\t\t\t\tsetMaxDate(maximumDate);\r\n\t\t\t\tconst q = query(collectionGroup(db, \"user_posts\"), where(\"user\", \"in\", currentUserFollowing), where(\"timestamp\", \">=\", maximumDate));\r\n\t\t\t\tlet posts = await getDocs(q).then(querySnapshot => querySnapshot.docs.map(doc => doc.data()));\r\n\t\t\t\tposts = posts.sort((a, b) => a.timestamp.seconds < b.timestamp.seconds ? 1 : -1);\r\n\t\t\t\tsetPostsToDisplay(posts);\r\n\t\t\t} else setPostsToDisplay([]);\r\n\t\t\tdispatch(stopLoading());\r\n\t\t};\r\n\t\tgetPosts();\r\n\t}, [currentUser, dispatch]);\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tif (scroll < 75 || !maxDate || olderPosts) return;\r\n\r\n\t\tconst getOlderPosts = async () =>\r\n\t\t{\r\n\t\t\tconst currentUserFollowing = await getDoc(doc(db, \"users\", currentUser.uid, \"user_follows\", \"following\")).then(doc => doc.data().following);\r\n\t\t\tif (currentUserFollowing.length > 0)\r\n\t\t\t{\r\n\t\t\t\tconst q = query(collectionGroup(db, \"user_posts\"), where(\"user\", \"in\", currentUserFollowing), where(\"timestamp\", \"<=\", maxDate));\r\n\t\t\t\tlet posts = await getDocs(q).then(querySnapshot => querySnapshot.docs.map(doc => doc.data()));\r\n\t\t\t\tposts = posts.sort((a, b) => a.timestamp.seconds < b.timestamp.seconds ? 1 : -1);\r\n\t\t\t\tsetOlderPosts(posts);\r\n\t\t\t} else setOlderPosts([]);\r\n\t\t};\r\n\t\tgetOlderPosts();\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, [scroll, currentUser, maxDate]);\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\twindow.addEventListener(\"scroll\", handleScroll);\r\n\t\twindow.addEventListener(\"resize\", setNewLeft);\r\n\t\treturn () =>\r\n\t\t{\r\n\t\t\twindow.removeEventListener(\"scroll\", handleScroll);\r\n\t\t\twindow.removeEventListener(\"resize\", setNewLeft);\r\n\t\t};\r\n\t}, [postsRef]);\r\n\r\n\tif (!postsToDisplay) return null;\r\n\treturn(\r\n\t\t<div className=\"home-page\">\r\n\t\t\t{/* { (left && !smallScreenQuery) &&\r\n\t\t\t\t<div className=\"sidebar\" style={{left}}>\r\n\t\t\t\t\t<div style={{display: \"flex\", alignItems: \"center\"}}>\r\n\t\t\t\t\t\t<Link to={`/${currentUser.username}`}><div className=\"profile-pic\" style={{width: 50, height: 50}}><img src={currentUser.profilePic} alt={`${currentUser.username}'s profile pic`}></img></div></Link>\r\n\t\t\t\t\t\t<Link to={`/${currentUser.username}`} className=\"username\">{currentUser.username}</Link>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div> */\r\n\t\t\t}\r\n\t\t\t{\r\n\t\t\t\tpostsToDisplay &&\r\n\t\t\t\t<div className=\"posts\" ref={postsRef} onLoad={setNewLeft}>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tpostsToDisplay.map(post =>\r\n\t\t\t\t\t\t\t<PostWindow postID={post.id} isVertical key={post.id}/>)\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t}\r\n\t\t\t{ olderPosts &&\r\n\t\t\t\t\t<div className=\"older-posts posts\" ref={postsRef} onLoad={setNewLeft}>\r\n\t\t\t\t\t\t<h2>Showing posts older than 3 days</h2>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tolderPosts.map(post =>\r\n\t\t\t\t\t\t\t\t<PostWindow postID={post.id} isVertical key={post.id}/>)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default HomePage;\r\n","import { collection, collectionGroup, getDocs, query, where } from \"@firebase/firestore\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { db } from \"../../firebase\";\r\nimport Loading from \"../../assets/misc/loading.jpg\";\r\n\r\nconst PostCard = ({postID}) =>\r\n{\r\n\tconst [isHovered, setIsHovered] = useState(false);\r\n\tconst [postData, setPostData] = useState(null);\r\n\tconst [comments, setComments] = useState(null);\r\n\tconst getPostData = async () =>\r\n\t{\r\n\t\tconst post = await getDocs(query(collectionGroup(db, \"user_posts\"), where(\"id\", \"==\", postID)))\r\n\t\t\t.then(querySnapshot => querySnapshot.docs[0]);\r\n\t\tsetPostData(post.data());\r\n\t\treturn post.ref.path;\r\n\t};\r\n\tconst getPostComments = async path =>\r\n\t{\r\n\t\tconst commentsData = await getDocs(collection(db, `${path}/comments`))\r\n\t\t\t.then(querySnapshot => querySnapshot.docs.map(doc => doc.data()));\r\n\t\tsetComments(commentsData);\r\n\t};\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst getData = async () =>\r\n\t\t{\r\n\t\t\tconst path = await getPostData();\r\n\t\t\tawait getPostComments(path);\r\n\t\t};\r\n\t\tgetData();\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, []);\r\n\r\n\r\n\tif (!postData || !comments) return <div className=\"post-card loading outlined\"><div className=\"container\"><img src={Loading} alt=\"loading\" style={{height: \"25%\", position: \"absolute\", inset: 0, margin: \"auto\"}}></img></div></div>;\r\n\telse return(\r\n\t\t<div className=\"post-card\" onMouseOver={() => setIsHovered(true)} onMouseLeave={() => setIsHovered(false)}>\r\n\t\t\t<div className=\"container\">\r\n\t\t\t\t<Link to={`/p/${postData.id}`}>\r\n\t\t\t\t\t{ isHovered &&\r\n\t\t\t\t\t\t<div className=\"hovered\">\r\n\t\t\t\t\t\t\t<span><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\"><path d=\"M12 4.248c-3.148-5.402-12-3.825-12 2.944 0 4.661 5.571 9.427 12 15.808 6.43-6.381 12-11.147 12-15.808 0-6.792-8.875-8.306-12-2.944z\"></path></svg> {postData.likes.length}</span>\r\n\t\t\t\t\t\t\t<span><svg xmlns=\"http://www.w3.org/2000/svg\" className=\"comment-bubble\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\"><path d=\"M.054 23c.971-1.912 2.048-4.538 1.993-6.368-1.308-1.562-2.047-3.575-2.047-5.625 0-5.781 5.662-10.007 12-10.007 6.299 0 12 4.195 12 10.007 0 6.052-6.732 11.705-15.968 9.458-1.678 1.027-5.377 2.065-7.978 2.535z\"/></svg> {comments.length}</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t}\r\n\t\t\t\t\t<img src={postData.photo} alt={postData.caption}></img>\r\n\t\t\t\t</Link>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default PostCard;\r\n","import { collection, getDocs, query, where } from \"@firebase/firestore\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Route, Switch, useParams } from \"react-router\";\r\nimport { Link, NavLink } from \"react-router-dom\";\r\nimport { db } from \"../firebase\";\r\nimport { startLoading, stopLoading } from \"../state/actions/isLoading\";\r\nimport FollowButton from \"./FollowButton\";\r\nimport FollowWindow from \"./FollowWindow\";\r\nimport PostCard from \"./Posts/PostCard\";\r\nimport \"./user-profile.css\";\r\nimport VerifiedTick from \"./VerifiedTick\";\r\n\r\nconst UserProfile = () =>\r\n{\r\n\tconst { username } = useParams();\r\n\r\n\tconst dispatch = useDispatch();\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst [userInfo, setUserInfo] = useState(null);\r\n\tconst [userFollows, setUserFollows] = useState(null);\r\n\tconst [userPosts, setUserPosts] = useState([]);\r\n\tconst [isFollowingListWindowOpen, setIsFollowingListWindowOpen] = useState(false);\r\n\tconst [isFollowersListWindowOpen, setIsFollowersListWindowOpen] = useState(false);\r\n\tconst closeFollowListWindow = () =>\r\n\t{\r\n\t\tsetIsFollowingListWindowOpen(false);\r\n\t\tsetIsFollowersListWindowOpen(false);\r\n\t};\r\n\r\n\tconst getUserInfo = async () =>\r\n\t{\r\n\t\tconst usersRef = collection(db, \"users\");\r\n\t\tconst q = query(usersRef, where(\"username\", \"==\", username));\r\n\t\tconst querySnapshot = await getDocs(q);\r\n\t\treturn querySnapshot;\r\n\t};\r\n\r\n\tconst getUsersFollows = async uid =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tconst userFollows = await getDocs(collection(db, \"users\", uid, \"user_follows\")).then(querySnapshot => Object.assign({}, ...querySnapshot.docs.map(doc => doc.data())));\r\n\t\t\tif (!!userFollows.following === false)\r\n\t\t\t\tuserFollows.following = [];\r\n\t\t\tif (!!userFollows.followers === false)\r\n\t\t\t\tuserFollows.followers = [];\r\n\t\t\tsetUserFollows(userFollows);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(\"Error getting user follows\", err.message);\r\n\t\t}\r\n\t};\r\n\r\n\tconst getUsersPosts = async uid =>\r\n\t{\r\n\t\tconst querySnapshot = await getDocs(collection(db, \"users\", uid, \"user_posts\"));\r\n\t\tconst posts = querySnapshot.docs.map(doc => doc.data()).sort((a, b) => a.timestamp.seconds > b.timestamp.seconds ? -1 : 1);\r\n\t\tsetUserPosts(posts);\r\n\t};\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tcloseFollowListWindow();\r\n\r\n\t\tconst fetchUserInfo = async () =>\r\n\t\t{\r\n\t\t\tdispatch(startLoading());\r\n\t\t\tconst querySnapshot = await getUserInfo();\r\n\t\t\tconst userData = querySnapshot.docs[0].data();\r\n\t\t\tif (querySnapshot.size === 1) setUserInfo(userData);\r\n\t\t\telse setUserInfo(null);\r\n\r\n\t\t\tawait getUsersPosts(userData.uid);\r\n\r\n\t\t\tawait getUsersFollows(userData.uid);\r\n\t\t\tdispatch(stopLoading());\r\n\t\t};\r\n\t\tfetchUserInfo();\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, [username]);\r\n\t\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tif (!userInfo) return;\r\n\t\tuserInfo.realName\r\n\t\t\t?\tdocument.title = `${userInfo.realName} (@${userInfo.username}) • Instadicey`\r\n\t\t\t: document.title = `@${userInfo.username} • Instadicey`;\r\n\t}, [userInfo]);\r\n\r\n\tif (!userInfo || !currentUser || !userFollows) return <div>not found</div>;\r\n\telse return(\r\n\t\t<div className=\"user-profile\">\r\n\t\t\t{ isFollowingListWindowOpen\r\n\t\t\t\t? <FollowWindow title=\"Following\" uids={userFollows.following} closeFollowListWindow={closeFollowListWindow}/>\r\n\t\t\t\t: isFollowersListWindowOpen\r\n\t\t\t\t\t? <FollowWindow title=\"Followers\" uids={userFollows.followers} closeFollowListWindow={closeFollowListWindow}/>\r\n\t\t\t\t\t: null\r\n\t\t\t}\r\n\t\t\t<div className=\"upper\">\r\n\t\t\t\t<div className=\"personal-info\">\r\n\t\t\t\t\t<div className=\"profile-pic\"><img src={userInfo.profilePic} alt={`${username}'s profile pic`}></img></div>\r\n\t\t\t\t\t<div className=\"info\">\r\n\t\t\t\t\t\t<div className=\"name\">\r\n\t\t\t\t\t\t\t{userInfo.username}\r\n\t\t\t\t\t\t\t<VerifiedTick user={userInfo}/>\r\n\t\t\t\t\t\t\t{ currentUser\r\n\t\t\t\t\t\t\t\t? userInfo.uid === currentUser.info.uid\r\n\t\t\t\t\t\t\t\t\t? <Link to=\"/accounts/edit\" className=\"edit-profile-btn outlined\">Edit Profile</Link>\r\n\t\t\t\t\t\t\t\t\t: <FollowButton target={userInfo}/>\r\n\t\t\t\t\t\t\t\t: <FollowButton target={userInfo}/>\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"follow\">\r\n\t\t\t\t\t\t\t<span className=\"posts\"><span className=\"number\">{userPosts.length}</span> posts</span>\r\n\t\t\t\t\t\t\t<span className=\"followers\" onClick={() => setIsFollowersListWindowOpen(true)}><span className=\"number\">{userFollows.followers.length}</span> followers</span>\r\n\t\t\t\t\t\t\t<span className=\"following\" onClick={() => setIsFollowingListWindowOpen(true)}><span className=\"number\">{userFollows.following.length}</span> following</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"bio\">\r\n\t\t\t\t\t\t\t<span className=\"real-name\">{userInfo.realName}</span>\r\n\t\t\t\t\t\t\t<div className=\"bio-text\">{userInfo.bio}</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<nav>\r\n\t\t\t\t<ul>\r\n\t\t\t\t\t<li><NavLink exact to={`/${userInfo.username}`} activeClassName=\"selected\"><svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" viewBox=\"0 0 24 24\"><path d=\"M6 6h-6v-6h6v6zm9-6h-6v6h6v-6zm9 0h-6v6h6v-6zm-18 9h-6v6h6v-6zm9 0h-6v6h6v-6zm9 0h-6v6h6v-6zm-18 9h-6v6h6v-6zm9 0h-6v6h6v-6zm9 0h-6v6h6v-6z\"/></svg> POSTS</NavLink></li>\r\n\t\t\t\t\t{currentUser.user.uid === userInfo.uid && <li><NavLink exact to={`/${userInfo.username}/saved`} activeClassName=\"selected\"><svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" viewBox=\"0 0 24 24\"><path d=\"M16 2v17.582l-4-3.512-4 3.512v-17.582h8zm2-2h-12v24l6-5.269 6 5.269v-24z\"/></svg> SAVED</NavLink></li>}\r\n\t\t\t\t</ul>\r\n\t\t\t</nav>\r\n\t\t\t<Switch>\r\n\t\t\t\t<Route exact path=\"/:username\">\r\n\t\t\t\t\t<div className=\"post-cards-container\">\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tuserPosts.map(post =>\r\n\t\t\t\t\t\t\t\t<PostCard postID={post.id} key={post.id}/>)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Route>\r\n\t\t\t\t<Route exact path=\"/:username/saved\">\r\n\t\t\t\t\t<div className=\"post-cards-container\">\r\n\t\t\t\t\t\t{ currentUser.user.uid === userInfo.uid &&\r\n\t\t\t\t\t\t\tuserInfo.saved.map(post =>\r\n\t\t\t\t\t\t\t\t<PostCard postID={post} key={post}/>)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Route>\r\n\t\t\t</Switch>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default UserProfile;\r\n","import { useEffect, useRef, useState } from \"react\";\r\nimport { useHistory } from \"react-router\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { db, storage } from \"../../firebase\";\r\nimport { doc, serverTimestamp, setDoc, } from \"@firebase/firestore\";\r\nimport { getDownloadURL, ref, uploadBytes } from \"@firebase/storage\";\r\nimport store from \"../../state\";\r\nimport { startLoading, stopLoading } from \"../../state/actions/isLoading\";\r\nimport { setNewPost } from \"../../state/actions/newPost\";\r\nimport { setSnackbar } from \"../../state/actions/snackbar\";\r\nimport { nanoid } from \"nanoid\";\r\nimport Cropper from \"react-easy-crop\";\r\n\r\nconst NewPost = () =>\r\n{\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst photo = useSelector(state => state.newPost);\r\n\tconst [photoUrl, setPhotoUrl] = useState(\"\");\r\n\tconst [crop, setCrop] = useState({ x: 0, y: 0 });\r\n\tconst [zoom, setZoom] = useState(1);\r\n\tconst [rotation, setRotation] = useState(0);\r\n\tconst [croppedAreaPixels, setCroppedAreaPixels] = useState(null);\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\tuseEffect(() => currentUser ? dispatch(stopLoading()) : dispatch(startLoading()), [photoUrl, currentUser]);\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tif (!photo) return;\r\n\t\tconst reader = new FileReader();\r\n\t\treader.readAsDataURL(photo);\r\n\t\treader.onloadend = () => setPhotoUrl(reader.result);\r\n\t}, [photo]);\r\n\r\n\tconst captionRef = useRef();\r\n\tconst dispatch = useDispatch();\r\n\tconst history = useHistory();\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst photo = store.getState().newPost;\r\n\t\tif (!photo) return history.push(\"/\");\r\n\r\n\t\treturn () => dispatch(setNewPost(null));\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t},[]);\r\n\r\n\tconst { getCroppedImg } = foo;\r\n\r\n\tconst cancel = () => history.push(\"/\");\r\n\r\n\tconst share = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tdispatch(startLoading());\r\n\t\t\tconst postID = nanoid(32);\r\n\t\t\tconst caption = captionRef.current.value;\r\n\t\t\tconst croppedPhoto = await getCroppedImg(photoUrl, croppedAreaPixels, rotation);\r\n\r\n\t\t\tconst postPhotoRef = ref(storage, `users/${currentUser.user.uid}/posts/${postID}.png`);\r\n\t\t\tawait uploadBytes(postPhotoRef, croppedPhoto);\r\n\t\t\tconst postUrl = await getDownloadURL(postPhotoRef);\r\n\t\t\tawait setDoc(doc(db, \"users\", currentUser.user.uid, \"user_posts\", postID),\r\n\t\t\t\t{\r\n\t\t\t\t\tphoto: postUrl,\r\n\t\t\t\t\tcaption,\r\n\t\t\t\t\tuser: currentUser.user.uid,\r\n\t\t\t\t\tlikes: [],\r\n\t\t\t\t\tid: postID,\r\n\t\t\t\t\ttimestamp: serverTimestamp(),\r\n\t\t\t\t});\r\n\r\n\t\t\tdispatch(setSnackbar(\"Post uploaded.\", \"success\"));\r\n\t\t\thistory.push(`/p/${postID}`);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tdispatch(stopLoading());\r\n\t\t\tconsole.error(err);\r\n\t\t\tdispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\r\n\tif (!currentUser || !photoUrl) return null;\r\n\treturn(\r\n\t\t<div className=\"new-post\">\r\n\t\t\t<div className=\"header\">\r\n\t\t\t\t<button className=\"cancel text\" onClick={cancel}><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" className=\"bi bi-x-lg\" viewBox=\"0 0 16 16\"><path d=\"M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z\"/></svg></button>\r\n\t\t\t\tNew Photo Post\r\n\t\t\t\t<button className=\"text\" onClick={share}>Share</button>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"cropper-container\">\r\n\t\t\t\t<Cropper\r\n\t\t\t\t\timage={photoUrl}\r\n\t\t\t\t\tcrop={crop}\r\n\t\t\t\t\tzoom={zoom}\r\n\t\t\t\t\tzoomSpeed={0.5}\r\n\t\t\t\t\tonCropChange={setCrop}\r\n\t\t\t\t\tonZoomChange={setZoom}\r\n\t\t\t\t\tonRotationChange={setRotation}\r\n\t\t\t\t\tonCropComplete={(croppedArea, croppedAreaPixels) => setCroppedAreaPixels(croppedAreaPixels)}\r\n\t\t\t\t\taspect={1}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"caption-container outlined\">\r\n\t\t\t\t<div className=\"profile-pic outlined round\"><img src={currentUser.info.profilePic} alt=\"profile pic\"></img></div>\r\n\t\t\t\t<textarea className=\"caption\" placeholder=\"Write a caption...\" ref={captionRef}></textarea>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nconst foo = (() =>\r\n{\r\n\tconst createImage = url =>\r\n\t\tnew Promise((resolve, reject) => {\r\n\t\t\tconst image = new Image();\r\n\t\t\timage.addEventListener(\"load\", () => resolve(image));\r\n\t\t\timage.addEventListener(\"error\", error => reject(error));\r\n\t\t\timage.setAttribute(\"crossOrigin\", \"anonymous\"); // needed to avoid cross-origin issues on CodeSandbox\r\n\t\t\timage.src = url;\r\n\t\t});\r\n\r\n\tfunction getRadianAngle(degreeValue) {\r\n\t\treturn (degreeValue * Math.PI) / 180;\r\n\t}\r\n\r\n\t/**\r\n\t * This function was adapted from the one in the ReadMe of https://github.com/DominicTobias/react-image-crop\r\n\t * @param {File} image - Image File url\r\n\t * @param {Object} pixelCrop - pixelCrop Object provided by react-easy-crop\r\n\t * @param {number} rotation - optional rotation parameter\r\n\t */\r\n\tconst getCroppedImg = async (imageSrc, pixelCrop, rotation = 0) => {\r\n\t\tconst image = await createImage(imageSrc);\r\n\t\tconst canvas = document.createElement(\"canvas\");\r\n\t\tconst ctx = canvas.getContext(\"2d\");\r\n\r\n\t\tconst maxSize = Math.max(image.width, image.height);\r\n\t\tconst safeArea = 2 * ((maxSize / 2) * Math.sqrt(2));\r\n\r\n\t\t// set each dimensions to double largest dimension to allow for a safe area for the\r\n\t\t// image to rotate in without being clipped by canvas context\r\n\t\tcanvas.width = safeArea;\r\n\t\tcanvas.height = safeArea;\r\n\r\n\t\t// translate canvas context to a central location on image to allow rotating around the center.\r\n\t\tctx.translate(safeArea / 2, safeArea / 2);\r\n\t\tctx.rotate(getRadianAngle(rotation));\r\n\t\tctx.translate(-safeArea / 2, -safeArea / 2);\r\n\r\n\t\t// draw rotated image and store data.\r\n\t\tctx.drawImage(\r\n\t\t\timage,\r\n\t\t\tsafeArea / 2 - image.width * 0.5,\r\n\t\t\tsafeArea / 2 - image.height * 0.5\r\n\t\t);\r\n\t\tconst data = ctx.getImageData(0, 0, safeArea, safeArea);\r\n\r\n\t\t// set canvas width to final desired crop size - this will clear existing context\r\n\t\tcanvas.width = pixelCrop.width;\r\n\t\tcanvas.height = pixelCrop.height;\r\n\r\n\t\t// paste generated rotate image with correct offsets for x,y crop values.\r\n\t\tctx.putImageData(\r\n\t\t\tdata,\r\n\t\t\tMath.round(0 - safeArea / 2 + image.width * 0.5 - pixelCrop.x),\r\n\t\t\tMath.round(0 - safeArea / 2 + image.height * 0.5 - pixelCrop.y)\r\n\t\t);\r\n\r\n\t\t// As Base64 string\r\n\t\t// return canvas.toDataURL(\"image/jpeg\");\r\n\r\n\t\t// As a blob\r\n\t\treturn new Promise(resolve => canvas.toBlob(file => resolve(file), \"image/png\"));\r\n\t};\r\n\r\n\treturn { getCroppedImg };\r\n})();\r\n\r\nexport default NewPost;\r\n","import { useEffect, useState } from \"react\";\r\nimport { useParams } from \"react-router\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { db } from \"../../firebase\";\r\nimport { collection, collectionGroup, getDocs, limit, query, where } from \"@firebase/firestore\";\r\nimport { startLoading, stopLoading } from \"../../state/actions/isLoading\";\r\nimport PostWindow from \"./PostWindow\";\r\nimport \"./post-page.css\";\r\nimport PostCard from \"./PostCard\";\r\n\r\nconst PostPage = () =>\r\n{\r\n\tconst { postID } = useParams();\r\n\tconst dispatch = useDispatch();\r\n\tconst [postExists, setPostExists] = useState(false);\r\n\tconst [morePosts, setMorePosts] = useState(null);\r\n\tconst [isSmallScreen, setIsSmallScreen] = useState(false);\r\n\tconst handleResize = () => window.innerWidth < 1024 ? setIsSmallScreen(true) : setIsSmallScreen(false);\r\n\tuseEffect(() =>\r\n\t{\r\n\t\thandleResize();\r\n\t\twindow.addEventListener(\"resize\", handleResize);\r\n\t\treturn () => window.removeEventListener(\"resize\", handleResize);\r\n\t}, []);\r\n\r\n\tconst checkIfPostExists = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tdispatch(startLoading());\r\n\t\t\tconst q = query(collectionGroup(db, \"user_posts\"), where(\"id\", \"==\", postID));\r\n\t\t\tconst querySnapshot = await getDocs(q);\r\n\t\t\tif (!querySnapshot.docs[0]) throw Error(\"Post doesn't exist\");\r\n\t\t\tsetPostExists(true);\r\n\t\t\tgetMorePosts(querySnapshot.docs[0].data());\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tif (err.message === \"Post doesn't exist\")\r\n\t\t\t\tsetPostExists(false);\r\n\t\t}\r\n\t\tdispatch(stopLoading());\r\n\t};\r\n\r\n\tconst getMorePosts = async postData =>\r\n\t{\r\n\t\tconst q = query(collection(db, `users/${postData.user}/user_posts`), where(\"id\", \"!=\", postData.id), limit(6));\r\n\t\tconst morePosts = await getDocs(q).then(querySnapshot => querySnapshot.docs.map(doc => doc.data()).sort((a, b) => a.timestamp.seconds < b.timestamp.seconds ? 1 : -1));\r\n\t\tconsole.error(morePosts);\r\n\t\tsetMorePosts(morePosts);\r\n\t};\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tsetPostExists(false);\r\n\t\tcheckIfPostExists();\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, [postID]);\r\n\r\n\tif (!postExists) return null;\r\n\telse return(\r\n\t\t<div className=\"post-page\">\r\n\t\t\t{\r\n\t\t\t\tisSmallScreen\r\n\t\t\t\t\t? <PostWindow postID={postID} isVertical/>\r\n\t\t\t\t\t: <PostWindow postID={postID}/>\r\n\t\t\t}\r\n\t\t\t<div className=\"more-posts\">\r\n\t\t\t\t<header>More posts from this user</header>\r\n\t\t\t\t{ morePosts &&\r\n\t\t\t\t\t<div className=\"post-cards-container\">\r\n\t\t\t\t\t\t{ morePosts.map(post => <PostCard postID={post.id} key={post.id}/>) }\r\n\t\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default PostPage;\r\n","import { Link } from \"react-router-dom\";\r\n\r\nconst Message = ({messageInfo, userInfo, noPhoto, isSent}) =>\r\n{\r\n\treturn(\r\n\t\t<div className={`message ${isSent ? \"sent\" : \"\"}`}>\r\n\t\t\t{ noPhoto\r\n\t\t\t\t? <span className=\"dummy\" style={{width: 32, height: 32}}></span>\r\n\t\t\t\t: <Link to={`/${userInfo.username}`} className=\"profile-pic\"><img src={userInfo.profilePic} alt={`${userInfo.username}'s profile pic`}></img></Link>\r\n\t\t\t}\r\n\t\t\t<span className=\"text outlined round\">{messageInfo.message}</span>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Message;\r\n","import { collection, doc, getDoc, getDocs, onSnapshot, orderBy, query, serverTimestamp, setDoc, updateDoc } from \"@firebase/firestore\";\r\nimport { nanoid } from \"nanoid\";\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { useHistory } from \"react-router\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { db } from \"../../firebase\";\r\nimport Message from \"./Message\";\r\n\r\nconst Room = ({roomID}) =>\r\n{\r\n\tconst history = useHistory();\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst messageRef = useRef();\r\n\tconst [otherUser, setOtherUser] = useState(null);\r\n\tconst [messages, setMessages] = useState(null);\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\r\n\tconst getOtherUserInfo = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tconst roomInfo = await getDoc(doc(db, \"chats\", roomID)).then(doc => doc.data());\r\n\t\t\tif (!roomInfo) throw new Error(\"Room doesn't exist\");\r\n\t\t\tconst otherUserUid = roomInfo.members.filter(member => member !== currentUser.info.uid)[0];\r\n\t\t\tconst otherUser = await getDoc(doc(db, \"users\", otherUserUid)).then(doc => doc.data());\r\n\t\t\tsetOtherUser(otherUser);\r\n\t\t\treturn otherUser;\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tif (err.message === \"Room doesn't exist\")\r\n\t\t\t\thistory.push(\"/direct/inbox\");\r\n\t\t}\r\n\t};\r\n\r\n\tconst getMessages = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tconst q = query(collection(db, \"chats\", roomID, \"messages\"), orderBy(\"timestamp\", \"asc\"));\r\n\t\t\tconst messagesArray = await getDocs(q)\r\n\t\t\t\t.then(querySnapshot => querySnapshot.docs.map(doc => doc.data()));\r\n\t\t\tsetMessages(messagesArray);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t}\r\n\t};\r\n\r\n\tconst sendMessage = async e =>\r\n\t{\r\n\t\te.preventDefault();\r\n\t\ttry\r\n\t\t{\r\n\t\t\tsetIsLoading(true);\r\n\t\t\tconst message = messageRef.current.value;\r\n\t\t\tconst id = nanoid(32);\r\n\t\t\tif (message.trim() === \"\") throw new Error(\"Message is empty\");\r\n\r\n\t\t\tawait Promise.all(\r\n\t\t\t\t[\r\n\t\t\t\t\tsetDoc(doc(db, \"chats\", roomID, \"messages\", id),\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\tmessage,\r\n\t\t\t\t\t\t\tuser: currentUser.user.uid,\r\n\t\t\t\t\t\t\ttimestamp: serverTimestamp(),\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\tupdateDoc(doc(db, \"chats\", roomID),\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tlastMessage: {id, message},\r\n\t\t\t\t\t\t\tlastUpdated: serverTimestamp(),\r\n\t\t\t\t\t\t})\r\n\t\t\t\t]\r\n\t\t\t);\r\n\r\n\t\t\tmessageRef.current.value = \"\";\r\n\t\t\tsetIsLoading(false);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() => document.title = \"Instadicey • Chats\");\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst q = query(collection(db, \"chats\", roomID, \"messages\"), orderBy(\"timestamp\", \"asc\"));\r\n\t\tconst unsubscribe = onSnapshot(q, querySnapshot => setMessages(querySnapshot.docs.map(doc => doc.data())));\r\n\r\n\t\treturn () => unsubscribe();\r\n\t}, [roomID]);\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst getData = async () =>\r\n\t\t{\r\n\t\t\tif (getOtherUserInfo())\r\n\t\t\t{\r\n\t\t\t\tgetMessages();\r\n\t\t\t}\r\n\t\t};\r\n\t\tgetData();\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, [roomID]);\r\n\r\n\tif (!otherUser || !messages) return null;\r\n\treturn(\r\n\t\t<div className=\"chat-room\">\r\n\t\t\t<header><Link to={`/${otherUser.username}`} style={{display: \"flex\", alignItems: \"center\"}}><span className=\"profile-pic\" style={{marginRight: \"1rem\"}}><img src={otherUser.profilePic} alt={`${otherUser.username}'s pic`}></img></span>{otherUser.username}</Link></header>\r\n\t\t\t<div className=\"messages\">\r\n\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tmessages.map((message, i, messagesArray) => \r\n\t\t\t\t\t\t\tmessage.user === currentUser.user.uid \r\n\t\t\t\t\t\t\t\t? <Message messageInfo={message} userInfo={currentUser.info} noPhoto isSent key={message.id}/> \r\n\t\t\t\t\t\t\t\t: messagesArray[i + 1] \r\n\t\t\t\t\t\t\t\t\t? messagesArray[i].user === messagesArray[i + 1].user\r\n\t\t\t\t\t\t\t\t\t\t? <Message messageInfo={message} userInfo={otherUser} noPhoto key={message.id}/>\r\n\t\t\t\t\t\t\t\t\t\t: <Message messageInfo={message} userInfo={otherUser} key={message.id}/>\r\n\t\t\t\t\t\t\t\t\t: <Message messageInfo={message} userInfo={otherUser} key={message.id}/>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"send-message-container\">\r\n\t\t\t\t<form className=\"outlined round\" onSubmit={sendMessage}>\r\n\t\t\t\t\t<input className={`${isLoading ? \"disabled\" : \"\"}`} placeholder=\"Message...\" ref={messageRef}/>\r\n\t\t\t\t\t<button className=\"text\">Send</button>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Room;\r\n","import { useEffect, useState } from \"react\";\r\nimport { Route, useParams } from \"react-router\";\r\nimport { NavLink, Switch } from \"react-router-dom\";\r\nimport { useMediaQuery } from \"react-responsive\";\r\nimport { useSelector } from \"react-redux\";\r\nimport Room from \"./Room\";\r\nimport { collection, doc, getDoc, getDocs, onSnapshot, query, where } from \"@firebase/firestore\";\r\nimport { db } from \"../../firebase\";\r\nimport { formatDistanceToNowStrict, fromUnixTime } from \"date-fns\";\r\nimport FollowWindow from \"../FollowWindow\";\r\nimport \"./inbox.css\";\r\n\r\nconst Inbox = () =>\r\n{\r\n\tconst { roomID } = useParams();\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst [currentUserFollows, setCurrentUserFollows] = useState(null);\r\n\tconst [recentChats, setRecentChats] = useState(null);\r\n\tconst [isNewMessageBoxOpen, setIsNewMessageBoxOpen] = useState(false);\r\n\tconst closeNewMessageBox = () => setIsNewMessageBoxOpen(false);\r\n\tconst phoneQuery = useMediaQuery({query: \"(max-width: 600px)\"});\r\n\r\n\tconst formatDate = date =>\r\n\t{\r\n\t\tlet dateStringArray = date.split(\" \");\r\n\t\tdateStringArray[1] = dateStringArray[1].slice(0, 1);\r\n\t\tconst dateString = dateStringArray.join(\" \");\r\n\t\treturn dateString;\r\n\t};\r\n\r\n\tconst getChats = async () =>\r\n\t{\r\n\t\tif (!currentUser) return;\r\n\t\ttry\r\n\t\t{\r\n\t\t\tconst q = query(collection(db, \"chats\"), where(\"members\", \"array-contains\", currentUser.user.uid));\r\n\t\t\tlet chats = await getDocs(q)\r\n\t\t\t\t.then(querySnapshot => querySnapshot.docs.map(doc => doc.data()))\r\n\t\t\t\t.then(chats => chats.filter(chat => chat.lastMessage ? chat : false))\r\n\t\t\t\t.then(chats => chats.sort((a,b) => a.lastUpdated < b.lastUpdated ? 1 : -1))\r\n\t\t\t\t.then(chats => Promise.all(chats.map(async chat =>\r\n\t\t\t\t{\r\n\t\t\t\t\tconst otherUser = await getDoc(doc(db, \"users\", chat.members.filter(user => user !== currentUser.user.uid)[0])).then(doc => doc.data());\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...chat,\r\n\t\t\t\t\t\totherUser,\r\n\t\t\t\t\t};\r\n\t\t\t\t})));\r\n\t\t\tsetRecentChats(chats);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t}\r\n\t};\r\n\r\n\tconst getUsersFollows = async () =>\r\n\t{\r\n\t\tif (!currentUser) return;\r\n\t\ttry\r\n\t\t{\r\n\t\t\tconst currentUserFollows = await getDocs(collection(db, \"users\", currentUser.user.uid, \"user_follows\")).then(querySnapshot => Object.assign({}, ...querySnapshot.docs.map(doc => doc.data())));\r\n\t\t\tif (!currentUserFollows.following)\r\n\t\t\t\tcurrentUserFollows.following = [];\r\n\t\t\tif (!currentUserFollows.followers)\r\n\t\t\t\tcurrentUserFollows.followers = [];\r\n\t\t\tsetCurrentUserFollows(currentUserFollows);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t}\r\n\t};\r\n\t\r\n\tuseEffect(() => document.title = \"Inbox • Chats\");\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\tuseEffect(() => getUsersFollows(), [currentUser]);\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\tuseEffect(() => getChats(), [currentUser]);\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tif (!currentUser) return;\r\n\t\tconst q = query(collection(db, \"chats\"), where(\"members\", \"array-contains\", currentUser.user.uid));\r\n\t\tconst unsubscribe = onSnapshot(q, async querySnapshot =>\r\n\t\t{\r\n\t\t\tconst chats = querySnapshot.docs.map(doc => doc.data()).filter(chat => chat.lastMessage ? chat : false).sort((a, b) => a.lastUpdated < b.lastUpdated ? 1 : -1);\r\n\t\t\tconst recentChats = await Promise.all(chats.map(async chat =>\r\n\t\t\t{\r\n\t\t\t\tconst otherUser = await getDoc(doc(db, \"users\", chat.members.filter(user => user !== currentUser.user.uid)[0])).then(doc => doc.data());\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...chat,\r\n\t\t\t\t\totherUser,\r\n\t\t\t\t};\r\n\t\t\t}));\r\n\t\t\tsetRecentChats(recentChats);\r\n\t\t});\r\n\r\n\t\treturn () => unsubscribe();\r\n\t}, [currentUser]);\r\n\r\n\tif (!currentUser || !recentChats) return null;\r\n\tif (phoneQuery)\r\n\t\treturn(\r\n\t\t\t<div className=\"inbox-window outlined\">\r\n\t\t\t\t{ isNewMessageBoxOpen &&\r\n\t\t\t\t\t\t<FollowWindow title=\"New Message\" uids={[...currentUserFollows.following, ...currentUserFollows.followers]} closeFollowListWindow={closeNewMessageBox} newMessage/>\r\n\t\t\t\t}\r\n\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t<Switch>\r\n\t\t\t\t\t\t<Route exact path=\"/direct/inbox\">\r\n\t\t\t\t\t\t\t<div className=\"recent-chats left\">\r\n\t\t\t\t\t\t\t\t<header>{currentUser.info.username}<button className=\"icon\" onClick={() => setIsNewMessageBoxOpen(true)}><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M8.071 21.586l-7.071 1.414 1.414-7.071 14.929-14.929 5.657 5.657-14.929 14.929zm-.493-.921l-4.243-4.243-1.06 5.303 5.303-1.06zm9.765-18.251l-13.3 13.301 4.242 4.242 13.301-13.3-4.243-4.243z\"/></svg></button></header>\r\n\t\t\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\trecentChats.map(chat =>\r\n\t\t\t\t\t\t\t\t\t\t\t<NavLink to={`/direct/t/${chat.id}`} activeClassName=\"selected\" key={chat.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<li key={chat.otherUser.uid}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"profile-pic\"><img src={chat.otherUser.profilePic} alt={`${chat.otherUser.currentUser}'s profile pic`}></img></span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"username\">{chat.otherUser.username}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"message\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>{chat.lastMessage.message}</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span>• {formatDate(formatDistanceToNowStrict(fromUnixTime(chat.lastUpdated ? chat.lastUpdated.seconds : 0)))}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t</NavLink>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Route>\r\n\t\t\t\t\t\t<Route path=\"/direct/t/:roomID\">\r\n\t\t\t\t\t\t\t<Room roomID={roomID}/>\r\n\t\t\t\t\t\t</Route>\r\n\t\t\t\t\t</Switch>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\telse return(\r\n\t\t<div className=\"inbox-window outlined\">\r\n\t\t\t{ isNewMessageBoxOpen &&\r\n\t\t\t\t\t<FollowWindow title=\"New Message\" uids={[...currentUserFollows.following, ...currentUserFollows.followers]} closeFollowListWindow={closeNewMessageBox} newMessage/>\r\n\t\t\t}\r\n\t\t\t<div className=\"container\">\r\n\t\t\t\t<div className=\"recent-chats left\">\r\n\t\t\t\t\t<header>{currentUser.info.username}<button className=\"icon\" onClick={() => setIsNewMessageBoxOpen(true)}><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M8.071 21.586l-7.071 1.414 1.414-7.071 14.929-14.929 5.657 5.657-14.929 14.929zm-.493-.921l-4.243-4.243-1.06 5.303 5.303-1.06zm9.765-18.251l-13.3 13.301 4.242 4.242 13.301-13.3-4.243-4.243z\"/></svg></button></header>\r\n\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\trecentChats.map(chat =>\r\n\t\t\t\t\t\t\t\t<NavLink to={`/direct/t/${chat.id}`} activeClassName=\"selected\" key={chat.id}>\r\n\t\t\t\t\t\t\t\t\t<li key={chat.otherUser.uid}>\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"profile-pic\"><img src={chat.otherUser.profilePic} alt={`${chat.otherUser.currentUser}'s profile pic`}></img></span>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"info\">\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"username\">{chat.otherUser.username}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"message\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div>{chat.lastMessage.message}</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span>• {formatDate(formatDistanceToNowStrict(fromUnixTime(chat.lastUpdated ? chat.lastUpdated.seconds : 0)))}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t</NavLink>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"chat-window right\">\r\n\t\t\t\t\t<Switch>\r\n\t\t\t\t\t\t<Route exact path=\"/direct/inbox\">Inbox</Route>\r\n\t\t\t\t\t\t<Route path=\"/direct/t/:roomID\"><Room roomID={roomID}/></Route>\r\n\t\t\t\t\t</Switch>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Inbox;\r\n","import { EmailAuthProvider, reauthenticateWithCredential, updatePassword } from \"@firebase/auth\";\r\nimport { useRef, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Link } from \"react-router-dom\";\r\nimport Loading from \"../../assets/misc/loading.jpg\";\r\nimport { auth } from \"../../firebase\";\r\nimport { setSnackbar } from \"../../state/actions/snackbar\";\r\n\r\nconst ChangePassword = () =>\r\n{\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst dispatch = useDispatch();\r\n\tconst [isInfoValid, setIsInfoValid] = useState(null);\r\n\tconst [isLoading, setIsLoading] = useState(null);\r\n\r\n\tconst oldPasswordRef = useRef();\r\n\tconst newPasswordRef = useRef();\r\n\tconst confirmPasswordRef = useRef();\r\n\r\n\tconst handleOnChange = () =>\r\n\t\toldPasswordRef.current.value.length > 0\r\n\t\t&& newPasswordRef.current.value.length > 0\r\n\t\t&& confirmPasswordRef.current.value.length > 0\r\n\t\t\t?\tsetIsInfoValid(true)\r\n\t\t\t: setIsInfoValid(false);\r\n\r\n\tconst handleSubmit = async e =>\r\n\t{\r\n\t\te.preventDefault();\r\n\t\tif (!isInfoValid) return;\r\n\t\t\r\n\t\ttry\r\n\t\t{\r\n\t\t\tsetIsLoading(true);\r\n\t\t\tconst oldPassword = oldPasswordRef.current.value;\r\n\t\t\tconst newPassword = newPasswordRef.current.value;\r\n\t\t\tconst confirmPassword = confirmPasswordRef.current.value;\r\n\t\t\tif (newPassword !== confirmPassword) throw new Error(\"Password don't match\");\r\n\t\t\tif (newPassword.length < 6) throw new Error(\"Password too short\");\r\n\r\n\t\t\ttry\r\n\t\t\t{\r\n\t\t\t\tconst credentials = EmailAuthProvider.credential(currentUser.user.email, oldPassword);\r\n\t\t\t\tawait reauthenticateWithCredential(auth.currentUser, credentials);\r\n\t\t\t\tawait updatePassword(auth.currentUser, newPassword);\r\n\t\t\t\tdispatch(setSnackbar(\"Password updated successfully.\", \"success\"));\r\n\t\t\t\twindow.location.reload(false);\r\n\t\t\t} catch (err) { throw new Error(err.code); }\r\n\t\t\tsetIsLoading(false);\r\n\t\t} catch(err)\r\n\t\t{\r\n\t\t\tsetIsLoading(false);\r\n\t\t\tconsole.error(err.message);\r\n\t\t\tif (err.message === \"Password don't match\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Please make sure both password match.\", \"error\"));\r\n\t\t\tif (err.message === \"Password too short\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Password is too short. minimum is 6 characters.\", \"error\"));\r\n\t\t\tif (err.message === \"auth/wrong-password\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Your old password is not correct.\", \"error\"));\r\n\t\t\tdispatch(setSnackbar(\"Oops, please try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\r\n\tif (!currentUser) return null;\r\n\treturn(\r\n\t\t<div className=\"account-element change-password\">\r\n\t\t\t<div className=\"element profile-pic\">\r\n\t\t\t\t<div className=\"img-container outlined left\">\r\n\t\t\t\t\t<img src={currentUser.info.profilePic} alt={`${currentUser.info.username}'s profile pic'`}></img>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t{currentUser.info.username}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<form onSubmit={handleSubmit}>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<div className=\"left\">\r\n\t\t\t\t\t\t<label htmlFor=\"old-password\">Old Password</label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t\t<input type=\"password\" id=\"old-password\" className=\"outlined\" ref={oldPasswordRef} onChange={handleOnChange}></input>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<div className=\"left\">\r\n\t\t\t\t\t\t<label htmlFor=\"new-password\">New Password</label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t\t<input type=\"password\" id=\"new-password\" className=\"outlined\" ref={newPasswordRef} onChange={handleOnChange}></input>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<div className=\"left\">\r\n\t\t\t\t\t\t<label htmlFor=\"confirm-password\">Confirm New Password</label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t\t<input type=\"password\" id=\"confirm-password\" className=\"outlined\" ref={confirmPasswordRef} onChange={handleOnChange}></input>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<div className=\"left\"></div>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tisLoading\r\n\t\t\t\t\t\t\t? <button className=\"loading\"><div><img src={Loading} alt=\"loading\"></img></div></button>\r\n\t\t\t\t\t\t\t: <button className={`submit ${isInfoValid ? null : \"disabled\"}`}>Change Password</button>\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<div className=\"left\"></div>\r\n\t\t\t\t\t<Link to=\"/accounts/password/reset\" className=\"forgot-password\">Forgot Password?</Link>\r\n\t\t\t\t</div>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default ChangePassword;\r\n","import { useRef, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { auth, db, storage } from \"../../firebase\";\r\nimport { collection, doc, getDoc, getDocs, query, updateDoc, where } from \"@firebase/firestore\";\r\nimport { ref, uploadBytes, getDownloadURL } from \"@firebase/storage\";\r\nimport { setSnackbar } from \"../../state/actions/snackbar\";\r\nimport Loading from \"../../assets/misc/loading.jpg\";\r\nimport { EmailAuthProvider, reauthenticateWithCredential, sendEmailVerification, updateEmail } from \"@firebase/auth\";\r\nimport { setUser } from \"../../state/actions/currentUser\";\r\n\r\nconst EditProfile = () =>\r\n{\r\n\tconst dispatch = useDispatch();\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst [isInfoValid, setIsInfoValid] = useState(false);\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\tconst [isPhotoLoading, setIsPhotoLoading] = useState(false);\r\n\tconst [isPhotoChangerBoxOpen, setIsPhotoChangerBoxOpen] = useState(false);\r\n\r\n\tconst uploadRef = useRef();\r\n\tconst nameRef = useRef();\r\n\tconst usernameRef = useRef();\r\n\tconst bioRef = useRef();\r\n\tconst emailRef = useRef();\r\n\tconst confirmPasswordRef = useRef();\r\n\r\n\tconst openPhotoBox = () => currentUser.info.defaultProfilePic ? openPhotoUpload() : setIsPhotoChangerBoxOpen(true);\r\n\tconst closePhotoBox = () => setIsPhotoChangerBoxOpen(false);\r\n\tconst removePhoto = async () =>\r\n\t{\r\n\t\tclosePhotoBox();\r\n\t\tsetIsPhotoLoading(true);\r\n\t\tawait updateDoc(doc(db, \"users\", currentUser.user.uid), { profilePic: \"https://firebasestorage.googleapis.com/v0/b/instadicey.appspot.com/o/default%2FprofilePic.jpg?alt=media&token=3ac835a3-016e-470a-b7b3-f898d82cdbde\", defaultProfilePic: true });\r\n\t\tawait updateUserLocally();\r\n\t\tsetIsPhotoLoading(false);\r\n\t};\r\n\tconst openPhotoUpload = () => uploadRef.current.click();\r\n\tconst uploadPhoto = async input =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tconst uploadedPhoto = input.target.files[0];\r\n\t\t\tif (!uploadedPhoto)\r\n\t\t\t\tthrow new Error(\"No photo uploaded\");\r\n\t\t\tconst acceptedFormats = uploadRef.current.accept.split(\", \");\r\n\t\t\tif (!acceptedFormats.includes(uploadedPhoto.type))\r\n\t\t\t  throw new Error(\"Not a supported photo format\");\r\n\t\t\tclosePhotoBox();\r\n\t\t\tsetIsPhotoLoading(true);\r\n\t\t\tconst photoRef = ref(storage, `users/${currentUser.user.uid}/profilePic`);\r\n\t\t\tawait uploadBytes(photoRef, uploadedPhoto);\r\n\t\t\tconst uploadedPhotoURL = await getDownloadURL(photoRef);\r\n\t\t\tawait updateDoc(doc(db, \"users\", currentUser.user.uid), { profilePic: uploadedPhotoURL, defaultProfilePic: false });\r\n\t\t\tawait updateUserLocally();\r\n\t\t\tuploadRef.current.value = \"\";\r\n\t\t\tsetIsPhotoLoading(false);\r\n\t\t\tdispatch(setSnackbar(\"Photo updated successfully\", \"success\"));\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tif (err.message === \"No photo uploaded\")\r\n\t\t\t\treturn null;\r\n\t\t\tif (err.message === \"Not a supported photo format\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Not a supported photo format.\", \"error\"));\r\n\t\t\tdispatch(setSnackbar(\"Oops, please try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleChange = () => isInfoValid ? null : setIsInfoValid(true);\r\n\r\n\tconst handleNameChange = async realName =>\r\n\t{\r\n\t\treturn realName;\r\n\t};\r\n\r\n\tconst handleUsernameChange = async username =>\r\n\t{\r\n\t\tif (username.length > 20) throw new Error(\"Username too long\");\r\n\t\tif (username.trim() === \"\") throw new Error(\"Username not entered\");\r\n\t\tif (!username.match(/^[A-Za-z0-9]*$/)) throw new Error(\"Username not English\");\r\n\t\tconst usersRef = collection(db, \"users\");\r\n\t\tconst q = query(usersRef, where(\"username\", \"==\", username));\r\n\t\tconst querySnapshot = await getDocs(q);\r\n\t\tif (querySnapshot.docs.length !== 0)\r\n\t\t\tthrow new Error(\"Username already taken\");\r\n\t\treturn username;\r\n\t};\r\n\r\n\tconst handleBioChange = async bio =>\r\n\t{\r\n\t\tif (bio.length > 150) throw new Error(\"Bio too long\");\r\n\t\treturn bio;\r\n\t};\r\n\r\n\tconst handleEmailChange = async (email, password) =>\r\n\t{\r\n\t\tif (email.trim() === \"\") throw new Error(\"Email can't be empty\");\r\n\t\t// eslint-disable-next-line no-control-regex\r\n\t\tif (!email.match(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])/))\r\n\t\t\tthrow new Error(\"Email is invalid\");\r\n\t\tif (password.trim() === \"\") throw new Error(\"Password can't be empty\");\r\n\t\tconst credentials = EmailAuthProvider.credential(currentUser.user.email, password);\r\n\t\ttry\r\n\t\t{\r\n\t\t\tawait reauthenticateWithCredential(auth.currentUser, credentials);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tthrow new Error(err.code);\r\n\t\t}\r\n\t\treturn email;\r\n\t};\r\n\r\n\tconst handleSubmit = async e =>\r\n\t{\r\n\t\te.preventDefault();\r\n\t\tif (!isInfoValid) return;\r\n\t\tsetIsLoading(true);\r\n\t\ttry\r\n\t\t{\r\n\t\t\tlet realName = currentUser.info.realName;\r\n\t\t\tlet username = currentUser.info.username;\r\n\t\t\tlet bio = currentUser.info.bio;\r\n\t\t\tlet email = currentUser.user.email;\r\n\r\n\t\t\tif (realName !== nameRef.current.value) realName = await handleNameChange(nameRef.current.value);\r\n\t\t\tif (username !== usernameRef.current.value) username = await handleUsernameChange(usernameRef.current.value);\r\n\t\t\tif (bio !== bioRef.current.value) bio = await handleBioChange(bioRef.current.value);\r\n\t\t\tif (email !== emailRef.current.value) email = await handleEmailChange(emailRef.current.value, confirmPasswordRef.current.value);\r\n\r\n\t\t\tawait updateDoc(doc(db, \"users\", currentUser.user.uid),\r\n\t\t\t\t{\r\n\t\t\t\t\trealName,\r\n\t\t\t\t\tusername,\r\n\t\t\t\t\tbio,\r\n\t\t\t\t});\r\n\t\t\tif (currentUser.user.email !== email)\r\n\t\t\t{\r\n\t\t\t\ttry\r\n\t\t\t\t{\r\n\t\t\t\t\tawait updateEmail(auth.currentUser, email);\r\n\t\t\t\t\tawait sendEmailVerification(auth.currentUser);\r\n\t\t\t\t} catch (err) { throw new Error(err.code); }\r\n\t\t\t}\r\n\t\t\tdispatch(setSnackbar(\"Info updated.\", \"success\"));\r\n\t\t\twindow.location.reload(false);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err.message);\r\n\t\t\tsetIsLoading(false);\r\n\t\t\tif (err.message === \"Username not entered\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Username can't be empty.\", \"error\"));\r\n\t\t\tif (err.message === \"Username too long\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Username too long. max is 20 characters.\", \"error\"));\r\n\t\t\tif (err.message === \"Username not English\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"English letters only.\", \"error\"));\r\n\t\t\tif (err.message === \"Username already taken\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Username already taken.\", \"error\"));\r\n\t\t\tif (err.message === \"Bio too long\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Bio is too long. max is 150 characters.\", \"error\"));\r\n\t\t\tif (err.message === \"Email can't be empty\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Email can't be empty.\", \"error\"));\r\n\t\t\tif (err.message === \"Email is invalid\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Email is invalid.\", \"error\"));\r\n\t\t\tif (err.message === \"Password can't be empty\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Please confirm your password.\", \"error\"));\r\n\t\t\tif (err.message === \"auth/email-already-in-use\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Email already in use.\"));\r\n\t\t\tif (err.message === \"auth/wrong-password\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Wrong password.\", \"error\"));\r\n\t\t\tdispatch(setSnackbar(\"Oops, please try again later.\", \"error\"));\r\n\t\t}\r\n\t\tsetIsLoading(false);\r\n\t};\r\n\r\n\tconst updateUserLocally = async () =>\r\n\t{\r\n\t\tconst info = await getDoc(doc(db, \"users\", currentUser.user.uid)).then(doc => doc.data());\r\n\t\tdispatch(setUser({ user: auth.currentUser, info }));\r\n\t};\r\n\r\n\tif (!currentUser) return null;\r\n\treturn(\r\n\t\t<div className=\"account-element edit-profile\">\r\n\t\t\t{ isPhotoChangerBoxOpen &&\r\n\t\t\t\t\t<div className=\"dialog-box-container\" onClick={closePhotoBox}>\r\n\t\t\t\t\t\t<div className=\"dialog-box\" onClick={e => e.stopPropagation()}>\r\n\t\t\t\t\t\t\t<h2>Change Profile Photo</h2>\r\n\t\t\t\t\t\t\t<button className=\"upload text\" onClick={openPhotoUpload}>Upload Photo</button>\r\n\t\t\t\t\t\t\t<button className=\"remove text\" onClick={removePhoto}>Remove Current Photo</button>\r\n\t\t\t\t\t\t\t<button className=\"cancel text\" onClick={closePhotoBox}>Cancel</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t}\r\n\t\t\t<div className=\"element profile-pic-container\">\r\n\t\t\t\t<div className=\"img-container outlined left\" onClick={openPhotoBox}>\r\n\t\t\t\t\t{ isPhotoLoading && <div className=\"loading\"><img src={Loading} alt=\"loading\"></img></div>}\r\n\t\t\t\t\t<img src={currentUser.info.profilePic} alt={`${currentUser.info.username}'s profile pic'`}></img>\r\n\t\t\t\t\t<input id=\"photo\" type=\"file\" accept=\"image/png, image/jpg, image/jpeg, image/pjpeg, image/jfif, image/pjp\" style={{display: \"none\"}} ref={uploadRef} onChange={uploadPhoto}></input>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t{currentUser.info.username}\r\n\t\t\t\t\t<button className=\"text\" onClick={openPhotoBox}>Change Profile Photo</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<form onSubmit={handleSubmit}>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<label htmlFor=\"name\" className=\"left\">Name</label>\r\n\t\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t\t<input type=\"text\" id=\"name\" defaultValue={currentUser.info.realName} placeholder=\"Name\" ref={nameRef} className=\"outlined\" onChange={handleChange}></input>\r\n\t\t\t\t\t\t<p>Help people discover your account by using the name you're known by: either your full name, nickname, or business name.</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<label htmlFor=\"username\" className=\"left\">Username</label>\r\n\t\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t\t<input type=\"text\" id=\"username\" defaultValue={currentUser.info.username} placeholder=\"Username\" ref={usernameRef} className=\"outlined\" onChange={handleChange}></input>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<label htmlFor=\"bio\" className=\"left\">Bio</label>\r\n\t\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t\t<textarea id=\"bio\" defaultValue={currentUser.info.bio} ref={bioRef} className=\"outlined\" onChange={handleChange}></textarea>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"element info\">\r\n\t\t\t\t\t<span className=\"left\"></span>\r\n\t\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t\t<p className=\"header\">Personal Information</p>\r\n\t\t\t\t\t\t<p>Provide your personal information, even if the account is used for a business, a pet or something else. This won't be a part of your public profile.</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<label htmlFor=\"email\" className=\"left\">Email</label>\r\n\t\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t\t<input type=\"text\" id=\"email\" defaultValue={currentUser.user.email} placeholder=\"Email\" ref={emailRef} className=\"outlined\" onChange={handleChange}></input>\r\n\t\t\t\t\t\t{ !emailRef.current || currentUser.user.email === emailRef.current.value\r\n\t\t\t\t\t\t\t? null \r\n\t\t\t\t\t\t\t: <input type=\"password\" id=\"password\" placeholder=\"Confirm Password\" ref={confirmPasswordRef} className=\"outlined\"></input>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<div className=\"left\"></div>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tisLoading\r\n\t\t\t\t\t\t\t? <button className=\"loading\"><div><img src={Loading} alt=\"loading\"></img></div></button>\r\n\t\t\t\t\t\t\t: <button className={`submit ${isInfoValid ? null : \"disabled\"}`}>Submit</button>\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default EditProfile;\r\n","import { useEffect } from \"react\";\r\nimport { Route, Switch, useHistory } from \"react-router\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport \"./acc-edit.css\";\r\nimport ChangePassword from \"./ChangePassword\";\r\nimport EditProfile from \"./EditProfile\";\r\nimport { useMediaQuery } from \"react-responsive\";\r\n\r\nconst AccountEdit = () =>\r\n{\r\n\tconst history = useHistory();\r\n\tconst phoneQuery = useMediaQuery({query: \"(max-width: 600px)\"});\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tif (history.location.pathname === \"/accounts/edit\")\r\n\t\t\tdocument.title = \"Edit Profile • Instadicey\";\r\n\t\telse if (history.location.pathname === \"/accounts/password/change\")\r\n\t\t\tdocument.title = \"Change Password • Instadicey\";\r\n\t}, [history.location.pathname]);\r\n\r\n\treturn(\r\n\t\t<div className=\"account-edit outlined\">\r\n\t\t\t{ !phoneQuery &&\r\n\t\t\t\t<ul className=\"sidebar\">\r\n\t\t\t\t\t<li><NavLink exact to=\"/accounts/edit\" activeClassName=\"selected\">Edit Profile</NavLink></li>\r\n\t\t\t\t\t<li><NavLink to=\"/accounts/password/change\" activeClassName=\"selected\">Change Password</NavLink></li>\r\n\t\t\t\t</ul>\r\n\t\t\t}\r\n\t\t\t<div className=\"main\">\r\n\t\t\t\t<Switch>\r\n\t\t\t\t\t<Route exact path=\"/accounts/edit\" component={EditProfile}></Route>\r\n\t\t\t\t\t<Route exact path=\"/accounts/password/change\" component={ChangePassword}></Route>\r\n\t\t\t\t</Switch>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default AccountEdit;\r\n","import { useEffect, useState } from \"react\";\r\nimport { Route, Switch, useLocation } from \"react-router\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { auth, db } from \"./firebase\";\r\nimport { onAuthStateChanged } from \"@firebase/auth\";\r\nimport { doc, getDoc } from \"@firebase/firestore\";\r\nimport { Snackbar, Slide, Alert } from \"@mui/material\";\r\nimport Navbar from \"./components/Navbar\";\r\nimport LoadingPage from \"./components/LoadingPage\";\r\n\r\nimport { stopLoading } from \"./state/actions/isLoading\";\r\nimport { setUser } from \"./state/actions/currentUser\";\r\nimport { closeSnackbar } from \"./state/actions/snackbar\";\r\n\r\nimport SignUpPage from \"./components/AccountAuth/SignUpPage\";\r\nimport PasswordReset from \"./components/AccountAuth/PasswordReset\";\r\nimport LoginPage from \"./components/AccountAuth/LoginPage\";\r\nimport AccountVerification from \"./components/AccountAuth/AccountVerification\";\r\n\r\nimport Logged from \"./components/HomePage\";\r\nimport UserProfile from \"./components/UserProfile\";\r\nimport newPost from \"./components/Posts/NewPost\";\r\nimport PostPage from \"./components/Posts/PostPage\";\r\n\r\nimport Inbox from \"./components/Inbox/Inbox\";\r\n\r\nimport AccountEdit from \"./components/AccountEdit/AccountEdit\";\r\nimport \"./styles/App.css\";\r\n\r\nconst App = () =>\r\n{\r\n\tconst dispatch = useDispatch();\r\n\tconst location = useLocation();\r\n\tconst [navbarVisibility, setNavbarVisibility] = useState(true);\r\n\tconst isLoggedIn = useSelector(state => state.currentUser);\r\n\tconst isLoading = useSelector(state => state.loading);\r\n\tconst snackbar = useSelector(state => state.snackbar);\r\n\tsnackbar.handleClose = () => dispatch(closeSnackbar());\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst url = location.pathname;\r\n\t\tif (url === \"/create/style\")\r\n\t\t\tsetNavbarVisibility(false);\r\n\t\telse setNavbarVisibility(true);\r\n\t}, [location.pathname]);\r\n\r\n\tconst checkIfLoggedIn = () =>\r\n\t{\r\n\t\tonAuthStateChanged(auth, async user =>\r\n\t\t{\r\n\t\t\tif (user && user.emailVerified)\r\n\t\t\t{\r\n\t\t\t\tconst info = await getDoc(doc(db, \"users\", user.uid)).then(doc => doc.data());\r\n\t\t\t\tdispatch(setUser({user, info}));\r\n\t\t\t\tdispatch(stopLoading());\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tdispatch(setUser(null));\r\n\t\t\t\tdispatch(stopLoading());\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\tuseEffect(checkIfLoggedIn, [dispatch]);\r\n\r\n\treturn (\r\n\t\t<div className=\"App\" style={isLoggedIn && navbarVisibility ? { paddingTop: \"75px\" } : null}>\r\n\t\t\t{ isLoggedIn && navbarVisibility ? <Navbar/> : null }\r\n\t\t\t{\r\n\t\t\t\tisLoading\r\n\t\t\t\t\t? <Route path=\"/\" component={LoadingPage}></Route>\r\n\t\t\t\t\t: null\r\n\t\t\t}\r\n\r\n\t\t\t<Switch>\r\n\t\t\t\t<Route exact path=\"/\">\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tisLoggedIn\r\n\t\t\t\t\t\t\t? <Logged/>\r\n\t\t\t\t\t\t\t: <LoginPage/>\r\n\t\t\t\t\t}\r\n\t\t\t\t</Route>\r\n\t\t\t\t<Route exact path=\"/accounts/email-signup\" component={SignUpPage}></Route>\r\n\t\t\t\t<Route exact path=\"/accounts/password-reset\" component={PasswordReset}></Route>\r\n\t\t\t\t<Route path=\"/accounts/verify\" component={AccountVerification}></Route>\r\n\t\t\t\t\r\n\t\t\t\t<Route path=\"/accounts\" component={AccountEdit}></Route>\r\n\r\n\t\t\t\t<Route exact path=\"/direct/inbox\" component={Inbox}></Route>\r\n\t\t\t\t<Route exact path=\"/direct/t/:roomID\" component={Inbox}></Route>\r\n\r\n\t\t\t\t<Route exact path=\"/:username\" component={UserProfile}></Route>\r\n\t\t\t\t<Route exact path=\"/:username/saved\" component={UserProfile}></Route>\r\n\t\t\t\t<Route exact path=\"/create/style\" component={newPost}></Route>\r\n\r\n\t\t\t\t<Route exact path=\"/p/:postID\" component={PostPage}></Route>\r\n\t\t\t</Switch>\r\n\r\n\t\t\t<Snackbar\r\n\t\t\t\topen={snackbar.open}\r\n\t\t\t\tmessage={snackbar.message}\r\n\t\t\t\tautoHideDuration={5000}\r\n\t\t\t\tonClose={snackbar.handleClose}\r\n\t\t\t\tanchorOrigin={{ vertical: \"bottom\", horizontal: \"center\" }}\r\n\t\t\t\tTransitionComponent={Slide}\r\n\t\t\t\tclassName=\"snackbar\"\r\n\t\t\t>\r\n\t\t\t\t<Alert onClose={snackbar.handleClose} severity={snackbar.severity} icon={false}>{snackbar.message}</Alert>\r\n\t\t\t</Snackbar>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default App;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { HashRouter as Router } from \"react-router-dom\";\r\nimport { Provider } from \"react-redux\";\r\nimport store from \"./state\";\r\nimport App from \"./App\";\r\nimport \"./styles/index.css\";\r\n\r\nReactDOM.render(\r\n\t<Router>\r\n\t\t<Provider store={store}>\r\n\t\t\t<React.StrictMode>\r\n\t\t\t\t<App />\r\n\t\t\t</React.StrictMode>\r\n\t\t</Provider>\r\n\t</Router>,\r\n\tdocument.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}