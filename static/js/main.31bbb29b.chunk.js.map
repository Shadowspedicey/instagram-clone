{"version":3,"sources":["state/reducers/isLoading.js","state/reducers/currentUser.js","state/reducers/snackbar.js","state/reducers/newPost.js","state/reducers/index.js","state/index.js","firebase.js","state/actions/currentUser.js","state/actions/snackbar.js","state/actions/newPost.js","assets/namelogo.png","assets/logo.png","assets/misc/loading.jpg","components/Navbar.js","state/actions/isLoading.js","components/LoadingPage.js","components/AccountAuth/ErrorMsg.js","assets/misc/email-verification.png","components/AccountAuth/SignUpPage.js","assets/misc/green-checkmark.png","components/AccountAuth/PasswordReset.js","assets/misc/lock.png","components/AccountAuth/LoginPage.js","assets/misc/red-x.png","components/AccountAuth/AccountVerification.js","components/AccountEdit/ChangePassword.js","components/AccountEdit/EditProfile.js","components/AccountEdit/AccountEdit.js","components/FollowButton.js","components/VerifiedTick.js","components/FollowWindow.js","components/Posts/Like.js","components/Posts/Comment.js","components/Posts/Save.js","components/Posts/PostWindow.js","components/HomePage.js","components/BrokenPage.js","components/Posts/PostCard.js","components/UserProfile.js","components/Posts/NewPost.js","components/Posts/PostPage.js","components/Inbox/Message.js","components/Inbox/Room.js","assets/misc/send-message.png","components/Inbox/Inbox.js","App.js","index.js"],"names":["isLoading","state","action","type","currentUser","payload","defaultState","message","severity","open","snackbar","newPost","file","root","combineReducers","loading","isLoadingReducer","currentUserReducer","snackbarReducer","newPostReducer","store","createStore","rootReducer","window","__REDUX_DEVTOOLS_EXTENSION__","trace","app","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","db","getAnalytics","getFirestore","auth","getAuth","storage","getStorage","setUser","user","setSnackbar","setNewPost","Searchbar","dispatch","useDispatch","useSelector","useState","setIsLoading","usersCache","setUsersCache","options","setOptions","setOpen","inputValue","setInputValue","addToRecentSearches","uid","a","updateDoc","doc","timestamp","serverTimestamp","showRecentSearches","getDoc","then","Object","values","data","recentSearches","unformattedRecentSearches","sort","b","seconds","Promise","all","map","console","error","removeFromRecentSearches","e","stopPropagation","preventDefault","filter","option","deleteField","handleInputChange","newInput","target","value","users","length","getDocs","collection","docs","forEach","push","username","includes","slice","onOutsideClick","className","placeholder","onFocus","onChange","onClick","err","src","Loading","alt","to","profilePic","style","display","verified","title","realName","xmlns","fill","viewBox","d","Navbar","history","useHistory","location","useLocation","addPostButton","useRef","info","isDropdownOpen","setIsDropdownOpen","playDropdownClose","setPlayDropdownClose","phoneQuery","useMediaQuery","query","closeDropdown","setTimeout","logOut","signOut","id","Logo","nameLogo","current","click","accept","ref","input","postPhoto","files","pathname","fillRule","clipRule","LoadingPage","ErrorMsg","props","text","SignUpPage","emailRef","realNameRef","usernameRef","passwordRef","isInfoValid","setInfoValid","emailVerificationTime","setEmailVerificationTime","verificationInterval","setVerificationInterval","errorMsg","setErrorMsg","useEffect","document","clearInterval","checkForm","emailValue","trim","match","checkEmail","checkFormWithDB","_username","resolve","usersRef","q","where","querySnapshot","handleSubmit","email","toLowerCase","password","createUserWithEmailAndPassword","defaultProfilePic","bio","saved","userDocRef","setDoc","sendEmailVerification","runEmailVerification","errorCode","code","setInterval","reload","emailVerified","emailVerificationIcon","fontWeight","color","onSubmit","PasswordReset","setIsInfoValid","isEmailSent","setIsEmailSent","sendPasswordResetEmail","greenCheckmark","LoginPage","signInWithEmailAndPassword","sendEmail","AccountVerification","mode","setMode","actionCode","setActionCode","status","setStatus","confirmPasswordRef","passwordResetDone","setPasswordResetDone","passwordResetEmail","setPasswordResetEmail","handleVerifyEmail","applyActionCode","ok","checkPassword","checkConfirmPassword","handleFormSubmitPassword","newPassword","confirmPasswordReset","handlePasswordReset","verifyPasswordResetCode","getParameterByName","handleLink","name","replace","results","RegExp","exec","href","decodeURIComponent","redX","ChangePassword","oldPasswordRef","newPasswordRef","handleOnChange","oldPassword","confirmPassword","Error","credentials","EmailAuthProvider","credential","reauthenticateWithCredential","updatePassword","htmlFor","EditProfile","isPhotoLoading","setIsPhotoLoading","isPhotoChangerBoxOpen","setIsPhotoChangerBoxOpen","uploadRef","nameRef","bioRef","openPhotoBox","openPhotoUpload","closePhotoBox","removePhoto","updateUserLocally","uploadPhoto","uploadedPhoto","split","photoRef","uploadBytes","getDownloadURL","uploadedPhotoURL","handleChange","handleNameChange","handleUsernameChange","handleBioChange","handleEmailChange","updateEmail","defaultValue","AccountEdit","exact","activeClassName","path","component","FollowButton","isFollowing","setIsFollowing","following","checkIfFollowing","follow","alert","onbeforeunload","addToUsersFollowing","addToTargetsFollowers","unfollow","removeFromUsersFollowing","removeFromTargetsFollowers","userRefFollowing","runTransaction","t","get","sfDoc","exists","newFollowingArray","update","merge","targetRefFollowers","followers","newFollowersArray","VerifiedTick","size","marginLeft","marginRight","width","height","FollowWindow","uids","closeFollowListWindow","newMessage","list","setList","uidToNumbers","char","Number","isInteger","parseInt","Math","abs","charCodeAt","join","getRoomID","targetUid","currentUserUID","targetUserUID","handleStartChat","roomID","members","getUidsInfo","n","person","startLoading","stopLoading","Like","postPath","isComment","isLiked","setIsLiked","likes","checkIfLiked","like","arrayUnion","unlike","arrayRemove","Comment","commentData","noPhoto","noTimestamp","noLike","noLikesCounter","noRemove","setLikesWindow","isCaption","refreshComments","commenterInfo","setCommenterInfo","getCommenterInfo","commenterUid","removeComment","deleteDoc","setInfo","paddingRight","comment","format","fromUnixTime","formatDistanceToNowStrict","Save","isSaved","setIsSaved","checkIfSaved","save","unsave","PostWindow","postID","isVertical","addComment","userInfo","setUserInfo","setPostPath","postData","setPostData","comments","setComments","commentLoading","setCommentLoading","isDialogBoxOpen","setIsDialogBoxOpen","closeDialogBox","likesWindow","getUserData","userData","getPostComments","handleAddComment","nanoid","handleTextareaEnter","keyCode","shiftKey","deletePost","collectionGroup","postDoc","getData","navigator","clipboard","writeText","origin","photo","caption","fontSize","Date","getTime","getYear","onKeyDown","HomePage","postsRef","maxDate","setMaxDate","scroll","setScroll","olderPosts","setOlderPosts","postsToDisplay","setPostsToDisplay","handleScroll","winScroll","body","scrollTop","documentElement","scrollHeight","clientHeight","currentUserFollowing","maximumDate","posts","getPosts","getOlderPosts","addEventListener","removeEventListener","post","BrokenPage","PostCard","isHovered","setIsHovered","getPostData","commentsData","onMouseOver","onMouseLeave","position","inset","margin","UserProfile","useParams","userFollows","setUserFollows","userPosts","setUserPosts","isFollowingListWindowOpen","setIsFollowingListWindowOpen","isFollowersListWindowOpen","setIsFollowersListWindowOpen","getUserInfo","getUsersFollows","assign","getUsersPosts","fetchUserInfo","foo","createImage","url","reject","image","Image","setAttribute","getRadianAngle","degreeValue","PI","getCroppedImg","imageSrc","pixelCrop","rotation","canvas","createElement","ctx","getContext","maxSize","max","safeArea","sqrt","translate","rotate","drawImage","getImageData","putImageData","round","x","y","toBlob","NewPost","photoUrl","setPhotoUrl","crop","setCrop","zoom","setZoom","setRotation","croppedAreaPixels","setCroppedAreaPixels","reader","FileReader","readAsDataURL","onloadend","result","captionRef","getState","share","croppedPhoto","postPhotoRef","postUrl","zoomSpeed","onCropChange","onZoomChange","onRotationChange","onCropComplete","croppedArea","aspect","PostPage","postExists","setPostExists","morePosts","setMorePosts","isSmallScreen","setIsSmallScreen","handleResize","innerWidth","checkIfPostExists","getMorePosts","limit","Message","messageInfo","isSent","Room","messageRef","otherUser","setOtherUser","messages","setMessages","getOtherUserInfo","roomInfo","otherUserUid","member","getMessages","orderBy","messagesArray","sendMessage","lastMessage","lastUpdated","unsubscribe","onSnapshot","alignItems","i","Inbox","currentUserFollows","setCurrentUserFollows","recentChats","setRecentChats","isNewMessageBoxOpen","setIsNewMessageBoxOpen","closeNewMessageBox","formatDate","date","dateStringArray","getChats","chats","chat","flexDirection","justifyContent","gap","SendMessage","App","navbarVisibility","setNavbarVisibility","isLoggedIn","handleClose","onAuthStateChanged","paddingTop","Snackbar","autoHideDuration","onClose","anchorOrigin","vertical","horizontal","TransitionComponent","Slide","Alert","icon","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.31bbb29b.chunk.js","sourcesContent":["const isLoading = (state = true, action) =>\r\n{\r\n\tswitch (action.type)\r\n\t{\r\n\t\tcase \"START_LOADING\":\r\n\t\t\treturn state = true;\r\n\r\n\t\tcase \"STOP_LOADING\":\r\n\t\t\treturn state = false;\r\n\t\t\t\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n};\r\n\r\nexport default isLoading;\r\n","const currentUser = (state = null, action) =>\r\n{\r\n\tswitch (action.type)\r\n\t{\r\n\t\tcase \"SET_CURRENT_USER\":\r\n\t\t\treturn state = action.payload;\r\n\r\n\t\tcase \"SIGN_OUT\":\r\n\t\t\treturn state = null;\r\n\t\t\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n};\r\n\r\nexport default currentUser;\r\n","const defaultState =\r\n{\r\n\tmessage: \"Empty\", \r\n\tseverity: \"success\",\r\n\topen: false,\r\n};\r\n\r\nconst snackbar = (state = defaultState, action) =>\r\n{\r\n\tswitch (action.type)\r\n\t{\r\n\t\tcase \"SET_SNACKBAR\":\r\n\t\t\treturn state =\r\n\t\t\t{\r\n\t\t\t\tmessage: action.payload.message,\r\n\t\t\t\tseverity: action.payload.severity,\r\n\t\t\t\topen: true,\r\n\t\t\t};\r\n\r\n\t\tcase \"OPEN_SNACKBAR\":\r\n\t\t\treturn state = {...state, open: true};\r\n\r\n\t\tcase \"CLOSE_SNACKBAR\":\r\n\t\t\treturn state = {...state, open: false};\r\n\t\t\t\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n};\r\n\r\nexport default snackbar;\r\n","const newPost = (state = null, action) =>\r\n{\r\n\tswitch (action.type)\r\n\t{\r\n\t\tcase \"SET_NEW_POST\":\r\n\t\t\treturn state = action.payload.file;\r\n\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n};\r\n\r\nexport default newPost;\r\n","import { combineReducers } from \"redux\";\r\nimport isLoadingReducer from \"./isLoading\";\r\nimport currentUserReducer from \"./currentUser\";\r\nimport snackbarReducer from \"./snackbar\";\r\nimport newPostReducer from \"./newPost\";\r\n\r\nconst root = combineReducers(\r\n\t{\r\n\t\tloading: isLoadingReducer,\r\n\t\tcurrentUser: currentUserReducer,\r\n\t\tsnackbar: snackbarReducer,\r\n\t\tnewPost: newPostReducer,\r\n\t}\r\n);\r\n\r\nexport default root;\r\n","import { createStore } from \"redux\";\r\nimport rootReducer from \"./reducers\";\r\n\r\nconst store = createStore(rootReducer, window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__({ trace: true }));\r\n\r\nexport default store;\r\n","import { initializeApp } from \"firebase/app\";\r\nimport { getAnalytics } from \"firebase/analytics\";\r\nimport { getFirestore } from \"firebase/firestore\";\r\nimport { getAuth } from \"firebase/auth\";\r\nimport { getStorage } from \"firebase/storage\";\r\n\r\nconst firebaseConfig =\r\n{\r\n\tapiKey: \"AIzaSyAKrGd-3EdtXZUrsR9H3MOL-mTUS2XjDt8\",\r\n\tauthDomain: \"instadicey.firebaseapp.com\",\r\n\tprojectId: \"instadicey\",\r\n\tstorageBucket: \"instadicey.appspot.com\",\r\n\tmessagingSenderId: \"534824914170\",\r\n\tappId: \"1:534824914170:web:563f979c0b305ebbc54d43\",\r\n\tmeasurementId: \"G-VJDYJCZNQJ\",\r\n};\r\n\r\nexport const app = initializeApp(firebaseConfig);\r\nexport const analytics = getAnalytics(app);\r\nexport const db = getFirestore(app);\r\nexport const auth = getAuth(app);\r\nexport const storage = getStorage(app);\r\n","export const setUser = user =>\r\n{\r\n\treturn {\r\n\t\ttype: \"SET_CURRENT_USER\",\r\n\t\tpayload: user,\r\n\t};\r\n};\r\n\r\nexport const signOut = () =>\r\n{\r\n\treturn {\r\n\t\ttype: \"SIGN_OUT\",\r\n\t};\r\n};\r\n","export const setSnackbar = (message, severity) =>\r\n{\r\n\treturn {\r\n\t\ttype: \"SET_SNACKBAR\",\r\n\t\tpayload:\r\n\t\t{\r\n\t\t\tmessage,\r\n\t\t\tseverity,\r\n\t\t}\r\n\t};\r\n};\r\n\r\nexport const closeSnackbar = () =>\r\n{\r\n\treturn {\r\n\t\ttype: \"CLOSE_SNACKBAR\",\r\n\t};\r\n};\r\n","export const setNewPost = file =>\r\n{\r\n\treturn {\r\n\t\ttype: \"SET_NEW_POST\",\r\n\t\tpayload:\r\n\t\t{\r\n\t\t\tfile,\r\n\t\t}\r\n\t};\r\n};\r\n","export default __webpack_public_path__ + \"static/media/namelogo.37ef1c08.png\";","export default __webpack_public_path__ + \"static/media/logo.d4e48eb0.png\";","export default __webpack_public_path__ + \"static/media/loading.42aaa181.jpg\";","import { useRef, useState } from \"react\";\r\nimport { Link, useHistory, useLocation } from \"react-router-dom\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { auth, db } from \"../firebase\";\r\nimport { signOut } from \"@firebase/auth\";\r\nimport { collection, deleteField, doc, getDoc, getDocs, serverTimestamp,  updateDoc } from \"@firebase/firestore\";\r\nimport OutsideClickHandler from \"react-outside-click-handler\";\r\nimport { useMediaQuery } from \"react-responsive\";\r\nimport { startLoading, stopLoading } from \"../state/actions/isLoading\";\r\nimport { setSnackbar } from \"../state/actions/snackbar\";\r\nimport { setNewPost } from \"../state/actions/newPost\";\r\nimport nameLogo from \"../assets/namelogo.png\";\r\nimport Logo from \"../assets/logo.png\";\r\nimport Loading from \"../assets/misc/loading.jpg\";\r\n\r\nconst Navbar = () =>\r\n{\r\n\tconst history = useHistory();\r\n\tconst location = useLocation();\r\n\tconst dispatch = useDispatch();\r\n\tconst addPostButton = useRef();\r\n\tconst { username, profilePic } = useSelector(state => state.currentUser.info) || \"\";\r\n\tconst [isDropdownOpen, setIsDropdownOpen] = useState(false);\r\n\tconst [playDropdownClose, setPlayDropdownClose] = useState(false);\r\n\tconst phoneQuery = useMediaQuery({query: \"(max-width: 600px)\"});\r\n\r\n\tconst handleNewPostChange = input =>\r\n\t{\r\n\t\tconst postPhoto = input.target.files[0];\r\n\t\taddPostButton.current.value = null;\r\n\t\tdispatch(setNewPost(postPhoto));\r\n\t\thistory.push(\"/create/style\");\r\n\t};\r\n\r\n\tconst openDropdown = () => setIsDropdownOpen(true);\r\n\tconst closeDropdown = e =>\r\n\t{\r\n\t\te.stopPropagation();\r\n\t\tsetPlayDropdownClose(true);\r\n\t\tsetTimeout(() => { setIsDropdownOpen(false); setPlayDropdownClose(false); }, 125);\r\n\t};\r\n\t\r\n\tconst logOut = async () =>\r\n\t{\r\n\t\tdispatch(startLoading());\r\n\t\tawait signOut(auth);\r\n\t\thistory.push(\"/\");\r\n\t\tdispatch(stopLoading());\r\n\t};\r\n\r\n\treturn(\r\n\t\t<nav id=\"main-navbar\">\r\n\t\t\t<div className=\"logo\"><Link to=\"/\"><img src={phoneQuery ? Logo : nameLogo} alt=\"Instadicey\"></img></Link></div>\r\n\t\t\t<li><Searchbar/></li>\r\n\t\t\t<ul>\r\n\t\t\t\t<li><button className=\"add-post icon\" onClick={() => addPostButton.current.click()}><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M13 2v9h9v2h-9v9h-2v-9h-9v-2h9v-9h2zm2-2h-6v9h-9v6h9v9h6v-9h9v-6h-9v-9z\"/></svg></button></li>\r\n\t\t\t\t<input accept=\"image/png, image/jpg, image/jpeg, image/pjpeg, image/jfif, image/pjp\" type=\"file\" ref={addPostButton} onChange={handleNewPostChange}></input>\r\n\t\t\t\t<li><Link to=\"/\" className=\"icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">{location.pathname === \"/\" ? <path d=\"M21 13v10h-6v-6h-6v6h-6v-10h-3l12-12 12 12h-3zm-1-5.907v-5.093h-3v2.093l3 3z\"/> : <path d=\"M20 7.093v-5.093h-3v2.093l3 3zm4 5.907l-12-12-12 12h3v10h7v-5h4v5h7v-10h3zm-5 8h-3v-5h-8v5h-3v-10.26l7-6.912 7 6.99v10.182z\"/>}</svg></Link></li>\r\n\t\t\t\t<li><Link to=\"/direct/inbox\" className=\"icon\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\">{location.pathname.includes(\"/direct/\") ? <path d=\"M12 12.713l-11.985-9.713h23.97l-11.985 9.713zm0 2.574l-12-9.725v15.438h24v-15.438l-12 9.725z\"/> : <path d=\"M0 3v18h24v-18h-24zm21.518 2l-9.518 7.713-9.518-7.713h19.036zm-19.518 14v-11.817l10 8.104 10-8.104v11.817h-20z\"/>}</svg></Link></li>\r\n\t\t\t\t<li className=\"profile\" onClick={openDropdown}>\r\n\t\t\t\t\t<div className=\"icon\"><img src={profilePic} alt=\"Profile Pic\"></img></div>\r\n\t\t\t\t\t{ isDropdownOpen &&\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<div className=\"dropdown-container\" onClick={closeDropdown}></div>\r\n\t\t\t\t\t\t\t<div className={`dropdown outlined ${playDropdownClose ? \"closed\" : \"\"}`}>\r\n\t\t\t\t\t\t\t\t<span className=\"arrow\"></span>\r\n\t\t\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t<Link to={`/${username}`} onClick={closeDropdown}>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg className=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M12 0c6.623 0 12 5.377 12 12s-5.377 12-12 12-12-5.377-12-12 5.377-12 12-12zm8.127 19.41c-.282-.401-.772-.654-1.624-.85-3.848-.906-4.097-1.501-4.352-2.059-.259-.565-.19-1.23.205-1.977 1.726-3.257 2.09-6.024 1.027-7.79-.674-1.119-1.875-1.734-3.383-1.734-1.521 0-2.732.626-3.409 1.763-1.066 1.789-.693 4.544 1.049 7.757.402.742.476 1.406.22 1.974-.265.586-.611 1.19-4.365 2.066-.852.196-1.342.449-1.623.848 2.012 2.207 4.91 3.592 8.128 3.592s6.115-1.385 8.127-3.59zm.65-.782c1.395-1.844 2.223-4.14 2.223-6.628 0-6.071-4.929-11-11-11s-11 4.929-11 11c0 2.487.827 4.783 2.222 6.626.409-.452 1.049-.81 2.049-1.041 2.025-.462 3.376-.836 3.678-1.502.122-.272.061-.628-.188-1.087-1.917-3.535-2.282-6.641-1.03-8.745.853-1.431 2.408-2.251 4.269-2.251 1.845 0 3.391.808 4.24 2.218 1.251 2.079.896 5.195-1 8.774-.245.463-.304.821-.179 1.094.305.668 1.644 1.038 3.667 1.499 1 .23 1.64.59 2.049 1.043z\"/></svg>\r\n\t\t\t\t\t\t\t\t\t\t\tProfile\r\n\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t<Link to={`/${username}/saved`} onClick={closeDropdown}>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg className=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M5 0v24l7-6 7 6v-24h-14zm1 1h12v20.827l-6-5.144-6 5.144v-20.827z\"/></svg>\r\n\t\t\t\t\t\t\t\t\t\t\tSaved\r\n\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t<li>\r\n\t\t\t\t\t\t\t\t\t\t<Link to=\"/accounts/edit\" onClick={closeDropdown}>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg className=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M12 8.666c-1.838 0-3.333 1.496-3.333 3.334s1.495 3.333 3.333 3.333 3.333-1.495 3.333-3.333-1.495-3.334-3.333-3.334m0 7.667c-2.39 0-4.333-1.943-4.333-4.333s1.943-4.334 4.333-4.334 4.333 1.944 4.333 4.334c0 2.39-1.943 4.333-4.333 4.333m-1.193 6.667h2.386c.379-1.104.668-2.451 2.107-3.05 1.496-.617 2.666.196 3.635.672l1.686-1.688c-.508-1.047-1.266-2.199-.669-3.641.567-1.369 1.739-1.663 3.048-2.099v-2.388c-1.235-.421-2.471-.708-3.047-2.098-.572-1.38.057-2.395.669-3.643l-1.687-1.686c-1.117.547-2.221 1.257-3.642.668-1.374-.571-1.656-1.734-2.1-3.047h-2.386c-.424 1.231-.704 2.468-2.099 3.046-.365.153-.718.226-1.077.226-.843 0-1.539-.392-2.566-.893l-1.687 1.686c.574 1.175 1.251 2.237.669 3.643-.571 1.375-1.734 1.654-3.047 2.098v2.388c1.226.418 2.468.705 3.047 2.098.581 1.403-.075 2.432-.669 3.643l1.687 1.687c1.45-.725 2.355-1.204 3.642-.669 1.378.572 1.655 1.738 2.1 3.047m3.094 1h-3.803c-.681-1.918-.785-2.713-1.773-3.123-1.005-.419-1.731.132-3.466.952l-2.689-2.689c.873-1.837 1.367-2.465.953-3.465-.412-.991-1.192-1.087-3.123-1.773v-3.804c1.906-.678 2.712-.782 3.123-1.773.411-.991-.071-1.613-.953-3.466l2.689-2.688c1.741.828 2.466 1.365 3.465.953.992-.412 1.082-1.185 1.775-3.124h3.802c.682 1.918.788 2.714 1.774 3.123 1.001.416 1.709-.119 3.467-.952l2.687 2.688c-.878 1.847-1.361 2.477-.952 3.465.411.992 1.192 1.087 3.123 1.774v3.805c-1.906.677-2.713.782-3.124 1.773-.403.975.044 1.561.954 3.464l-2.688 2.689c-1.728-.82-2.467-1.37-3.456-.955-.988.41-1.08 1.146-1.785 3.126\"/></svg>\r\n\t\t\t\t\t\t\t\t\t\t\tSettings\r\n\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t<li className=\"log-out\" onClick={() => { logOut(); }}>\r\n\t\t\t\t\t\t\t\t\t\tLog Out\r\n\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t}\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t</nav>\r\n\t);\r\n};\r\n\r\nconst Searchbar = () =>\r\n{\r\n\tconst dispatch = useDispatch();\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\tconst [usersCache, setUsersCache] = useState(null);\r\n\tconst [options, setOptions] = useState([]);\r\n\tconst [open, setOpen] = useState(false);\r\n\tconst [inputValue, setInputValue] = useState(\"\");\r\n\r\n\tconst addToRecentSearches = async uid =>\r\n\t{\r\n\t\tawait updateDoc(doc(db, \"users\", currentUser.user.uid),\r\n\t\t\t{\r\n\t\t\t\t[\"recentSearches.\" + uid]: {uid, timestamp: serverTimestamp()},\r\n\t\t\t});\r\n\t};\r\n\r\n\tconst showRecentSearches = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tsetIsLoading(true);\r\n\t\t\tconst unformattedRecentSearches = await getDoc(doc(db, \"users\", currentUser.user.uid)).then(doc => Object.values(doc.data().recentSearches));\r\n\t\t\tunformattedRecentSearches.sort((a, b) => a.timestamp.seconds < b.timestamp.seconds ? 1 : -1);\r\n\t\t\tconst recentSearches = await Promise.all(unformattedRecentSearches.map(async user => await getDoc(doc(db, \"users\", user.uid)).then(doc => doc.data())));\r\n\t\t\tsetOptions(recentSearches);\r\n\t\t\tsetIsLoading(false);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tdispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\t\r\n\tconst removeFromRecentSearches = async (e, uid) =>\r\n\t{\r\n\t\te.stopPropagation();\r\n\t\te.preventDefault();\r\n\t\t\r\n\t\ttry\r\n\t\t{\r\n\t\t\tsetOptions(options.filter(option => option.uid !== uid));\r\n\t\t\tawait updateDoc(doc(db, \"users\", currentUser.user.uid),\r\n\t\t\t\t{\r\n\t\t\t\t\t[\"recentSearches.\" + uid]: deleteField(),\r\n\t\t\t\t});\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t}\r\n\t};\r\n\t\r\n\tconst clearRecentSearches = () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tsetOptions([]);\r\n\t\t\tupdateDoc(doc(db, \"users\", currentUser.user.uid), {recentSearches: []});\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tdispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\t\r\n\tconst handleInputChange = async (e) =>\r\n\t{\r\n\t\tconst newInput = e.target.value;\r\n\t\tsetInputValue(newInput);\r\n\t\tif (newInput === \"\") return showRecentSearches();\r\n\t\t\r\n\t\tsetIsLoading(true);\r\n\t\tlet users = usersCache || [];\r\n\t\tif (users.length === 0)\r\n\t\t{\r\n\t\t\ttry\r\n\t\t\t{\r\n\t\t\t\tconst querySnapshot = await getDocs(collection(db, \"users\"));\r\n\t\t\t\tquerySnapshot.docs.forEach(doc => users.push(doc.data()));\r\n\t\t\t\tsetUsersCache(users);\r\n\t\t\t} catch (err)\r\n\t\t\t{\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\tdispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t\t}\r\n\t\t}\r\n\t\tusers = users.filter(user => user.username.includes(newInput)).slice(0, 15);\r\n\t\tsetOptions(users);\r\n\t\tsetIsLoading(false);\r\n\t};\r\n\r\n\tconst handleOnOpen = () =>\r\n\t{\r\n\t\tsetOpen(true);\r\n\t\tif (inputValue !== \"\") return;\r\n\t\tshowRecentSearches();\r\n\t};\r\n\tconst handleOnClose = () => setOpen(false);\r\n\r\n\tconst handleElementClick = uid =>\r\n\t{\r\n\t\tsetOpen(false);\r\n\t\tsetInputValue(\"\");\r\n\t\taddToRecentSearches(uid);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<OutsideClickHandler onOutsideClick={handleOnClose}>\r\n\t\t\t<div className=\"searchbar-container\">\r\n\t\t\t\t<input \r\n\t\t\t\t\tclassName=\"search\"\r\n\t\t\t\t\tplaceholder=\"Search\"\r\n\t\t\t\t\tonFocus={handleOnOpen}\r\n\t\t\t\t\tonChange={handleInputChange}\r\n\t\t\t\t\tvalue={inputValue}\r\n\t\t\t\t/>\r\n\t\t\t\t{\r\n\t\t\t\t\topen\r\n\t\t\t\t\t\t?\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<span className=\"arrow\"></span>\r\n\t\t\t\t\t\t\t<ul className=\"search-list outlined\">\r\n\t\t\t\t\t\t\t\t{inputValue === \"\" && !isLoading ? <div className=\"recent\">Recent<button className=\"text\" onClick={clearRecentSearches}>Clear All</button></div> : null}\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tisLoading\r\n\t\t\t\t\t\t\t\t\t\t? <div className=\"loading\"><img src={Loading} alt=\"loading...\"></img></div>\r\n\t\t\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\t\t\toptions.map(option =>\r\n\t\t\t\t\t\t\t\t\t\t\t(\r\n\t\t\t\t\t\t\t\t\t\t\t\t<li key={option.username}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Link to={`/${option.username}`} onClick={() => handleElementClick(option.uid)}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"img-container outlined round\"><img src={option.profilePic} alt={`${option.username}'s Profile Pic'`}></img></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div style={{display: \"flex\"}}><span className=\"username\">{option.username}</span> {option.verified ? <div className=\"verified\" title=\"Verified\"></div> : null}</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"real-name\">{option.realName}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"remove\" onClick={e => removeFromRecentSearches(e, option.uid)}><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" className=\"bi bi-x-lg\" viewBox=\"0 0 16 16\"><path d=\"M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z\"/></svg></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t))\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t: null\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t</OutsideClickHandler>\r\n\t);\r\n};\r\n\r\nexport default Navbar;\r\n","export const startLoading = () =>\r\n{\r\n\treturn {\r\n\t\ttype: \"START_LOADING\",\r\n\t};\r\n};\r\n\r\nexport const stopLoading = () =>\r\n{\r\n\treturn {\r\n\t\ttype: \"STOP_LOADING\",\r\n\t};\r\n};\r\n","import Logo from \"../assets/logo.png\";\r\n\r\nconst LoadingPage = () =>\r\n{\r\n\treturn(\r\n\t\t<div className=\"loading-page\">\r\n\t\t\t<div className=\"loading\"><img src={Logo} alt=\"Logo\"></img></div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default LoadingPage;\r\n","const ErrorMsg = props => <div className=\"error-msg\">{props.text}</div>;\r\nexport default ErrorMsg;\r\n","export default __webpack_public_path__ + \"static/media/email-verification.ef786c0a.png\";","import { useEffect, useRef, useState } from \"react\";\r\nimport { Link, useHistory } from \"react-router-dom\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { auth, db } from \"../../firebase\";\r\nimport { createUserWithEmailAndPassword, sendEmailVerification, signOut } from \"firebase/auth\";\r\nimport { collection, doc, getDocs, setDoc, query, where, serverTimestamp } from \"@firebase/firestore\";\r\nimport { startLoading, stopLoading } from \"../../state/actions/isLoading\";\r\nimport { setUser } from \"../../state/actions/currentUser\";\r\nimport ErrorMsg from \"./ErrorMsg\";\r\nimport nameLogo from \"../../assets/namelogo.png\";\r\nimport emailVerificationIcon from \"../../assets/misc/email-verification.png\";\r\n\r\nconst SignUpPage = () =>\r\n{\r\n\tconst emailRef = useRef();\r\n\tconst realNameRef = useRef();\r\n\tconst usernameRef = useRef();\r\n\tconst passwordRef = useRef();\r\n\r\n\tconst history = useHistory();\r\n\tconst dispatch = useDispatch();\r\n\r\n\tconst [isInfoValid, setInfoValid] = useState(false);\r\n\tconst [emailVerificationTime, setEmailVerificationTime] = useState(false);\r\n\tconst [verificationInterval, setVerificationInterval] = useState();\r\n\tconst [errorMsg, setErrorMsg] = useState(null);\r\n\r\n\tuseEffect(() => document.title = \"Sign Up  Instadicey\", []);\r\n\tuseEffect(() => () => clearInterval(verificationInterval));\r\n\r\n\tconst checkEmail = () =>\r\n\t{\r\n\t\tconst emailValue = emailRef.current.value.trim();\r\n\t\tif (emailValue === \"\") return false;\r\n\t\t// eslint-disable-next-line no-control-regex\r\n\t\telse if (!emailValue.match(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])/))\r\n\t\t\treturn false;\r\n\t\telse return true;\r\n\t};\r\n\r\n\tconst checkPassword = () => passwordRef.current.value.length < 6 ? false : true;\r\n\r\n\tconst checkUsername = () => usernameRef.current.value.length > 20 || usernameRef.current.value.length === 0 || !usernameRef.current.value.match(/^[A-Za-z0-9]*$/) ? false : true;\r\n\r\n\tconst checkForm = () =>\r\n\t{\r\n\t\tif (checkEmail() && checkPassword() && checkUsername()) setInfoValid(true);\r\n\t\telse setInfoValid(false);\r\n\t};\r\n\r\n\tconst checkFormWithDB = (_username) =>\r\n\t{\r\n\t\treturn new Promise(async resolve =>\r\n\t\t{\r\n\t\t\tconst usersRef = collection(db, \"users\");\r\n\t\t\tconst q = query(usersRef, where(\"username\", \"==\", _username));\r\n\t\t\tconst querySnapshot = await getDocs(q);\r\n\t\t\tconsole.error(querySnapshot.docs.length);\r\n\t\t\tif (querySnapshot.docs.length !== 0)\r\n\t\t\t{\r\n\t\t\t\tsetErrorMsg(\"Username already taken\");\r\n\t\t\t\tresolve(false);\r\n\t\t\t} else resolve(true);\r\n\t\t});\r\n\t};\r\n\r\n\tconst handleSubmit = async  e =>\r\n\t{\r\n\t\te.preventDefault();\r\n\t\tif (!isInfoValid) return;\r\n\t\t\r\n\t\tconst email = emailRef.current.value.toLowerCase();\r\n\t\tconst realName = realNameRef.current.value;\r\n\t\tconst username = usernameRef.current.value.toLowerCase();\r\n\t\tconst password = passwordRef.current.value;\r\n\t\t\r\n\t\ttry\r\n\t\t{\r\n\t\t\tdispatch(startLoading());\r\n\r\n\t\t\tconst checkWithDB = await checkFormWithDB(username);\r\n\t\t\tif (!checkWithDB) return dispatch(stopLoading());\r\n\r\n\t\t\tconst { user } = await createUserWithEmailAndPassword(auth, email, password);\r\n\t\t\tconst info =\r\n\t\t\t{\r\n\t\t\t\trealName,\r\n\t\t\t\tusername,\r\n\t\t\t\tprofilePic: \"https://firebasestorage.googleapis.com/v0/b/instadicey.appspot.com/o/default%2FprofilePic.jpg?alt=media&token=3ac835a3-016e-470a-b7b3-f898d82cdbde\",\r\n\t\t\t\tdefaultProfilePic: true,\r\n\t\t\t\tbio: \"\",\r\n\t\t\t\tsaved: [],\r\n\t\t\t\trecentSearches: {},\r\n\t\t\t\tuid: auth.currentUser.uid,\r\n\t\t\t\ttimestamp: serverTimestamp(),\r\n\t\t\t};\r\n\t\t\tconst userDocRef = doc(db, \"users\", auth.currentUser.uid);\r\n\t\t\tawait setDoc(userDocRef, info);\r\n\t\t\tsetErrorMsg(null);\r\n\t\t\t\r\n\t\t\tawait sendEmailVerification(user);\r\n\t\t\tsetEmailVerificationTime(true);\r\n\t\t\trunEmailVerification(info);\r\n\r\n\t\t\tdispatch(stopLoading());\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconst errorCode = err.code;\r\n\t\t\tconsole.error(\"Error with signup\", err);\r\n\t\t\tif (errorCode === \"auth/email-already-in-use\")\r\n\t\t\t\tsetErrorMsg(\"Email already in use\");\r\n\t\t\tdispatch(stopLoading());\r\n\t\t}\r\n\t};\r\n\r\n\t// Runs after checking user info on sign up\r\n\tconst runEmailVerification = (info) =>\r\n\t{\r\n\t\tsetVerificationInterval(setInterval(async () =>\r\n\t\t{\r\n\t\t\tawait auth.currentUser.reload();\r\n\t\t\tif (auth.currentUser.emailVerified)\r\n\t\t\t{\r\n\t\t\t\tdispatch(setUser({user: auth.currentUser, info}));\r\n\t\t\t\thistory.push(\"\");\r\n\t\t\t};\r\n\t\t}, 5000));\r\n\t};\r\n\tuseEffect(() => signOut(auth), []);\r\n\r\n\tif (!emailVerificationTime)\r\n\t\treturn(\r\n\t\t\t<div id=\"signup-page\">\r\n\t\t\t\t<div id=\"signup-window\" className=\"outlined\">\r\n\t\t\t\t\t<div className=\"logo\"><img src={nameLogo} alt=\"Instadicey logo\"></img></div>\r\n\t\t\t\t\t{ \r\n\t\t\t\t\t\terrorMsg \r\n\t\t\t\t\t\t\t? <ErrorMsg text={errorMsg}/>\r\n\t\t\t\t\t\t\t: <span style={{fontWeight: \"bold\", color: \"rgba(50, 50, 50, 0.5)\"}}>Sign up now!</span> \r\n\t\t\t\t\t}\r\n\t\t\t\t\t<form className=\"info\" onSubmit={handleSubmit}>\r\n\t\t\t\t\t\t<input type=\"text\" placeholder=\"Email\" id=\"email\" ref={emailRef} onChange={checkForm}></input>\r\n\t\t\t\t\t\t<input type=\"text\" placeholder=\"Full Name\" id=\"name\" ref={realNameRef}></input>\r\n\t\t\t\t\t\t<input type=\"text\" placeholder=\"Username\" id=\"username\" ref={usernameRef} onChange={checkForm}></input>\r\n\t\t\t\t\t\t<input type=\"password\" placeholder=\"Password\" id=\"password\" ref={passwordRef} onChange={checkForm}></input>\r\n\t\t\t\t\t\t<button id=\"signup\" className={`${isInfoValid ? null : \"disabled\"}`}>Sign Up</button>\r\n\t\t\t\t\t</form>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"extra outlined\"><span>Have an account? <Link to=\"/\" className=\"button\">Log In</Link></span></div>\r\n\t\t\t</div>\r\n\t\t);\r\n\telse\r\n\t\treturn(\r\n\t\t\t<div id=\"email-verification-window\" className=\"outlined\">\r\n\t\t\t\t<div className=\"icon\"><img src={emailVerificationIcon} alt=\"email verification icon\"></img></div>\r\n\t\t\t\t<p className=\"header\">A verification link has been sent to your email</p>\r\n\t\t\t\t<p>Please click on the link sent to your email address and come back here to continue.</p>\r\n\t\t\t</div>\r\n\t\t);\r\n};\r\n\r\nexport default SignUpPage;\r\n","export default __webpack_public_path__ + \"static/media/green-checkmark.6fb350c8.png\";","import { useEffect, useRef, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { auth } from \"../../firebase\";\r\nimport { sendPasswordResetEmail } from \"@firebase/auth\";\r\nimport ErrorMsg from \"./ErrorMsg\";\r\nimport Lock from \"../../assets/misc/lock.png\";\r\nimport greenCheckmark from \"../../assets/misc/green-checkmark.png\";\r\n\r\nconst PasswordReset = () =>\r\n{\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst emailRef = useRef();\r\n\tconst [isInfoValid, setIsInfoValid] = useState(false);\r\n\tconst [isEmailSent, setIsEmailSent] = useState(false);\r\n\tconst [errorMsg, setErrorMsg] = useState(null);\r\n\r\n\tuseEffect(() => document.title = \"Reset Password  Instadicey\", []);\r\n\r\n\tconst checkEmail = () =>\r\n\t{\r\n\t\tconst emailValue = emailRef.current.value;\r\n\t\tif (emailValue === \"\") return setIsInfoValid(false);\r\n\t\t// eslint-disable-next-line no-control-regex\r\n\t\telse if (!emailValue.match(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])/))\r\n\t\t\treturn setIsInfoValid(false);\r\n\t\telse return setIsInfoValid(true);\r\n\t};\r\n\r\n\tconst handleSubmit = async e =>\r\n\t{\r\n\t\te.preventDefault();\r\n\t\tif (!isInfoValid) return;\r\n\r\n\t\tconst email = emailRef.current.value;\r\n\t\ttry\r\n\t\t{\r\n\t\t\tsetErrorMsg(null);\r\n\t\t\tawait sendPasswordResetEmail(auth, email);\r\n\t\t\tsetIsEmailSent(true);\r\n\t\t}\r\n\t\tcatch (err)\r\n\t\t{\r\n\t\t\tif (err.code === \"auth/user-not-found\")\r\n\t\t\t\tsetErrorMsg(\"User not found\");\r\n\t\t\tconsole.error(\"Error with password reset\", err);\r\n\t\t}\r\n\t};\r\n\r\n\tif (isEmailSent)\r\n\t{\r\n\t\treturn(\r\n\t\t\t<div className=\"password-reset-window success outlined\">\r\n\t\t\t\t<div className=\"icon\"><img src={greenCheckmark} alt=\"Success\"></img></div>\r\n\t\t\t\t<h1>Email sent</h1>\r\n\t\t\t\t<p>Check your inbox and spam and follow the instructions</p>\r\n\t\t\t\t<div className=\"extra\">\r\n\t\t\t\t\t<Link to=\"/\">Back To Login</Link>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t} else\r\n\t{\r\n\t\treturn(\r\n\t\t\t<div className=\"password-reset-window outlined\">\r\n\t\t\t\t<div className=\"icon\"><img src={Lock} alt=\"locked out\"></img></div>\r\n\t\t\t\t<h1>Can't Log In?</h1>\r\n\t\t\t\t<p>It's all good, mate. just enter your email and we'll send you an email to reset your password right away!</p>\r\n\t\t\t\t{ errorMsg ? <ErrorMsg text={errorMsg}/> : null }\r\n\t\t\t\t<form onSubmit={handleSubmit}>\r\n\t\t\t\t\t<input type=\"text\" id=\"email\" placeholder=\"Email\" ref={emailRef} onChange={checkEmail}></input>\r\n\t\t\t\t\t<button id=\"reset\" className={`${isInfoValid ? null : \"disabled\"}`}>Send Email</button>\r\n\t\t\t\t</form>\r\n\t\t\t\t{ !currentUser &&\r\n\t\t\t\t\t<div className=\"extra outlined\">\r\n\t\t\t\t\t\t<Link to=\"/\">Back To Login</Link>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n};\r\n\r\nexport default PasswordReset;\r\n","export default \"data:image/png;base64,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\"","import { useState, useRef, useEffect } from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { auth, db } from \"../../firebase\";\r\nimport { sendEmailVerification, signInWithEmailAndPassword, signOut } from \"firebase/auth\";\r\nimport { doc, getDoc } from \"@firebase/firestore\";\r\nimport { startLoading, stopLoading } from \"../../state/actions/isLoading\";\r\nimport { setUser } from \"../../state/actions/currentUser\";\r\nimport ErrorMsg from \"./ErrorMsg\";\r\nimport nameLogo from \"../../assets/namelogo.png\";\r\nimport \"./auth.css\";\r\n\r\nconst LoginPage = () =>\r\n{\r\n\tconst emailRef = useRef();\r\n\tconst passwordRef = useRef();\r\n\tconst dispatch = useDispatch();\r\n\r\n\tconst [isInfoValid, setInfoValid] = useState(false);\r\n\tconst [errorMsg, setErrorMsg] = useState(null);\r\n\r\n\tuseEffect(() => document.title = \"Login  Instadicey\", []);\r\n\r\n\tconst checkEmail = () =>\r\n\t{\r\n\t\tconst emailValue = emailRef.current.value;\r\n\t\tif (emailValue === \"\") return false;\r\n\t\t// eslint-disable-next-line no-control-regex\r\n\t\telse if (!emailValue.match(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])/))\r\n\t\t\treturn false;\r\n\t\telse return true;\r\n\t};\r\n\r\n\tconst checkPassword = () =>\r\n\t{\r\n\t\tconst passwordValue = passwordRef.current.value;\r\n\t\treturn passwordValue.length < 6 ? false : true;\r\n\t};\r\n\r\n\tconst checkForm = () =>\r\n\t{\r\n\t\tif (checkEmail() && checkPassword()) setInfoValid(true);\r\n\t\telse setInfoValid(false);\r\n\t};\r\n\r\n\tconst handleSubmit = async  e =>\r\n\t{\r\n\t\te.preventDefault();\r\n\t\tif (!isInfoValid) return;\r\n\r\n\t\tconst email = emailRef.current.value;\r\n\t\tconst password = passwordRef.current.value;\r\n\r\n\t\ttry\r\n\t\t{\r\n\t\t\tdispatch(startLoading());\r\n\t\t\tconst user = await signInWithEmailAndPassword(auth, email, password).then(data => data.user);\r\n\t\t\tif (!user.emailVerified)\r\n\t\t\t{\r\n\t\t\t\tsignOut(auth);\r\n\t\t\t\tconst sendEmail = async () =>\r\n\t\t\t\t{\r\n\t\t\t\t\tawait sendEmailVerification(user);\r\n\t\t\t\t\tsetErrorMsg(\"Email sent\");\r\n\t\t\t\t};\r\n\t\t\t\tsetErrorMsg(<div>Email not verified<br/><span className=\"link\" onClick={sendEmail}>click here</span> to send verification email</div>);\r\n\t\t\t\treturn dispatch(stopLoading());\r\n\t\t\t}\r\n\t\t\tconst info = await getDoc(doc(db, \"users\", user.uid)).then(doc => doc.data());\r\n\t\t\tdispatch(setUser({user, info}));\r\n\t\t\tdispatch(stopLoading());\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconst errorCode = err.code;\r\n\t\t\tconsole.error(\"Error with login\", err);\r\n\t\t\tif (errorCode === \"auth/wrong-password\" || errorCode === \"auth/user-not-found\")\r\n\t\t\t\tsetErrorMsg(\"Wrong email or password\");\r\n\t\t\telse if (errorCode === \"auth/too-many-requests\")\r\n\t\t\t\tsetErrorMsg(\"Please try again later\");\r\n\t\t\tdispatch(stopLoading());\r\n\t\t}\r\n\t};\r\n\r\n\treturn(\r\n\t\t<div id=\"login-page\">\r\n\t\t\t<div id=\"login-window\" className=\"outlined\">\r\n\t\t\t\t<div className=\"logo\"><img src={nameLogo} alt=\"Instadicey logo\"></img></div>\r\n\t\t\t\t{ errorMsg ? <ErrorMsg text={errorMsg}/> : null }\r\n\t\t\t\t<form className=\"info\" onSubmit={handleSubmit}>\r\n\t\t\t\t\t<input type=\"text\" placeholder=\"Email\" id=\"email\" ref={emailRef} onChange={checkForm}></input>\r\n\t\t\t\t\t<input type=\"password\" placeholder=\"Password\" id=\"password\" ref={passwordRef} onChange={checkForm}></input>\r\n\t\t\t\t\t<button id=\"login\" className={`${isInfoValid ? null : \"disabled\"}`}>Log In</button>\r\n\t\t\t\t</form>\r\n\t\t\t\t<Link to=\"/accounts/password-reset\">Forgot password?</Link>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"extra outlined\"><span>Don't have an account? <Link to=\"/accounts/email-signup\" className=\"button\">Sign Up</Link></span></div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default LoginPage;\r\n","export default __webpack_public_path__ + \"static/media/red-x.1684dcf4.png\";","/* eslint-disable react-hooks/exhaustive-deps */\r\nimport { useEffect, useRef, useState } from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { auth } from \"../../firebase\";\r\nimport { applyActionCode, confirmPasswordReset, verifyPasswordResetCode } from \"@firebase/auth\";\r\nimport { startLoading, stopLoading } from \"../../state/actions/isLoading\";\r\nimport Logo from \"../../assets/logo.png\";\r\nimport greenCheckmark from \"../../assets/misc/green-checkmark.png\";\r\nimport redX from \"../../assets/misc/red-x.png\";\r\n\r\nconst AccountVerification = () =>\r\n{\r\n\tconst dispatch = useDispatch();\r\n\tconst [mode, setMode] = useState(\"\");\r\n\tconst [actionCode, setActionCode] = useState(\"\");\r\n\tconst [status, setStatus] = useState({});\r\n\r\n\tconst passwordRef = useRef();\r\n\tconst confirmPasswordRef = useRef();\r\n\tconst [passwordResetDone, setPasswordResetDone] = useState(false);\r\n\tconst [passwordResetEmail, setPasswordResetEmail] = useState(\"\");\r\n\tconst [isInfoValid, setIsInfoValid] = useState(false);\r\n\r\n\tuseEffect(() => document.title = \"Verification  Instadicey\", []);\r\n\r\n\tconst handleVerifyEmail = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tawait applyActionCode(auth, actionCode);\r\n\t\t\tsetStatus({\r\n\t\t\t\ttype: \"email-verification\",\r\n\t\t\t\tok: true,\r\n\t\t\t});\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tsetStatus({\r\n\t\t\t\ttype: \"email-verification\",\r\n\t\t\t\tok: false,\r\n\t\t\t});\r\n\t\t}\r\n\t\tdispatch(stopLoading());\r\n\t};\r\n\r\n\tconst checkForm = () => checkPassword() && checkConfirmPassword() ? setIsInfoValid(true) : setIsInfoValid(false);\r\n\tconst checkPassword = () => passwordRef.current.value.length < 6 ? false : true;\r\n\tconst checkConfirmPassword = () => confirmPasswordRef.current.value === passwordRef.current.value ? true : false;\r\n\tconst handleFormSubmitPassword = async e =>\r\n\t{\r\n\t\te.preventDefault();\r\n\t\tif (!isInfoValid) return;\r\n\r\n\t\tconst newPassword = passwordRef.current.value;\r\n\t\ttry\r\n\t\t{\r\n\t\t\tawait confirmPasswordReset(auth, actionCode, newPassword);\r\n\t\t\tsetPasswordResetDone(true);\r\n\t\t\tsetStatus({\r\n\t\t\t\ttype: \"password-reset\",\r\n\t\t\t\tok: true,\r\n\t\t\t});\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(\"error with confirming password\", err);\r\n\t\t\tsetStatus({\r\n\t\t\t\ttype: \"password-reset\",\r\n\t\t\t\tok: false,\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tconst handlePasswordReset = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tconst email = await verifyPasswordResetCode(auth, actionCode);\r\n\t\t\tsetPasswordResetEmail(email);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(\"Invalid code\", err);\r\n\t\t\tsetStatus({\r\n\t\t\t\ttype: \"password-reset\",\r\n\t\t\t\tok: false,\r\n\t\t\t});\r\n\t\t}\r\n\t\tdispatch(stopLoading());\r\n\t};\r\n\r\n\tconst handleLink = () =>\r\n\t{\r\n\t\tswitch (mode)\r\n\t\t{\r\n\t\t\tcase \"verifyEmail\":\r\n\t\t\t\thandleVerifyEmail();\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase \"resetPassword\":\r\n\t\t\t\thandlePasswordReset();\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tdispatch(startLoading());\r\n\t\tsetMode(getParameterByName(\"mode\"));\r\n\t\tsetActionCode(getParameterByName(\"oobCode\"));\r\n\t\thandleLink();\r\n\t}, [mode]);\r\n\r\n\tconst getParameterByName = name =>\r\n\t{\r\n\t\tname = name.replace(/[[]/,\"\\\\[\").replace(/[\\]]/,\"\\\\]\");\r\n\t\tvar regexS = \"[\\\\?&]\"+name+\"=([^&#]*)\";\r\n\t\tvar regex = new RegExp(regexS);\r\n\t\tvar results = regex.exec(window.location.href);\r\n\t\tif (results == null)\r\n\t\t\treturn \"\";\r\n\t\telse\r\n\t\t\treturn decodeURIComponent(results[1].replace(/\\+/g, \" \"));\r\n\t};\r\n\r\n\r\n\tif (mode === \"resetPassword\" && !passwordResetDone && status.ok !== false)\r\n\t{\r\n\t\treturn(\r\n\t\t\t<div className=\"verification-window outlined password-reset\">\r\n\t\t\t\t<div className=\"icon\"><img src={Logo} alt=\"logo\"></img></div>\r\n\t\t\t\t<div className=\"email-div\">\r\n\t\t\t\t\t<h2>Your Email:</h2>\r\n\t\t\t\t\t<span>{passwordResetEmail}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<form onSubmit={handleFormSubmitPassword}>\r\n\t\t\t\t\t<input type=\"password\" id=\"password\" placeholder=\"Password (at least 6 characters)\" ref={passwordRef} onChange={checkForm}></input>\r\n\t\t\t\t\t<input type=\"password\" id=\"confirm password\" placeholder=\"Confirm Password\" ref={confirmPasswordRef} onChange={checkForm}></input>\r\n\t\t\t\t\t<button className={`${isInfoValid ? null : \"disabled\"}`}>Reset Password</button>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t);\r\n\t} else if (status.ok)\r\n\t{\r\n\t\treturn(\r\n\t\t\t<div className=\"verification-window success outlined\">\r\n\t\t\t\t<div className=\"icon\"><img src={greenCheckmark} alt=\"success\"></img></div>\r\n\t\t\t\t{\r\n\t\t\t\t\tstatus.type === \"email-verification\"\r\n\t\t\t\t\t\t? \r\n\t\t\t\t\t\t<div className=\"text-div\">\r\n\t\t\t\t\t\t\t<h1>Your email address has been verified</h1>\r\n\t\t\t\t\t\t\t<p>Please go back to the sign up page to continue.</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t: status.type === \"password-reset\"\r\n\t\t\t\t\t\t\t?\r\n\t\t\t\t\t\t\t<div className=\"text-div\">\r\n\t\t\t\t\t\t\t\t<h1>Your password has been reset</h1>\r\n\t\t\t\t\t\t\t\t<p>You can now log in with the new password.</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t: null\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t);\r\n\t} else if (status.ok === false)\r\n\t{\r\n\t\treturn(\r\n\t\t\t<div className=\"verification-window failed outlined\">\r\n\t\t\t\t<div className=\"icon\"><img src={redX} alt=\"failed\"></img></div>\r\n\t\t\t\t{\r\n\t\t\t\t\tstatus.type === \"email-verification\"\r\n\t\t\t\t\t\t? \r\n\t\t\t\t\t\t<div className=\"text-div\">\r\n\t\t\t\t\t\t\t<h1>An error has occured</h1>\r\n\t\t\t\t\t\t\t<p>This email address is already verified or the link might have expired.</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t: status.type === \"password-reset\"\r\n\t\t\t\t\t\t\t?\r\n\t\t\t\t\t\t\t<div className=\"text-div\">\r\n\t\t\t\t\t\t\t\t<h1>An error has occured</h1>\r\n\t\t\t\t\t\t\t\t<p>Please try to reset the password again.</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t: null\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\telse return null;\r\n};\r\n\r\nexport default AccountVerification;\r\n","import { useRef, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { auth } from \"../../firebase\";\r\nimport { EmailAuthProvider, reauthenticateWithCredential, updatePassword } from \"@firebase/auth\";\r\nimport LoadingPage from \"../LoadingPage\";\r\nimport { setSnackbar } from \"../../state/actions/snackbar\";\r\nimport Loading from \"../../assets/misc/loading.jpg\";\r\n\r\nconst ChangePassword = () =>\r\n{\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst dispatch = useDispatch();\r\n\tconst [isInfoValid, setIsInfoValid] = useState(null);\r\n\tconst [isLoading, setIsLoading] = useState(null);\r\n\r\n\tconst oldPasswordRef = useRef();\r\n\tconst newPasswordRef = useRef();\r\n\tconst confirmPasswordRef = useRef();\r\n\r\n\tconst handleOnChange = () =>\r\n\t\toldPasswordRef.current.value.length > 0\r\n\t\t&& newPasswordRef.current.value.length > 0\r\n\t\t&& confirmPasswordRef.current.value.length > 0\r\n\t\t\t?\tsetIsInfoValid(true)\r\n\t\t\t: setIsInfoValid(false);\r\n\r\n\tconst handleSubmit = async e =>\r\n\t{\r\n\t\te.preventDefault();\r\n\t\tif (!isInfoValid) return;\r\n\t\t\r\n\t\ttry\r\n\t\t{\r\n\t\t\tsetIsLoading(true);\r\n\t\t\tconst oldPassword = oldPasswordRef.current.value;\r\n\t\t\tconst newPassword = newPasswordRef.current.value;\r\n\t\t\tconst confirmPassword = confirmPasswordRef.current.value;\r\n\t\t\tif (newPassword !== confirmPassword) throw new Error(\"Password don't match\");\r\n\t\t\tif (newPassword.length < 6) throw new Error(\"Password too short\");\r\n\r\n\t\t\ttry\r\n\t\t\t{\r\n\t\t\t\tconst credentials = EmailAuthProvider.credential(currentUser.user.email, oldPassword);\r\n\t\t\t\tawait reauthenticateWithCredential(auth.currentUser, credentials);\r\n\t\t\t\tawait updatePassword(auth.currentUser, newPassword);\r\n\t\t\t\tdispatch(setSnackbar(\"Password updated successfully.\", \"success\"));\r\n\t\t\t\twindow.location.reload(false);\r\n\t\t\t} catch (err) { throw new Error(err.code); }\r\n\t\t\tsetIsLoading(false);\r\n\t\t} catch(err)\r\n\t\t{\r\n\t\t\tsetIsLoading(false);\r\n\t\t\tconsole.error(err.message);\r\n\t\t\tif (err.message === \"Password don't match\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Please make sure both password match.\", \"error\"));\r\n\t\t\tif (err.message === \"Password too short\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Password is too short. minimum is 6 characters.\", \"error\"));\r\n\t\t\tif (err.message === \"auth/wrong-password\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Your old password is not correct.\", \"error\"));\r\n\t\t\tdispatch(setSnackbar(\"Oops, please try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\r\n\tif (!currentUser) return <LoadingPage/>;\r\n\treturn(\r\n\t\t<div className=\"account-element change-password\">\r\n\t\t\t<div className=\"element profile-pic-container\">\r\n\t\t\t\t<div className=\"img-container outlined left\">\r\n\t\t\t\t\t<img src={currentUser.info.profilePic} alt={`${currentUser.info.username}'s profile pic'`}></img>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t{currentUser.info.username}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<form onSubmit={handleSubmit}>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<div className=\"left\">\r\n\t\t\t\t\t\t<label htmlFor=\"old-password\">Old Password</label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t\t<input type=\"password\" id=\"old-password\" className=\"outlined\" ref={oldPasswordRef} onChange={handleOnChange}></input>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<div className=\"left\">\r\n\t\t\t\t\t\t<label htmlFor=\"new-password\">New Password</label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t\t<input type=\"password\" id=\"new-password\" className=\"outlined\" ref={newPasswordRef} onChange={handleOnChange}></input>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<div className=\"left\">\r\n\t\t\t\t\t\t<label htmlFor=\"confirm-password\">Confirm New Password</label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t\t<input type=\"password\" id=\"confirm-password\" className=\"outlined\" ref={confirmPasswordRef} onChange={handleOnChange}></input>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<div className=\"left\"></div>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tisLoading\r\n\t\t\t\t\t\t\t? <button className=\"loading\"><div><img src={Loading} alt=\"loading\"></img></div></button>\r\n\t\t\t\t\t\t\t: <button className={`submit ${isInfoValid ? null : \"disabled\"}`}>Change Password</button>\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<div className=\"left\"></div>\r\n\t\t\t\t\t<Link to=\"/accounts/password/reset\" className=\"forgot-password\">Forgot Password?</Link>\r\n\t\t\t\t</div>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default ChangePassword;\r\n","import { useRef, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { auth, db, storage } from \"../../firebase\";\r\nimport { EmailAuthProvider, reauthenticateWithCredential, sendEmailVerification, updateEmail } from \"@firebase/auth\";\r\nimport { collection, doc, getDoc, getDocs, query, updateDoc, where } from \"@firebase/firestore\";\r\nimport { ref, uploadBytes, getDownloadURL } from \"@firebase/storage\";\r\nimport { setSnackbar } from \"../../state/actions/snackbar\";\r\nimport { setUser } from \"../../state/actions/currentUser\";\r\nimport LoadingPage from \"../LoadingPage\";\r\nimport Loading from \"../../assets/misc/loading.jpg\";\r\n\r\nconst EditProfile = () =>\r\n{\r\n\tconst dispatch = useDispatch();\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst [isInfoValid, setIsInfoValid] = useState(false);\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\tconst [isPhotoLoading, setIsPhotoLoading] = useState(false);\r\n\tconst [isPhotoChangerBoxOpen, setIsPhotoChangerBoxOpen] = useState(false);\r\n\r\n\tconst uploadRef = useRef();\r\n\tconst nameRef = useRef();\r\n\tconst usernameRef = useRef();\r\n\tconst bioRef = useRef();\r\n\tconst emailRef = useRef();\r\n\tconst confirmPasswordRef = useRef();\r\n\r\n\tconst openPhotoBox = () => currentUser.info.defaultProfilePic ? openPhotoUpload() : setIsPhotoChangerBoxOpen(true);\r\n\tconst closePhotoBox = () => setIsPhotoChangerBoxOpen(false);\r\n\tconst removePhoto = async () =>\r\n\t{\r\n\t\tclosePhotoBox();\r\n\t\tsetIsPhotoLoading(true);\r\n\t\tawait updateDoc(doc(db, \"users\", currentUser.user.uid), { profilePic: \"https://firebasestorage.googleapis.com/v0/b/instadicey.appspot.com/o/default%2FprofilePic.jpg?alt=media&token=3ac835a3-016e-470a-b7b3-f898d82cdbde\", defaultProfilePic: true });\r\n\t\tawait updateUserLocally();\r\n\t\tsetIsPhotoLoading(false);\r\n\t};\r\n\tconst openPhotoUpload = () => uploadRef.current.click();\r\n\tconst uploadPhoto = async input =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tconst uploadedPhoto = input.target.files[0];\r\n\t\t\tif (!uploadedPhoto)\r\n\t\t\t\tthrow new Error(\"No photo uploaded\");\r\n\t\t\tconst acceptedFormats = uploadRef.current.accept.split(\", \");\r\n\t\t\tif (!acceptedFormats.includes(uploadedPhoto.type))\r\n\t\t\t  throw new Error(\"Not a supported photo format\");\r\n\t\t\tclosePhotoBox();\r\n\t\t\tsetIsPhotoLoading(true);\r\n\t\t\tconst photoRef = ref(storage, `users/${currentUser.user.uid}/profilePic`);\r\n\t\t\tawait uploadBytes(photoRef, uploadedPhoto);\r\n\t\t\tconst uploadedPhotoURL = await getDownloadURL(photoRef);\r\n\t\t\tawait updateDoc(doc(db, \"users\", currentUser.user.uid), { profilePic: uploadedPhotoURL, defaultProfilePic: false });\r\n\t\t\tawait updateUserLocally();\r\n\t\t\tuploadRef.current.value = \"\";\r\n\t\t\tsetIsPhotoLoading(false);\r\n\t\t\tdispatch(setSnackbar(\"Photo updated successfully\", \"success\"));\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tif (err.message === \"No photo uploaded\")\r\n\t\t\t\treturn null;\r\n\t\t\tif (err.message === \"Not a supported photo format\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Not a supported photo format.\", \"error\"));\r\n\t\t\tdispatch(setSnackbar(\"Oops, please try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleChange = () => isInfoValid ? null : setIsInfoValid(true);\r\n\r\n\tconst handleNameChange = async realName =>\r\n\t{\r\n\t\treturn realName;\r\n\t};\r\n\r\n\tconst handleUsernameChange = async username =>\r\n\t{\r\n\t\tif (username.length > 20) throw new Error(\"Username too long\");\r\n\t\tif (username.trim() === \"\") throw new Error(\"Username not entered\");\r\n\t\tif (!username.match(/^[A-Za-z0-9]*$/)) throw new Error(\"Username not English\");\r\n\t\tconst usersRef = collection(db, \"users\");\r\n\t\tconst q = query(usersRef, where(\"username\", \"==\", username));\r\n\t\tconst querySnapshot = await getDocs(q);\r\n\t\tif (querySnapshot.docs.length !== 0)\r\n\t\t\tthrow new Error(\"Username already taken\");\r\n\t\treturn username;\r\n\t};\r\n\r\n\tconst handleBioChange = async bio =>\r\n\t{\r\n\t\tif (bio.length > 150) throw new Error(\"Bio too long\");\r\n\t\treturn bio;\r\n\t};\r\n\r\n\tconst handleEmailChange = async (email, password) =>\r\n\t{\r\n\t\tif (email.trim() === \"\") throw new Error(\"Email can't be empty\");\r\n\t\t// eslint-disable-next-line no-control-regex\r\n\t\tif (!email.match(/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|\"(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21\\x23-\\x5b\\x5d-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])*\")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x21-\\x5a\\x53-\\x7f]|\\\\[\\x01-\\x09\\x0b\\x0c\\x0e-\\x7f])+)\\])/))\r\n\t\t\tthrow new Error(\"Email is invalid\");\r\n\t\tif (password.trim() === \"\") throw new Error(\"Password can't be empty\");\r\n\t\tconst credentials = EmailAuthProvider.credential(currentUser.user.email, password);\r\n\t\ttry\r\n\t\t{\r\n\t\t\tawait reauthenticateWithCredential(auth.currentUser, credentials);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tthrow new Error(err.code);\r\n\t\t}\r\n\t\treturn email;\r\n\t};\r\n\r\n\tconst handleSubmit = async e =>\r\n\t{\r\n\t\te.preventDefault();\r\n\t\tif (!isInfoValid) return;\r\n\t\tsetIsLoading(true);\r\n\t\ttry\r\n\t\t{\r\n\t\t\tlet realName = currentUser.info.realName;\r\n\t\t\tlet username = currentUser.info.username;\r\n\t\t\tlet bio = currentUser.info.bio;\r\n\t\t\tlet email = currentUser.user.email;\r\n\r\n\t\t\tif (realName !== nameRef.current.value) realName = await handleNameChange(nameRef.current.value);\r\n\t\t\tif (username !== usernameRef.current.value) username = await handleUsernameChange(usernameRef.current.value);\r\n\t\t\tif (bio !== bioRef.current.value) bio = await handleBioChange(bioRef.current.value);\r\n\t\t\tif (email !== emailRef.current.value) email = await handleEmailChange(emailRef.current.value, confirmPasswordRef.current.value);\r\n\r\n\t\t\tawait updateDoc(doc(db, \"users\", currentUser.user.uid),\r\n\t\t\t\t{\r\n\t\t\t\t\trealName,\r\n\t\t\t\t\tusername,\r\n\t\t\t\t\tbio,\r\n\t\t\t\t});\r\n\t\t\tif (currentUser.user.email !== email)\r\n\t\t\t{\r\n\t\t\t\ttry\r\n\t\t\t\t{\r\n\t\t\t\t\tawait updateEmail(auth.currentUser, email);\r\n\t\t\t\t\tawait sendEmailVerification(auth.currentUser);\r\n\t\t\t\t} catch (err) { throw new Error(err.code); }\r\n\t\t\t}\r\n\t\t\tdispatch(setSnackbar(\"Info updated.\", \"success\"));\r\n\t\t\twindow.location.reload(false);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err.message);\r\n\t\t\tsetIsLoading(false);\r\n\t\t\tif (err.message === \"Username not entered\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Username can't be empty.\", \"error\"));\r\n\t\t\tif (err.message === \"Username too long\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Username too long. max is 20 characters.\", \"error\"));\r\n\t\t\tif (err.message === \"Username not English\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"English letters only.\", \"error\"));\r\n\t\t\tif (err.message === \"Username already taken\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Username already taken.\", \"error\"));\r\n\t\t\tif (err.message === \"Bio too long\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Bio is too long. max is 150 characters.\", \"error\"));\r\n\t\t\tif (err.message === \"Email can't be empty\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Email can't be empty.\", \"error\"));\r\n\t\t\tif (err.message === \"Email is invalid\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Email is invalid.\", \"error\"));\r\n\t\t\tif (err.message === \"Password can't be empty\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Please confirm your password.\", \"error\"));\r\n\t\t\tif (err.message === \"auth/email-already-in-use\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Email already in use.\"));\r\n\t\t\tif (err.message === \"auth/wrong-password\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Wrong password.\", \"error\"));\r\n\t\t\tdispatch(setSnackbar(\"Oops, please try again later.\", \"error\"));\r\n\t\t}\r\n\t\tsetIsLoading(false);\r\n\t};\r\n\r\n\tconst updateUserLocally = async () =>\r\n\t{\r\n\t\tconst info = await getDoc(doc(db, \"users\", currentUser.user.uid)).then(doc => doc.data());\r\n\t\tdispatch(setUser({ user: auth.currentUser, info }));\r\n\t};\r\n\r\n\tif (!currentUser) return <LoadingPage/>;\r\n\treturn(\r\n\t\t<div className=\"account-element edit-profile\">\r\n\t\t\t{ isPhotoChangerBoxOpen &&\r\n\t\t\t\t\t<div className=\"dialog-box-container\" onClick={closePhotoBox}>\r\n\t\t\t\t\t\t<div className=\"dialog-box\" onClick={e => e.stopPropagation()}>\r\n\t\t\t\t\t\t\t<h2>Change Profile Photo</h2>\r\n\t\t\t\t\t\t\t<button className=\"upload text\" onClick={openPhotoUpload}>Upload Photo</button>\r\n\t\t\t\t\t\t\t<button className=\"remove text\" onClick={removePhoto}>Remove Current Photo</button>\r\n\t\t\t\t\t\t\t<button className=\"cancel text\" onClick={closePhotoBox}>Cancel</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t}\r\n\t\t\t<div className=\"element profile-pic-container\">\r\n\t\t\t\t<div className=\"img-container outlined left\" onClick={openPhotoBox}>\r\n\t\t\t\t\t{ isPhotoLoading && <div className=\"loading\"><img src={Loading} alt=\"loading\"></img></div>}\r\n\t\t\t\t\t<img src={currentUser.info.profilePic} alt={`${currentUser.info.username}'s profile pic'`}></img>\r\n\t\t\t\t\t<input id=\"photo\" type=\"file\" accept=\"image/png, image/jpg, image/jpeg, image/pjpeg, image/jfif, image/pjp\" style={{display: \"none\"}} ref={uploadRef} onChange={uploadPhoto}></input>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t{currentUser.info.username}\r\n\t\t\t\t\t<button className=\"text\" onClick={openPhotoBox}>Change Profile Photo</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<form onSubmit={handleSubmit}>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<label htmlFor=\"name\" className=\"left\">Name</label>\r\n\t\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t\t<input type=\"text\" id=\"name\" defaultValue={currentUser.info.realName} placeholder=\"Name\" ref={nameRef} className=\"outlined\" onChange={handleChange}></input>\r\n\t\t\t\t\t\t<p>Help people discover your account by using the name you're known by: either your full name, nickname, or business name.</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<label htmlFor=\"username\" className=\"left\">Username</label>\r\n\t\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t\t<input type=\"text\" id=\"username\" defaultValue={currentUser.info.username} placeholder=\"Username\" ref={usernameRef} className=\"outlined\" onChange={handleChange}></input>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<label htmlFor=\"bio\" className=\"left\">Bio</label>\r\n\t\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t\t<textarea id=\"bio\" defaultValue={currentUser.info.bio} ref={bioRef} className=\"outlined\" onChange={handleChange}></textarea>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"element info\">\r\n\t\t\t\t\t<span className=\"left\"></span>\r\n\t\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t\t<p className=\"header\">Personal Information</p>\r\n\t\t\t\t\t\t<p>Provide your personal information, even if the account is used for a business, a pet or something else. This won't be a part of your public profile.</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<label htmlFor=\"email\" className=\"left\">Email</label>\r\n\t\t\t\t\t<div className=\"right\">\r\n\t\t\t\t\t\t<input type=\"text\" id=\"email\" defaultValue={currentUser.user.email} placeholder=\"Email\" ref={emailRef} className=\"outlined\" onChange={handleChange}></input>\r\n\t\t\t\t\t\t{ !emailRef.current || currentUser.user.email === emailRef.current.value\r\n\t\t\t\t\t\t\t? null \r\n\t\t\t\t\t\t\t: <input type=\"password\" id=\"password\" placeholder=\"Confirm Password\" ref={confirmPasswordRef} className=\"outlined\"></input>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"element\">\r\n\t\t\t\t\t<div className=\"left\"></div>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tisLoading\r\n\t\t\t\t\t\t\t? <button className=\"loading\"><div><img src={Loading} alt=\"loading\"></img></div></button>\r\n\t\t\t\t\t\t\t: <button className={`submit ${isInfoValid ? null : \"disabled\"}`}>Submit</button>\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default EditProfile;\r\n","import { useEffect } from \"react\";\r\nimport { Route, Switch, useHistory } from \"react-router\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport { useMediaQuery } from \"react-responsive\";\r\nimport ChangePassword from \"./ChangePassword\";\r\nimport EditProfile from \"./EditProfile\";\r\nimport \"./acc-edit.css\";\r\n\r\nconst AccountEdit = () =>\r\n{\r\n\tconst history = useHistory();\r\n\tconst phoneQuery = useMediaQuery({query: \"(max-width: 600px)\"});\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tif (history.location.pathname === \"/accounts/edit\")\r\n\t\t\tdocument.title = \"Edit Profile  Instadicey\";\r\n\t\telse if (history.location.pathname === \"/accounts/password/change\")\r\n\t\t\tdocument.title = \"Change Password  Instadicey\";\r\n\t}, [history.location.pathname]);\r\n\r\n\treturn(\r\n\t\t<div className=\"account-edit outlined\">\r\n\t\t\t{ !phoneQuery &&\r\n\t\t\t\t<ul className=\"sidebar\">\r\n\t\t\t\t\t<li><NavLink exact to=\"/accounts/edit\" activeClassName=\"selected\">Edit Profile</NavLink></li>\r\n\t\t\t\t\t<li><NavLink to=\"/accounts/password/change\" activeClassName=\"selected\">Change Password</NavLink></li>\r\n\t\t\t\t</ul>\r\n\t\t\t}\r\n\t\t\t<div className=\"main\">\r\n\t\t\t\t<Switch>\r\n\t\t\t\t\t<Route exact path=\"/accounts/edit\" component={EditProfile}></Route>\r\n\t\t\t\t\t<Route exact path=\"/accounts/password/change\" component={ChangePassword}></Route>\r\n\t\t\t\t</Switch>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default AccountEdit;\r\n","import { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { db } from \"../firebase\";\r\nimport { doc, setDoc, getDoc, runTransaction } from \"@firebase/firestore\";\r\nimport { setSnackbar } from \"../state/actions/snackbar\";\r\nimport Loading from \"../assets/misc/loading.jpg\";\r\n\r\nconst FollowButton = ({ target }) =>\r\n{\r\n\tconst dispatch = useDispatch();\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst [isLoading, setIsLoading] = useState(null);\r\n\tconst [isFollowing, setIsFollowing] = useState(false);\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst checkIfFollowing = async () =>\r\n\t\t{\r\n\t\t\tif (!currentUser) return;\r\n\t\t\tsetIsLoading(true);\r\n\t\t\tconst currentUserFollowing = await getDoc(doc(db, \"users\", currentUser.user.uid, \"user_follows\", \"following\")).then(doc => doc.data()).then(data => data ? data.following : []);\r\n\t\t\tif (currentUserFollowing.includes(target.uid)) setIsFollowing(true);\r\n\t\t\telse setIsFollowing(false);\r\n\t\t\tsetIsLoading(false);\r\n\t\t};\r\n\t\tcheckIfFollowing();\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, [currentUser, target]);\r\n\r\n\tconst follow = async () =>\r\n\t{\r\n\t\tif (!currentUser) return alert(\"sign in\");\r\n\t\twindow.onbeforeunload = () => \"\";\r\n\t\tsetIsLoading(true);\r\n\t\tawait addToUsersFollowing();\r\n\t\tawait addToTargetsFollowers();\r\n\t\tsetIsFollowing(true);\r\n\t\tsetIsLoading(false);\r\n\t\twindow.onbeforeunload = null;\r\n\t};\r\n\tconst unfollow = async () =>\r\n\t{\r\n\t\twindow.onbeforeunload = () => \"\";\r\n\t\tsetIsLoading(true);\r\n\t\tawait removeFromUsersFollowing();\r\n\t\tawait removeFromTargetsFollowers();\r\n\t\tsetIsFollowing(false);\r\n\t\tsetIsLoading(false);\r\n\t\twindow.onbeforeunload = null;\r\n\t};\r\n\r\n\tconst addToUsersFollowing = async () =>\r\n\t{\r\n\t\tconst userRefFollowing = doc(db, \"users\", currentUser.user.uid, \"user_follows\", \"following\");\r\n\t\ttry\r\n\t\t{\r\n\t\t\tawait runTransaction(db, async t =>\r\n\t\t\t{\r\n\t\t\t\tconst sfDoc = await t.get(userRefFollowing);\r\n\t\t\t\tif (!sfDoc.exists()) throw new Error(\"Document does not exist\");\r\n\t\t\t\tconst newFollowingArray = [...sfDoc.data().following, target.uid];\r\n\t\t\t\tt.update(userRefFollowing, { following: newFollowingArray }, { merge: true });\r\n\t\t\t});\r\n\t\t}\r\n\t\tcatch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tif (err.message === \"Document does not exist\")\r\n\t\t\t{\r\n\t\t\t\tawait setDoc(userRefFollowing,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfollowing: [target.uid]\r\n\t\t\t\t\t}, {merge: true});\r\n\t\t\t}\r\n\t\t\telse dispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\tconst removeFromUsersFollowing = async () =>\r\n\t{\r\n\t\tconst userRefFollowing = doc(db, \"users\", currentUser.info.uid, \"user_follows\", \"following\");\r\n\t\ttry\r\n\t\t{\r\n\t\t\tawait runTransaction(db, async t =>\r\n\t\t\t{\r\n\t\t\t\tconst sfDoc = await t.get(userRefFollowing);\r\n\t\t\t\tif (!sfDoc.exists()) throw new Error(\"Document does not exist\");\r\n\t\t\t\tif (!sfDoc.data().following.includes(target.uid)) throw new Error(\"User already not followed\");\r\n\t\t\t\tconst newFollowingArray = sfDoc.data().following.filter(user => user !== target.uid);\r\n\t\t\t\tt.update(userRefFollowing, { following: newFollowingArray }, { merge: true });\r\n\t\t\t});\r\n\t\t}\r\n\t\tcatch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tdispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\r\n\tconst addToTargetsFollowers = async () =>\r\n\t{\r\n\t\tconst targetRefFollowers = doc(db, \"users\", target.uid, \"user_follows\", \"followers\");\r\n\t\ttry\r\n\t\t{\r\n\t\t\tawait runTransaction(db, async t =>\r\n\t\t\t{\r\n\t\t\t\tconst sfDoc = await t.get(targetRefFollowers);\r\n\t\t\t\tif (!sfDoc.exists()) throw new Error(\"Document does not exist\");\r\n\t\t\t\tif (sfDoc.data().followers.includes(currentUser.user.uid)) throw new Error(\"User already followed\");\r\n\t\t\t\tconst newFollowersArray = [...sfDoc.data().followers, currentUser.user.uid];\r\n\t\t\t\tt.update(targetRefFollowers, { followers: newFollowersArray }, { merge: true });\r\n\t\t\t});\r\n\t\t}\r\n\t\tcatch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tif (err.message === \"Document does not exist\")\r\n\t\t\t{\r\n\t\t\t\tawait setDoc(targetRefFollowers,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfollowers: [currentUser.user.uid]\r\n\t\t\t\t\t}, {merge: true});\r\n\t\t\t}\r\n\t\t\telse dispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\tconst removeFromTargetsFollowers = async () =>\r\n\t{\r\n\t\tconst targetRefFollowers = doc(db, \"users\", target.uid, \"user_follows\", \"followers\");\r\n\t\ttry\r\n\t\t{\r\n\t\t\tawait runTransaction(db, async t =>\r\n\t\t\t{\r\n\t\t\t\tconst sfDoc = await t.get(targetRefFollowers);\r\n\t\t\t\tif (!sfDoc.exists()) throw new Error(\"Document does not exist\");\r\n\t\t\t\tconst newFollowersArray = sfDoc.data().followers.filter(user => user !== currentUser.user.uid);\r\n\t\t\t\tt.update(targetRefFollowers, { followers: newFollowersArray }, { merge: true });\r\n\t\t\t});\r\n\t\t}\r\n\t\tcatch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tdispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\r\n\tif (isLoading) return <button className=\"follow-btn loading\"><div><img src={Loading} alt=\"loading\"></img></div></button>;\r\n\tif (isFollowing)\r\n\t\treturn <button className=\"follow-btn unfollow\" onClick={unfollow}>Unfollow</button>;\r\n\telse\r\n\t\treturn <button className=\"follow-btn follow\" onClick={follow}>Follow</button>;\r\n};\r\n\r\nexport default FollowButton;\r\n","const VerifiedTick = ({size = 24, user, marginLeft = 10, marginRight = 0}) =>\r\n{\r\n\tif (user.verified) return(\r\n\t\t<span className=\"verified\" style={{marginLeft, marginRight}}>\r\n\t\t\t<svg xmlns='http://www.w3.org/2000/svg' width={size} height={size} viewBox='0 0 24 24'><path d='M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm-1.959 17l-4.5-4.319 1.395-1.435 3.08 2.937 7.021-7.183 1.422 1.409-8.418 8.591z'/></svg>\r\n\t\t</span>\r\n\t);\r\n\telse return null;\r\n};\r\n\r\nexport default VerifiedTick;\r\n","import { useEffect, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { db } from \"../firebase\";\r\nimport { doc, getDoc, setDoc } from \"@firebase/firestore\";\r\nimport FollowButton from \"./FollowButton\";\r\nimport VerifiedTick from \"./VerifiedTick\";\r\n\r\nconst FollowWindow = props =>\r\n{\r\n\tconst { title, uids, closeFollowListWindow, newMessage } = props;\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst [list, setList] = useState(null);\r\n\tconst [isLoading, setIsLoading] = useState(true);\r\n\r\n\tconst uidToNumbers = uid =>\r\n\t{\r\n\t\tconst uidCharactersArrary = uid.split(\"\");\r\n\t\tconst uidNumbersArray = uidCharactersArrary.map(char => Number.isInteger(parseInt(char)) ? char : `${Math.abs(char.charCodeAt(0) - 97)}`);\r\n\t\tconst newUid = uidNumbersArray.join(\"\").slice(0, 25);\r\n\t\treturn newUid;\r\n\t};\r\n\t\r\n\tconst getRoomID = targetUid =>\r\n\t{\r\n\t\tconst currentUserUID = uidToNumbers(currentUser.user.uid);\r\n\t\tconst targetUserUID = uidToNumbers(targetUid);\r\n\t\tconst roomID = currentUserUID > targetUserUID ? `${currentUserUID}${targetUserUID}` : `${targetUserUID}${currentUserUID}`;\r\n\t\treturn roomID;\r\n\t};\r\n\r\n\tconst handleStartChat = async (targetUid, roomID) =>\r\n\t{\r\n\t\tcloseFollowListWindow();\r\n\t\tawait setDoc(doc(db, \"chats\", roomID),\r\n\t\t\t{\r\n\t\t\t\tid: roomID,\r\n\t\t\t\tmembers:\r\n\t\t\t\t[\r\n\t\t\t\t\ttargetUid,\r\n\t\t\t\t\tcurrentUser.user.uid,\r\n\t\t\t\t]\r\n\t\t\t}, {merge: true});\r\n\t};\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst getUidsInfo = async () =>\r\n\t\t{\r\n\t\t\tconst data = await Promise.all(uids.map(uid => getDoc(doc(db, \"users\", uid)).then(doc => doc.data())));\r\n\t\t\tsetList(data);\r\n\t\t\tsetIsLoading(false);\r\n\t\t};\r\n\t\tgetUidsInfo();\r\n\t}, [uids]);\r\n\r\n\treturn(\r\n\t\t<div className=\"backdrop container\" onClick={closeFollowListWindow}>\r\n\t\t\t<div className=\"follow-list-window\" onClick={e => e.stopPropagation()}>\r\n\t\t\t\t<div className=\"header\">\r\n\t\t\t\t\t<h1>{title}</h1>\r\n\t\t\t\t\t<span className=\"close\" onClick={closeFollowListWindow}>X</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t{ isLoading\r\n\t\t\t\t\t? \r\n\t\t\t\t\t<ul className=\"loading\">\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t[0,1,2,3,4,5,6,7,8].map(n =>\r\n\t\t\t\t\t\t\t\t<li className=\"person\" key={n}>\r\n\t\t\t\t\t\t\t\t\t<div className=\"profile\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"profile-pic\"></div>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"info\">\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"real-name\"></span>\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"username\"></span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t\t:\r\n\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tnewMessage\r\n\t\t\t\t\t\t\t\t?\r\n\t\t\t\t\t\t\t\tlist.map(person => \r\n\t\t\t\t\t\t\t\t\t<Link to={`/direct/t/${getRoomID(person.uid)}`} className=\"person\" key={person.uid} onClick={() => handleStartChat(person.uid, getRoomID(person.uid))}>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"profile\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"profile-pic\"><img src={person.profilePic} alt={`${person.username}'s Pic`}></img></div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div style={{display: \"flex\"}}><span className=\"username\">{person.username}</span></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"real-name\">{person.realName}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\tlist.map(person => \r\n\t\t\t\t\t\t\t\t\t<li className=\"person\" key={person.uid}>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"profile\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Link to={`/${person.username}`}><div className=\"profile-pic\"><img src={person.profilePic} alt={`${person.username}'s Pic`}></img></div></Link>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div style={{display: \"flex\"}}><Link to={`/${person.username}`} className=\"username\">{person.username}</Link> <VerifiedTick user={person} size={15} marginLeft={7.5}/></div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"real-name\">{person.realName}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t{currentUser && currentUser.user.uid === person.uid ? null : <FollowButton target={person} startLoading={() => setIsLoading(true)} stopLoading={() => setIsLoading(false)}/>}\r\n\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default FollowWindow;\r\n","import { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { db } from \"../../firebase\";\r\nimport { arrayRemove, arrayUnion, doc, updateDoc } from \"@firebase/firestore\";\r\nimport { setSnackbar } from \"../../state/actions/snackbar\";\r\n\r\nconst Like = ({size = 25, target, postPath, isComment}) =>\r\n{\r\n\tconst dispatch = useDispatch();\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst [isLiked, setIsLiked] = useState(false);\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst checkIfLiked = async () =>\r\n\t\t{\r\n\t\t\tif (!currentUser) return;\r\n\t\t\tif (target.likes.includes(currentUser.user.uid)) setIsLiked(true);\r\n\t\t\telse setIsLiked(false);\r\n\t\t};\r\n\t\tcheckIfLiked();\r\n\t}, [currentUser, target]);\r\n\r\n\tconst like = async () =>\r\n\t{\r\n\t\tif (!currentUser) return alert(\"sign in\");\r\n\t\ttry\r\n\t\t{\r\n\t\t\tif (isComment)\r\n\t\t\t{\r\n\t\t\t\tawait updateDoc(doc(db, postPath, \"comments\", `${target.id}`),\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlikes: arrayUnion(currentUser.user.uid),\r\n\t\t\t\t\t});\r\n\t\t\t} else\r\n\t\t\t{\r\n\t\t\t\tawait updateDoc(doc(db, postPath),\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlikes: arrayUnion(currentUser.user.uid),\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tdispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t\tsetIsLiked(true);\r\n\t};\r\n\t\r\n\tconst unlike = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tif (isComment)\r\n\t\t\t{\r\n\t\t\t\tawait updateDoc(doc(db, postPath, \"comments\", `${target.id}`),\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlikes: arrayRemove(currentUser.user.uid),\r\n\t\t\t\t\t});\r\n\t\t\t} else\r\n\t\t\t{\r\n\t\t\t\tawait updateDoc(doc(db, postPath),\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlikes: arrayRemove(currentUser.user.uid),\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tdispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t\tsetIsLiked(false);\r\n\t};\r\n\r\n\tif (isLiked)\r\n\t\treturn(\r\n\t\t\t<button className=\"like liked icon\" onClick={unlike}>\r\n\t\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width={size} height={size} viewBox=\"0 0 24 24\"><path d=\"M12 4.248c-3.148-5.402-12-3.825-12 2.944 0 4.661 5.571 9.427 12 15.808 6.43-6.381 12-11.147 12-15.808 0-6.792-8.875-8.306-12-2.944z\"/></svg>\r\n\t\t\t</button>\r\n\t\t);\r\n\telse return(\r\n\t\t<button className=\"like icon\" onClick={like}>\r\n\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width={size} height={size} viewBox=\"0 0 24 24\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M12 21.593c-5.63-5.539-11-10.297-11-14.402 0-3.791 3.068-5.191 5.281-5.191 1.312 0 4.151.501 5.719 4.457 1.59-3.968 4.464-4.447 5.726-4.447 2.54 0 5.274 1.621 5.274 5.181 0 4.069-5.136 8.625-11 14.402m5.726-20.583c-2.203 0-4.446 1.042-5.726 3.238-1.285-2.206-3.522-3.248-5.719-3.248-3.183 0-6.281 2.187-6.281 6.191 0 4.661 5.571 9.429 12 15.809 6.43-6.38 12-11.148 12-15.809 0-4.011-3.095-6.181-6.274-6.181\"/></svg>\r\n\t\t</button>\r\n\t);\r\n};\r\n\r\nexport default Like;\r\n","import { useEffect, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { db } from \"../../firebase\";\r\nimport { deleteDoc, doc, getDoc } from \"@firebase/firestore\";\r\nimport { format, formatDistanceToNowStrict, fromUnixTime } from \"date-fns\";\r\nimport VerifiedTick from \"../VerifiedTick\";\r\nimport Like from \"./Like\";\r\n\r\nconst Comment = ({ commentData, postPath, noPhoto, noTimestamp, noLike, noLikesCounter, noRemove, isCaption, setLikesWindow, refreshComments}) =>\r\n{\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst [commenterInfo, setCommenterInfo] = useState(null);\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\r\n\tconst getCommenterInfo = async () =>\r\n\t{\r\n\t\tconst commenterUid = commentData.user;\r\n\t\tconst commenterInfo = await getDoc(doc(db, \"users\", commenterUid)).then(doc => doc.data());\r\n\t\treturn commenterInfo;\r\n\t};\r\n\r\n\tconst removeComment = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tif (currentUser.user.uid !== commentData.user) throw new Error(\"Fuck off\");\r\n\t\t\tsetIsLoading(true);\r\n\t\t\tawait deleteDoc(doc(db, `${postPath}/comments/${commentData.id}`));\r\n\t\t\tawait refreshComments();\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tsetIsLoading(false);\r\n\t\t\tconsole.error(err);\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst setInfo = async () =>\r\n\t\t{\r\n\t\t\tconst info = await getCommenterInfo();\r\n\t\t\tsetCommenterInfo(info);\r\n\t\t};\r\n\t\tsetInfo();\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, []);\r\n\r\n\tif (!commenterInfo || !currentUser) return null;\r\n\treturn(\r\n\t\t<div className={`comment ${isLoading ? \"disabled\" : null}`} style={noLike ? null : {paddingRight: \"25px\"}}>\r\n\t\t\t{noPhoto || <Link to={`/${commenterInfo.username}`}><div className=\"profile-pic\"><img src={commenterInfo.profilePic} alt={`${commenterInfo.username}'s profile pic`}></img></div></Link>}\r\n\t\t\t<div className=\"info\">\r\n\t\t\t\t<div style={{display: \"inline-block\"}}>\r\n\t\t\t\t\t<Link to={`/${commenterInfo.username}`} className=\"username\">{commenterInfo.username}</Link>\r\n\t\t\t\t\t<VerifiedTick size={12.5} user={commenterInfo} marginLeft={0} marginRight={7.5}/>\r\n\t\t\t\t\t<span className=\"text\">{commentData.comment}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t{noTimestamp || <span className=\"timestamp\" title={format(fromUnixTime(commentData.timestamp.seconds), \"d MMM, yyyy\")}>{formatDistanceToNowStrict(fromUnixTime(commentData.timestamp.seconds))}</span>}\r\n\t\t\t\t\t{ noLikesCounter || commentData.likes.length === 0 ||\r\n\t\t\t\t\t\t<span className=\"likes\" onClick={() => setLikesWindow(commentData.likes)}>{commentData.likes.length} likes</span>\r\n\t\t\t\t\t}\r\n\t\t\t\t\t{(commentData.user === currentUser.user.uid && !noRemove) && <button className=\"icon\" style={{width: 15, height: 15}} onClick={removeComment}><svg width=\"15\" height=\"15\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M9 3h6v-1.75c0-.066-.026-.13-.073-.177-.047-.047-.111-.073-.177-.073h-5.5c-.066 0-.13.026-.177.073-.047.047-.073.111-.073.177v1.75zm11 1h-16v18c0 .552.448 1 1 1h14c.552 0 1-.448 1-1v-18zm-10 3.5c0-.276-.224-.5-.5-.5s-.5.224-.5.5v12c0 .276.224.5.5.5s.5-.224.5-.5v-12zm5 0c0-.276-.224-.5-.5-.5s-.5.224-.5.5v12c0 .276.224.5.5.5s.5-.224.5-.5v-12zm8-4.5v1h-2v18c0 1.105-.895 2-2 2h-14c-1.105 0-2-.895-2-2v-18h-2v-1h7v-2c0-.552.448-1 1-1h6c.552 0 1 .448 1 1v2h7z\"/></svg></button>}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t{noLike || <Like size={15} target={commentData} postPath={postPath} isComment/>}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Comment;\r\n","import { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { db } from \"../../firebase\";\r\nimport { arrayRemove, arrayUnion, doc, getDoc, updateDoc } from \"@firebase/firestore\";\r\nimport { setSnackbar } from \"../../state/actions/snackbar\";\r\n\r\nconst Save = ({size = 25, target}) =>\r\n{\r\n\tconst dispatch = useDispatch();\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst [isSaved, setIsSaved] = useState(false);\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst checkIfSaved = async () =>\r\n\t\t{\r\n\t\t\tif (!currentUser) return;\r\n\t\t\tconst currentUserSaved = await getDoc(doc(db, \"users\", currentUser.user.uid)).then(doc => doc.data().saved);\r\n\t\t\tif (currentUserSaved.includes(target.id)) setIsSaved(true);\r\n\t\t\telse setIsSaved(false);\r\n\t\t};\r\n\t\tcheckIfSaved();\r\n\t}, [currentUser, target]);\r\n\r\n\tconst save = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tif (!currentUser) throw new Error(\"User not signed in\");\r\n\t\t\tawait updateDoc(doc(db, \"users\", currentUser.user.uid),\r\n\t\t\t\t{\r\n\t\t\t\t\tsaved: arrayUnion(target.id),\r\n\t\t\t\t});\r\n\t\t\tsetIsSaved(true);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tif (err.message === \"User not signed in\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Please sign in first!\", \"error\"));\r\n\t\t\telse dispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\r\n\tconst unsave = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tawait updateDoc(doc(db, \"users\", currentUser.user.uid),\r\n\t\t\t\t{\r\n\t\t\t\t\tsaved: arrayRemove(target.id),\r\n\t\t\t\t});\r\n\t\t\tsetIsSaved(false);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tdispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\r\n\t if (isSaved) return(\r\n\t\t<button className=\"save saved icon\" onClick={unsave}>\r\n\t\t\t<svg xmlns=\"http://www.w3.org/2000/svg\" width={size} height={size} viewBox=\"0 0 24 24\"><path d=\"M18 24l-6-5.269-6 5.269v-24h12v24z\"/></svg>\r\n\t\t</button>\r\n\t);\r\n\telse return(\r\n\t\t<button className=\"save icon\" onClick={save}>\r\n\t\t\t<svg width={size} height={size} viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M5 0v24l7-6 7 6v-24h-14zm1 1h12v20.827l-6-5.144-6 5.144v-20.827z\"></path></svg>\r\n\t\t</button>\r\n\t);\r\n};\r\n\r\nexport default Save;\r\n","import { useRef, useState, useEffect } from \"react\";\r\nimport { Link, useHistory, useLocation } from \"react-router-dom\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { db } from \"../../firebase\";\r\nimport { collection, collectionGroup, deleteDoc, doc, getDoc, getDocs, query, serverTimestamp, setDoc, where } from \"@firebase/firestore\";\r\nimport { nanoid } from \"nanoid\";\r\nimport { format, formatDistanceToNowStrict, fromUnixTime, getYear } from \"date-fns\";\r\nimport { setSnackbar } from \"../../state/actions/snackbar\";\r\nimport FollowButton from \"../FollowButton\";\r\nimport FollowWindow from \"../FollowWindow\";\r\nimport Like from \"./Like\";\r\nimport Comment from \"./Comment\";\r\nimport Save from \"./Save\";\r\nimport VerifiedTick from \"../VerifiedTick\";\r\n\r\nconst PostWindow = ({postID, isVertical}) =>\r\n{\r\n\tconst history = useHistory();\r\n\tconst location = useLocation();\r\n\tconst addComment = useRef();\r\n\tconst dispatch = useDispatch();\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\r\n\tconst [userInfo, setUserInfo] = useState(null);\r\n\tconst [postPath, setPostPath] = useState(\"\");\r\n\tconst [postData, setPostData] = useState(null);\r\n\tconst [comments, setComments] = useState(null);\r\n\r\n\tconst [isInfoValid, setIsInfoValid] = useState(false);\r\n\tconst [commentLoading, setCommentLoading] = useState(false);\r\n\tconst [isDialogBoxOpen, setIsDialogBoxOpen] = useState(false);\r\n\tconst closeDialogBox = () => setIsDialogBoxOpen(false);\r\n\tconst [likesWindow, setLikesWindow] = useState(null);\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\treturn () => closeDialogBox();\r\n\t}, []);\r\n\r\n\tconst getUserData = async uid =>\r\n\t{\r\n\t\tconst userData = await getDoc(doc(db, \"users\", uid)).then(doc => doc.data());\r\n\t\tsetUserInfo(userData);\r\n\t};\r\n\r\n\tconst getPostComments = async (path = postPath) =>\r\n\t{\r\n\t\tlet comments = await getDocs(collection(db, `${path}/comments`))\r\n\t\t\t.then(querySnapshot => querySnapshot.docs.map(doc => doc.data()));\r\n\t\tsetComments(comments);\r\n\t};\r\n\r\n\tconst handleAddComment = async e =>\r\n\t{\r\n\t\te.preventDefault();\r\n\t\tif (!isInfoValid) return;\r\n\r\n\t\ttry\r\n\t\t{\r\n\t\t\tsetCommentLoading(true);\r\n\t\t\tconst comment = addComment.current.value;\r\n\t\t\tconst id = nanoid(32);\r\n\t\t\tif (comment.trim().length < 1)\r\n\t\t\t\tthrow new Error(\"Comment is empty\");\r\n\t\t\tif (comment.length > 2200)\r\n\t\t\t\tthrow new Error(\"Comment too long\");\r\n\t\t\tawait setDoc(doc(db, `${postPath}/comments/${id}`),\r\n\t\t\t\t{\r\n\t\t\t\t\tcomment,\r\n\t\t\t\t\tlikes: [],\r\n\t\t\t\t\tuser: currentUser.user.uid,\r\n\t\t\t\t\tid,\r\n\t\t\t\t\ttimestamp: serverTimestamp(),\r\n\t\t\t\t});\r\n\t\t\tawait getPostComments(postPath);\r\n\t\t\tsetCommentLoading(false);\r\n\t\t\taddComment.current.value = \"\";\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tif (err.message === \"Comment is empty\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Please enter a password.\", \"error\"));\r\n\t\t\telse if (err.message === \"Comment too long\")\r\n\t\t\t\treturn dispatch(setSnackbar(\"Comment too long. max is 2200 characters.\", \"error\"));\r\n\t\t\telse dispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleTextareaEnter = e =>\r\n\t{\r\n\t\tif(e.keyCode === 13 && e.shiftKey === false)\r\n\t\t{\r\n\t\t\te.preventDefault();\r\n\t\t\thandleAddComment(e);\r\n\t\t}\r\n\t};\r\n\r\n\tconst deletePost = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tif (currentUser.user.uid !== postData.user) throw new Error(\"Fuck off\");\r\n\t\t\tsetIsLoading(true);\r\n\t\t\tawait deleteDoc(doc(db, postPath));\r\n\t\t\thistory.push(\"/\");\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tsetIsLoading(false);\r\n\t\t\tconsole.error(err);\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst getData = async () =>\r\n\t\t{\r\n\t\t\t//dispatch(startLoading());\r\n\t\t\tconst postDoc = await getDocs(query(collectionGroup(db, \"user_posts\"), where(\"id\", \"==\", `${postID}`)))\r\n\t\t\t\t.then(querySnapshot => querySnapshot.docs[0]);\r\n\t\t\tsetPostData(postDoc.data());\r\n\t\t\tawait getUserData(postDoc.data().user);\r\n\t\t\tconst path = postDoc.ref.path;\r\n\t\t\tsetPostPath(path);\r\n\t\t\tawait getPostComments(path);\r\n\t\t\t//dispatch(stopLoading());\r\n\t\t};\r\n\t\tgetData();\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, []);\r\n\r\n\tif (!currentUser || !postData || !comments) return null;\r\n\tif (isVertical)\r\n\t\treturn(\r\n\t\t\t<div className=\"post-window outlined vertical\">\r\n\t\t\t\t{ likesWindow\r\n\t\t\t\t\t? <FollowWindow title=\"Likes\" uids={likesWindow} closeFollowListWindow={() => setLikesWindow(null)}/>\r\n\t\t\t\t\t: null\r\n\t\t\t\t}\r\n\t\t\t\t{ isDialogBoxOpen &&\r\n\t\t\t\t<div className=\"dialog-box-container\" onClick={closeDialogBox}>\r\n\t\t\t\t\t<div className=\"dialog-box\" onClick={e => e.stopPropagation()}>\r\n\t\t\t\t\t\t{location.pathname !== \"/\" ? null : <button className=\"text\" onClick={() => history.push(`/p/${postData.id}`)}>Go to post</button>}\r\n\t\t\t\t\t\t{location.pathname !== \"/\" ? null : <button className=\"text\" onClick={() => { navigator.clipboard.writeText(`${window.location.origin}/#/p/${postID}`); closeDialogBox(); }}>Copy Link</button>}\r\n\t\t\t\t\t\t{currentUser.user.uid === postData.user && <button className=\"remove text\" onClick={deletePost}>Delete</button>}\r\n\t\t\t\t\t\t<button className=\"cancel text\" onClick={closeDialogBox}>Cancel</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t\t<div className=\"poster\">\r\n\t\t\t\t\t<Link to={`/${userInfo.username}`}><div className=\"profile-pic outlined round\"><img src={userInfo.profilePic} alt=\"Profile Pic\"></img></div></Link>\r\n\t\t\t\t\t<Link to={`/${userInfo.username}`} className=\"username\">{userInfo.username}</Link>\r\n\t\t\t\t\t<button className=\"icon\" style={{width: 15, height: 15}} onClick={() => setIsDialogBoxOpen(true)}><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6 12c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3zm9 0c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3zm9 0c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3z\"/></svg></button>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"post-photo\">\r\n\t\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t\t<img src={postData.photo} alt={postData.caption}></img>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"side\">\r\n\t\t\t\t\t<div className=\"info\">\r\n\t\t\t\t\t\t<div className=\"interactions\">\r\n\t\t\t\t\t\t\t<div style={{display: \"flex\"}}>\r\n\t\t\t\t\t\t\t\t<Like target={postData} postPath={postPath}/>\r\n\t\t\t\t\t\t\t\t<button className=\"comment-bubble icon\"><svg width=\"25\" height=\"25\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M12 1c-6.338 0-12 4.226-12 10.007 0 2.05.739 4.063 2.047 5.625l-1.993 6.368 6.946-3c1.705.439 3.334.641 4.864.641 7.174 0 12.136-4.439 12.136-9.634 0-5.812-5.701-10.007-12-10.007m0 1c6.065 0 11 4.041 11 9.007 0 4.922-4.787 8.634-11.136 8.634-1.881 0-3.401-.299-4.946-.695l-5.258 2.271 1.505-4.808c-1.308-1.564-2.165-3.128-2.165-5.402 0-4.966 4.935-9.007 11-9.007\"/></svg></button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<Save target={postData}/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<span className=\"likes\" onClick={() => setLikesWindow(postData.likes)}><span className=\"number\">{postData.likes.length}</span> likes</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"comments\">\r\n\t\t\t\t\t\t{ postData.caption.length === 0 ||\r\n\t\t\t\t\t\t\t<Comment\r\n\t\t\t\t\t\t\t\tcommentData={{user: postData.user, comment: postData.caption, timestamp: postData.timestamp}}\r\n\t\t\t\t\t\t\t\tnoLike\r\n\t\t\t\t\t\t\t\tnoPhoto\r\n\t\t\t\t\t\t\t\tnoTimestamp\r\n\t\t\t\t\t\t\t\tnoLikesCounter\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t{comments.length > 2 && <Link to={`/p/${postID}`} style={{color: \"#8e8e8e\", fontSize: \"0.9em\", fontWeight: \"500\"}}>View all {comments.length} comments</Link>}\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tcomments.slice(0, 2).map(comment =>\r\n\t\t\t\t\t\t\t\t<Comment\r\n\t\t\t\t\t\t\t\t\tcommentData={comment}\r\n\t\t\t\t\t\t\t\t\tpostPath={postPath}\r\n\t\t\t\t\t\t\t\t\tkey={comment.id}\r\n\t\t\t\t\t\t\t\t\tsetLikesWindow={setLikesWindow}\r\n\t\t\t\t\t\t\t\t\trefreshComments={getPostComments}\r\n\t\t\t\t\t\t\t\t\tnoPhoto\r\n\t\t\t\t\t\t\t\t\tnoTimestamp\r\n\t\t\t\t\t\t\t\t\tnoLikesCounter\r\n\t\t\t\t\t\t\t\t\tnoRemove\r\n\t\t\t\t\t\t\t\t/>)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t<span className=\"timestamp\" title={format(fromUnixTime(postData.timestamp.seconds), \"d MMM, yyyy\")}>\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tnew Date().getTime() / 1000 - postData.timestamp.seconds > 604800\r\n\t\t\t\t\t\t\t\t\t?\tgetYear(fromUnixTime(postData.timestamp.seconds)) === getYear(new Date())\r\n\t\t\t\t\t\t\t\t\t\t? format(fromUnixTime(postData.timestamp.seconds), \"d MMMM\")\r\n\t\t\t\t\t\t\t\t\t\t: format(fromUnixTime(postData.timestamp.seconds), \"d MMMM, yyyy\")\r\n\t\t\t\t\t\t\t\t\t: formatDistanceToNowStrict(fromUnixTime(postData.timestamp.seconds))\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<form className=\"add-comment-container\" onSubmit={handleAddComment}>\r\n\t\t\t\t\t\t<textarea className={commentLoading ? \"add-comment disabled\" : \"add-comment\"} placeholder=\"Add a comment...\" ref={addComment} onChange={() => addComment.current.value.length > 0 ? setIsInfoValid(true) : setIsInfoValid(false)} onKeyDown={handleTextareaEnter}/>\r\n\t\t\t\t\t\t<button className={`${isInfoValid ? \"text\" : \"text disabled\"}`}>Post</button>\r\n\t\t\t\t\t</form>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\telse return(\r\n\t\t<div className={`post-window outlined ${isLoading ? \"disabled\" : \"\"}`}>\r\n\t\t\t{ likesWindow\r\n\t\t\t\t? <FollowWindow title=\"Likes\" uids={likesWindow} closeFollowListWindow={() => setLikesWindow(null)}/>\r\n\t\t\t\t: null\r\n\t\t\t}\r\n\t\t\t{ isDialogBoxOpen &&\r\n\t\t\t\t<div className=\"dialog-box-container\" onClick={closeDialogBox}>\r\n\t\t\t\t\t<div className=\"dialog-box\" onClick={e => e.stopPropagation()}>\r\n\t\t\t\t\t\t{currentUser.user.uid === postData.user && <button className=\"remove text\" onClick={deletePost}>Delete</button>}\r\n\t\t\t\t\t\t<button className=\"cancel text\" onClick={closeDialogBox}>Cancel</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t}\r\n\t\t\t<img src={postData.photo} alt={postData.caption}></img>\r\n\t\t\t<div className=\"side\">\r\n\t\t\t\t<div className=\"poster\">\r\n\t\t\t\t\t<Link to={`/${userInfo.username}`}><div className=\"profile-pic outlined round\"><img src={userInfo.profilePic} alt=\"Profile Pic\"></img></div></Link>\r\n\t\t\t\t\t<Link to={`/${userInfo.username}`} className=\"username\">{userInfo.username}</Link>\r\n\t\t\t\t\t<VerifiedTick size={15} user={userInfo} marginLeft={7.5}/>\r\n\t\t\t\t\t{postData.user === currentUser.user.uid && <button className=\"icon\" style={{width: 15, height: 15}} onClick={() => setIsDialogBoxOpen(true)}><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6 12c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3zm9 0c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3zm9 0c0 1.657-1.343 3-3 3s-3-1.343-3-3 1.343-3 3-3 3 1.343 3 3z\"/></svg></button>}\r\n\t\t\t\t\t{currentUser.info.uid === userInfo.uid ? null : <FollowButton target={userInfo}></FollowButton>}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"comments\">\r\n\t\t\t\t\t{ postData.caption.length === 0 ||\r\n\t\t\t\t\t\t<Comment\r\n\t\t\t\t\t\t\tcommentData={{user: postData.user, comment: postData.caption, timestamp: postData.timestamp}}\r\n\t\t\t\t\t\t\tnoLike\r\n\t\t\t\t\t\t\tnoLikesCounter\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t}\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcomments.map(comment =>\r\n\t\t\t\t\t\t\t<Comment\r\n\t\t\t\t\t\t\t\tcommentData={comment}\r\n\t\t\t\t\t\t\t\tpostPath={postPath}\r\n\t\t\t\t\t\t\t\tkey={comment.id}\r\n\t\t\t\t\t\t\t\tsetLikesWindow={setLikesWindow}\r\n\t\t\t\t\t\t\t\trefreshComments={getPostComments}\r\n\t\t\t\t\t\t\t/>)\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"info\">\r\n\t\t\t\t\t<div className=\"interactions\">\r\n\t\t\t\t\t\t<div style={{display: \"flex\"}}>\r\n\t\t\t\t\t\t\t<Like target={postData} postPath={postPath}/>\r\n\t\t\t\t\t\t\t<button className=\"comment-bubble icon\"><svg width=\"25\" height=\"25\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M12 1c-6.338 0-12 4.226-12 10.007 0 2.05.739 4.063 2.047 5.625l-1.993 6.368 6.946-3c1.705.439 3.334.641 4.864.641 7.174 0 12.136-4.439 12.136-9.634 0-5.812-5.701-10.007-12-10.007m0 1c6.065 0 11 4.041 11 9.007 0 4.922-4.787 8.634-11.136 8.634-1.881 0-3.401-.299-4.946-.695l-5.258 2.271 1.505-4.808c-1.308-1.564-2.165-3.128-2.165-5.402 0-4.966 4.935-9.007 11-9.007\"/></svg></button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<Save target={postData}/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<span className=\"likes\" onClick={() => setLikesWindow(postData.likes)}><span className=\"number\">{postData.likes.length}</span> likes</span>\r\n\t\t\t\t\t<span className=\"timestamp\" title={format(fromUnixTime(postData.timestamp.seconds), \"d MMM, yyyy\")}>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tgetYear(fromUnixTime(postData.timestamp.seconds)) === getYear(new Date())\r\n\t\t\t\t\t\t\t\t? format(fromUnixTime(postData.timestamp.seconds), \"d MMMM\")\r\n\t\t\t\t\t\t\t\t: format(fromUnixTime(postData.timestamp.seconds), \"d MMMM, yyyy\")\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<form className=\"add-comment-container\" onSubmit={handleAddComment}>\r\n\t\t\t\t\t<textarea className={commentLoading ? \"add-comment disabled\" : \"add-comment\"} placeholder=\"Add a comment...\" ref={addComment} onChange={() => addComment.current.value.length > 0 ? setIsInfoValid(true) : setIsInfoValid(false)} onKeyDown={handleTextareaEnter}/>\r\n\t\t\t\t\t<button className={`${isInfoValid ? \"text\" : \"text disabled\"}`}>Post</button>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default PostWindow;\r\n","import { useEffect, useRef, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\n//import { useMediaQuery } from \"react-responsive\";\r\nimport { db } from \"../firebase\";\r\nimport { collectionGroup, doc, getDoc, getDocs, query, where } from \"@firebase/firestore\";\r\nimport { startLoading, stopLoading } from \"../state/actions/isLoading\";\r\nimport PostWindow from \"./Posts/PostWindow\";\r\n\r\nconst HomePage = () =>\r\n{\r\n\tconst postsRef = useRef();\r\n\tconst dispatch = useDispatch();\r\n\tconst currentUser = useSelector(state => state.currentUser.info);\r\n\tconst [maxDate, setMaxDate] = useState(null);\r\n\tconst [scroll, setScroll] = useState(0);\r\n\tconst [olderPosts, setOlderPosts] = useState(null);\r\n\tconst [postsToDisplay, setPostsToDisplay] = useState(null);\r\n\t//const [left, setLeft] = useState(null);\r\n\t//const setNewLeft = () => postsRef.current ? setLeft(parseInt(window.getComputedStyle(postsRef.current).marginLeft) + parseInt(window.getComputedStyle(postsRef.current).width)) : null;\r\n\t//const smallScreenQuery = useMediaQuery({query: \"(max-width: 1024px)\"});\r\n\r\n\tconst handleScroll = () =>\r\n\t{\r\n\t\tconst winScroll = document.body.scrollTop || document.documentElement.scrollTop;\r\n\t\tconst height = document.documentElement.scrollHeight - document.documentElement.clientHeight;\r\n  \tsetScroll(winScroll / height * 100);\r\n\t};\r\n\tuseEffect(handleScroll, []);\r\n\r\n\tuseEffect(() => document.title = \"Instadicey\", []);\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst getPosts = async () =>\r\n\t\t{\r\n\t\t\tif (!currentUser) return;\r\n\t\t\tdispatch(startLoading());\r\n\t\t\tconst currentUserFollowing = await getDoc(doc(db, \"users\", currentUser.uid, \"user_follows\", \"following\"))\r\n\t\t\t\t.then(doc => doc.data())\r\n\t\t\t\t.then(data => data ? data.following : []);\r\n\t\t\tif (currentUserFollowing.length > 0)\r\n\t\t\t{\r\n\t\t\t\tconst maximumDate = new Date(new Date().getTime() - (3 * 24 * 60 * 60 * 1000));\r\n\t\t\t\tsetMaxDate(maximumDate);\r\n\t\t\t\tconst q = query(collectionGroup(db, \"user_posts\"), where(\"user\", \"in\", currentUserFollowing), where(\"timestamp\", \">=\", maximumDate));\r\n\t\t\t\tlet posts = await getDocs(q).then(querySnapshot => querySnapshot.docs.map(doc => doc.data()));\r\n\t\t\t\tposts = posts.sort((a, b) => a.timestamp.seconds < b.timestamp.seconds ? 1 : -1);\r\n\t\t\t\tsetPostsToDisplay(posts);\r\n\t\t\t} else setPostsToDisplay([]);\r\n\t\t\tdispatch(stopLoading());\r\n\t\t};\r\n\t\tgetPosts();\r\n\t}, [currentUser, dispatch]);\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tif (scroll < 75 || !maxDate || olderPosts) return;\r\n\r\n\t\tconst getOlderPosts = async () =>\r\n\t\t{\r\n\t\t\tconst currentUserFollowing = await getDoc(doc(db, \"users\", currentUser.uid, \"user_follows\", \"following\")).then(doc => doc.data().following);\r\n\t\t\tif (currentUserFollowing.length > 0)\r\n\t\t\t{\r\n\t\t\t\tconst q = query(collectionGroup(db, \"user_posts\"), where(\"user\", \"in\", currentUserFollowing), where(\"timestamp\", \"<=\", maxDate));\r\n\t\t\t\tlet posts = await getDocs(q).then(querySnapshot => querySnapshot.docs.map(doc => doc.data()));\r\n\t\t\t\tposts = posts.sort((a, b) => a.timestamp.seconds < b.timestamp.seconds ? 1 : -1);\r\n\t\t\t\tsetOlderPosts(posts);\r\n\t\t\t} else setOlderPosts([]);\r\n\t\t};\r\n\t\tgetOlderPosts();\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, [scroll, currentUser, maxDate]);\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\twindow.addEventListener(\"scroll\", handleScroll);\r\n\t\t//window.addEventListener(\"resize\", setNewLeft);\r\n\t\treturn () =>\r\n\t\t{\r\n\t\t\twindow.removeEventListener(\"scroll\", handleScroll);\r\n\t\t\t//window.removeEventListener(\"resize\", setNewLeft);\r\n\t\t};\r\n\t}, [postsRef]);\r\n\r\n\tif (!postsToDisplay) return null;\r\n\treturn(\r\n\t\t<div className=\"home-page\">\r\n\t\t\t{/* { (left && !smallScreenQuery) &&\r\n\t\t\t\t<div className=\"sidebar\" style={{left}}>\r\n\t\t\t\t\t<div style={{display: \"flex\", alignItems: \"center\"}}>\r\n\t\t\t\t\t\t<Link to={`/${currentUser.username}`}><div className=\"profile-pic\" style={{width: 50, height: 50}}><img src={currentUser.profilePic} alt={`${currentUser.username}'s profile pic`}></img></div></Link>\r\n\t\t\t\t\t\t<Link to={`/${currentUser.username}`} className=\"username\">{currentUser.username}</Link>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div> */\r\n\t\t\t}\r\n\t\t\t{\r\n\t\t\t\tpostsToDisplay &&\r\n\t\t\t\t<div className=\"posts\" ref={postsRef}>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tpostsToDisplay.map(post =>\r\n\t\t\t\t\t\t\t<PostWindow postID={post.id} isVertical key={post.id}/>)\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t}\r\n\t\t\t{ olderPosts &&\r\n\t\t\t\t\t<div className=\"older-posts posts\" ref={postsRef}>\r\n\t\t\t\t\t\t<h2>Showing posts older than 3 days</h2>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tolderPosts.map(post =>\r\n\t\t\t\t\t\t\t\t<PostWindow postID={post.id} isVertical key={post.id}/>)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default HomePage;\r\n","import { useEffect } from \"react\";\r\n\r\nconst BrokenPage = () =>\r\n{\r\n\tuseEffect(() => document.title = \"Page Not Found  Instadicey\", []);\r\n\r\n\treturn(\r\n\t\t<div id=\"broken-page\">\r\n\t\t\t<h1>Sorry, this page isn't available.</h1>\r\n\t\t\t<h2>The link you followed may be broken, or the page may have been removed.</h2>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default BrokenPage;\r\n","import { useEffect, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { db } from \"../../firebase\";\r\nimport { collection, collectionGroup, getDocs, query, where } from \"@firebase/firestore\";\r\nimport Loading from \"../../assets/misc/loading.jpg\";\r\n\r\nconst PostCard = ({postID}) =>\r\n{\r\n\tconst [isHovered, setIsHovered] = useState(false);\r\n\tconst [postData, setPostData] = useState(null);\r\n\tconst [comments, setComments] = useState(null);\r\n\tconst getPostData = async () =>\r\n\t{\r\n\t\tconst post = await getDocs(query(collectionGroup(db, \"user_posts\"), where(\"id\", \"==\", postID)))\r\n\t\t\t.then(querySnapshot => querySnapshot.docs[0]);\r\n\t\tsetPostData(post.data());\r\n\t\treturn post.ref.path;\r\n\t};\r\n\tconst getPostComments = async path =>\r\n\t{\r\n\t\tconst commentsData = await getDocs(collection(db, `${path}/comments`))\r\n\t\t\t.then(querySnapshot => querySnapshot.docs.map(doc => doc.data()));\r\n\t\tsetComments(commentsData);\r\n\t};\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst getData = async () =>\r\n\t\t{\r\n\t\t\tconst path = await getPostData();\r\n\t\t\tawait getPostComments(path);\r\n\t\t};\r\n\t\tgetData();\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, []);\r\n\r\n\r\n\tif (!postData || !comments) return <div className=\"post-card loading outlined\"><div className=\"container\"><img src={Loading} alt=\"loading\" style={{height: \"25%\", position: \"absolute\", inset: 0, margin: \"auto\"}}></img></div></div>;\r\n\telse return(\r\n\t\t<div className=\"post-card\" onMouseOver={() => setIsHovered(true)} onMouseLeave={() => setIsHovered(false)}>\r\n\t\t\t<div className=\"container\">\r\n\t\t\t\t<Link to={`/p/${postData.id}`}>\r\n\t\t\t\t\t{ isHovered &&\r\n\t\t\t\t\t\t<div className=\"hovered\">\r\n\t\t\t\t\t\t\t<span><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\"><path d=\"M12 4.248c-3.148-5.402-12-3.825-12 2.944 0 4.661 5.571 9.427 12 15.808 6.43-6.381 12-11.147 12-15.808 0-6.792-8.875-8.306-12-2.944z\"></path></svg> {postData.likes.length}</span>\r\n\t\t\t\t\t\t\t<span><svg xmlns=\"http://www.w3.org/2000/svg\" className=\"comment-bubble\" width=\"20\" height=\"20\" viewBox=\"0 0 24 24\"><path d=\"M.054 23c.971-1.912 2.048-4.538 1.993-6.368-1.308-1.562-2.047-3.575-2.047-5.625 0-5.781 5.662-10.007 12-10.007 6.299 0 12 4.195 12 10.007 0 6.052-6.732 11.705-15.968 9.458-1.678 1.027-5.377 2.065-7.978 2.535z\"/></svg> {comments.length}</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t}\r\n\t\t\t\t\t<img src={postData.photo} alt={postData.caption}></img>\r\n\t\t\t\t</Link>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default PostCard;\r\n","import { useEffect, useState } from \"react\";\r\nimport { Route, Switch, useParams } from \"react-router\";\r\nimport { Link, NavLink } from \"react-router-dom\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { db } from \"../firebase\";\r\nimport { collection, getDocs, query, where } from \"@firebase/firestore\";\r\nimport { startLoading, stopLoading } from \"../state/actions/isLoading\";\r\nimport BrokenPage from \"./BrokenPage\";\r\nimport FollowButton from \"./FollowButton\";\r\nimport FollowWindow from \"./FollowWindow\";\r\nimport LoadingPage from \"./LoadingPage\";\r\nimport PostCard from \"./Posts/PostCard\";\r\nimport VerifiedTick from \"./VerifiedTick\";\r\nimport \"./user-profile.css\";\r\n\r\nconst UserProfile = () =>\r\n{\r\n\tconst { username } = useParams();\r\n\r\n\tconst dispatch = useDispatch();\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst [userInfo, setUserInfo] = useState(null);\r\n\tconst [userFollows, setUserFollows] = useState(null);\r\n\tconst [userPosts, setUserPosts] = useState([]);\r\n\tconst [isFollowingListWindowOpen, setIsFollowingListWindowOpen] = useState(false);\r\n\tconst [isFollowersListWindowOpen, setIsFollowersListWindowOpen] = useState(false);\r\n\tconst closeFollowListWindow = () =>\r\n\t{\r\n\t\tsetIsFollowingListWindowOpen(false);\r\n\t\tsetIsFollowersListWindowOpen(false);\r\n\t};\r\n\r\n\tconst getUserInfo = async () =>\r\n\t{\r\n\t\tconst usersRef = collection(db, \"users\");\r\n\t\tconst q = query(usersRef, where(\"username\", \"==\", username));\r\n\t\tconst querySnapshot = await getDocs(q);\r\n\t\treturn querySnapshot;\r\n\t};\r\n\r\n\tconst getUsersFollows = async uid =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tconst userFollows = await getDocs(collection(db, \"users\", uid, \"user_follows\")).then(querySnapshot => Object.assign({}, ...querySnapshot.docs.map(doc => doc.data())));\r\n\t\t\tif (!!userFollows.following === false)\r\n\t\t\t\tuserFollows.following = [];\r\n\t\t\tif (!!userFollows.followers === false)\r\n\t\t\t\tuserFollows.followers = [];\r\n\t\t\tsetUserFollows(userFollows);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(\"Error getting user follows\", err.message);\r\n\t\t}\r\n\t};\r\n\r\n\tconst getUsersPosts = async uid =>\r\n\t{\r\n\t\tconst querySnapshot = await getDocs(collection(db, \"users\", uid, \"user_posts\"));\r\n\t\tconst posts = querySnapshot.docs.map(doc => doc.data()).sort((a, b) => a.timestamp.seconds > b.timestamp.seconds ? -1 : 1);\r\n\t\tsetUserPosts(posts);\r\n\t};\r\n\r\n\tconst fetchUserInfo = async () =>\r\n\t{\r\n\t\tconst querySnapshot = await getUserInfo();\r\n\t\tif (querySnapshot.size === 0) return setUserInfo(false);\r\n\r\n\t\tconst userData = querySnapshot.docs[0].data();\r\n\t\tif (querySnapshot.size === 1) setUserInfo(userData);\r\n\r\n\t\tawait getUsersPosts(userData.uid);\r\n\r\n\t\tawait getUsersFollows(userData.uid);\r\n\t};\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tcloseFollowListWindow();\r\n\r\n\t\tconst getData = async () =>\r\n\t\t{\r\n\t\t\tdispatch(startLoading());\r\n\t\t\tawait fetchUserInfo();\r\n\t\t\tdispatch(stopLoading());\r\n\t\t};\r\n\t\tgetData();\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, [username]);\r\n\t\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tif (!userInfo) return;\r\n\t\tuserInfo.realName\r\n\t\t\t?\tdocument.title = `${userInfo.realName} (@${userInfo.username})  Instadicey`\r\n\t\t\t: document.title = `@${userInfo.username}  Instadicey`;\r\n\t}, [userInfo]);\r\n\r\n\tif (userInfo === false) return <BrokenPage/>;\r\n\telse if (!userInfo || !currentUser || !userFollows) return <LoadingPage/>;\r\n\telse return(\r\n\t\t<div className=\"user-profile\">\r\n\t\t\t{ isFollowingListWindowOpen\r\n\t\t\t\t? <FollowWindow title=\"Following\" uids={userFollows.following} closeFollowListWindow={closeFollowListWindow}/>\r\n\t\t\t\t: isFollowersListWindowOpen\r\n\t\t\t\t\t? <FollowWindow title=\"Followers\" uids={userFollows.followers} closeFollowListWindow={closeFollowListWindow}/>\r\n\t\t\t\t\t: null\r\n\t\t\t}\r\n\t\t\t<div className=\"upper\">\r\n\t\t\t\t<div className=\"personal-info\">\r\n\t\t\t\t\t<div className=\"profile-pic\"><img src={userInfo.profilePic} alt={`${username}'s profile pic`}></img></div>\r\n\t\t\t\t\t<div className=\"info\">\r\n\t\t\t\t\t\t<div className=\"name\">\r\n\t\t\t\t\t\t\t{userInfo.username}\r\n\t\t\t\t\t\t\t<VerifiedTick user={userInfo}/>\r\n\t\t\t\t\t\t\t{ currentUser\r\n\t\t\t\t\t\t\t\t? userInfo.uid === currentUser.info.uid\r\n\t\t\t\t\t\t\t\t\t? <Link to=\"/accounts/edit\" className=\"edit-profile-btn outlined\">Edit Profile</Link>\r\n\t\t\t\t\t\t\t\t\t: <FollowButton target={userInfo}/>\r\n\t\t\t\t\t\t\t\t: <FollowButton target={userInfo}/>\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"follow\">\r\n\t\t\t\t\t\t\t<span className=\"posts\"><span className=\"number\">{userPosts.length}</span> posts</span>\r\n\t\t\t\t\t\t\t<span className=\"followers\" onClick={() => setIsFollowersListWindowOpen(true)}><span className=\"number\">{userFollows.followers.length}</span> followers</span>\r\n\t\t\t\t\t\t\t<span className=\"following\" onClick={() => setIsFollowingListWindowOpen(true)}><span className=\"number\">{userFollows.following.length}</span> following</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"bio\">\r\n\t\t\t\t\t\t\t<span className=\"real-name\">{userInfo.realName}</span>\r\n\t\t\t\t\t\t\t<div className=\"bio-text\">{userInfo.bio}</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<nav>\r\n\t\t\t\t<ul>\r\n\t\t\t\t\t<li><NavLink exact to={`/${userInfo.username}`} activeClassName=\"selected\"><svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" viewBox=\"0 0 24 24\"><path d=\"M6 6h-6v-6h6v6zm9-6h-6v6h6v-6zm9 0h-6v6h6v-6zm-18 9h-6v6h6v-6zm9 0h-6v6h6v-6zm9 0h-6v6h6v-6zm-18 9h-6v6h6v-6zm9 0h-6v6h6v-6zm9 0h-6v6h6v-6z\"/></svg> POSTS</NavLink></li>\r\n\t\t\t\t\t{currentUser.user.uid === userInfo.uid && <li><NavLink exact to={`/${userInfo.username}/saved`} activeClassName=\"selected\"><svg xmlns=\"http://www.w3.org/2000/svg\" className=\"icon\" viewBox=\"0 0 24 24\"><path d=\"M16 2v17.582l-4-3.512-4 3.512v-17.582h8zm2-2h-12v24l6-5.269 6 5.269v-24z\"/></svg> SAVED</NavLink></li>}\r\n\t\t\t\t</ul>\r\n\t\t\t</nav>\r\n\t\t\t<Switch>\r\n\t\t\t\t<Route exact path=\"/:username\">\r\n\t\t\t\t\t<div className=\"post-cards-container\">\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tuserPosts.map(post =>\r\n\t\t\t\t\t\t\t\t<PostCard postID={post.id} key={post.id}/>)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Route>\r\n\t\t\t\t<Route exact path=\"/:username/saved\">\r\n\t\t\t\t\t<div className=\"post-cards-container\">\r\n\t\t\t\t\t\t{ currentUser.user.uid === userInfo.uid &&\r\n\t\t\t\t\t\t\tuserInfo.saved.map(post =>\r\n\t\t\t\t\t\t\t\t<PostCard postID={post} key={post}/>)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Route>\r\n\t\t\t</Switch>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default UserProfile;\r\n","import { useEffect, useRef, useState } from \"react\";\r\nimport { useHistory } from \"react-router\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { db, storage } from \"../../firebase\";\r\nimport { doc, serverTimestamp, setDoc, } from \"@firebase/firestore\";\r\nimport { getDownloadURL, ref, uploadBytes } from \"@firebase/storage\";\r\nimport store from \"../../state\";\r\nimport { startLoading, stopLoading } from \"../../state/actions/isLoading\";\r\nimport { setNewPost } from \"../../state/actions/newPost\";\r\nimport { setSnackbar } from \"../../state/actions/snackbar\";\r\nimport { nanoid } from \"nanoid\";\r\nimport Cropper from \"react-easy-crop\";\r\n\r\nconst NewPost = () =>\r\n{\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst photo = useSelector(state => state.newPost);\r\n\tconst [photoUrl, setPhotoUrl] = useState(\"\");\r\n\tconst [crop, setCrop] = useState({ x: 0, y: 0 });\r\n\tconst [zoom, setZoom] = useState(1);\r\n\tconst [rotation, setRotation] = useState(0);\r\n\tconst [croppedAreaPixels, setCroppedAreaPixels] = useState(null);\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\tuseEffect(() => currentUser ? dispatch(stopLoading()) : dispatch(startLoading()), [photoUrl, currentUser]);\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tif (!photo) return;\r\n\t\tconst reader = new FileReader();\r\n\t\treader.readAsDataURL(photo);\r\n\t\treader.onloadend = () => setPhotoUrl(reader.result);\r\n\t}, [photo]);\r\n\r\n\tconst captionRef = useRef();\r\n\tconst dispatch = useDispatch();\r\n\tconst history = useHistory();\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst photo = store.getState().newPost;\r\n\t\tif (!photo) return history.push(\"/\");\r\n\r\n\t\treturn () => dispatch(setNewPost(null));\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t},[]);\r\n\r\n\tconst { getCroppedImg } = foo;\r\n\r\n\tconst cancel = () => history.push(\"/\");\r\n\r\n\tconst share = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tdispatch(startLoading());\r\n\t\t\tconst postID = nanoid(32);\r\n\t\t\tconst caption = captionRef.current.value;\r\n\t\t\tconst croppedPhoto = await getCroppedImg(photoUrl, croppedAreaPixels, rotation);\r\n\r\n\t\t\tconst postPhotoRef = ref(storage, `users/${currentUser.user.uid}/posts/${postID}.png`);\r\n\t\t\tawait uploadBytes(postPhotoRef, croppedPhoto);\r\n\t\t\tconst postUrl = await getDownloadURL(postPhotoRef);\r\n\t\t\tawait setDoc(doc(db, \"users\", currentUser.user.uid, \"user_posts\", postID),\r\n\t\t\t\t{\r\n\t\t\t\t\tphoto: postUrl,\r\n\t\t\t\t\tcaption,\r\n\t\t\t\t\tuser: currentUser.user.uid,\r\n\t\t\t\t\tlikes: [],\r\n\t\t\t\t\tid: postID,\r\n\t\t\t\t\ttimestamp: serverTimestamp(),\r\n\t\t\t\t});\r\n\r\n\t\t\tdispatch(setSnackbar(\"Post uploaded.\", \"success\"));\r\n\t\t\thistory.push(`/p/${postID}`);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tdispatch(stopLoading());\r\n\t\t\tconsole.error(err);\r\n\t\t\tdispatch(setSnackbar(\"Oops, try again later.\", \"error\"));\r\n\t\t}\r\n\t};\r\n\r\n\tif (!currentUser || !photoUrl) return null;\r\n\treturn(\r\n\t\t<div className=\"new-post\">\r\n\t\t\t<div className=\"header\">\r\n\t\t\t\t<button className=\"cancel text\" onClick={cancel}><svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"currentColor\" className=\"bi bi-x-lg\" viewBox=\"0 0 16 16\"><path d=\"M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z\"/></svg></button>\r\n\t\t\t\tNew Photo Post\r\n\t\t\t\t<button className=\"text\" onClick={share}>Share</button>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"cropper-container\">\r\n\t\t\t\t<Cropper\r\n\t\t\t\t\timage={photoUrl}\r\n\t\t\t\t\tcrop={crop}\r\n\t\t\t\t\tzoom={zoom}\r\n\t\t\t\t\tzoomSpeed={0.5}\r\n\t\t\t\t\tonCropChange={setCrop}\r\n\t\t\t\t\tonZoomChange={setZoom}\r\n\t\t\t\t\tonRotationChange={setRotation}\r\n\t\t\t\t\tonCropComplete={(croppedArea, croppedAreaPixels) => setCroppedAreaPixels(croppedAreaPixels)}\r\n\t\t\t\t\taspect={1}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"caption-container outlined\">\r\n\t\t\t\t<div className=\"profile-pic outlined round\"><img src={currentUser.info.profilePic} alt=\"profile pic\"></img></div>\r\n\t\t\t\t<textarea className=\"caption\" placeholder=\"Write a caption...\" ref={captionRef}></textarea>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nconst foo = (() =>\r\n{\r\n\tconst createImage = url =>\r\n\t\tnew Promise((resolve, reject) => {\r\n\t\t\tconst image = new Image();\r\n\t\t\timage.addEventListener(\"load\", () => resolve(image));\r\n\t\t\timage.addEventListener(\"error\", error => reject(error));\r\n\t\t\timage.setAttribute(\"crossOrigin\", \"anonymous\"); // needed to avoid cross-origin issues on CodeSandbox\r\n\t\t\timage.src = url;\r\n\t\t});\r\n\r\n\tfunction getRadianAngle(degreeValue) {\r\n\t\treturn (degreeValue * Math.PI) / 180;\r\n\t}\r\n\r\n\t/**\r\n\t * This function was adapted from the one in the ReadMe of https://github.com/DominicTobias/react-image-crop\r\n\t * @param {File} image - Image File url\r\n\t * @param {Object} pixelCrop - pixelCrop Object provided by react-easy-crop\r\n\t * @param {number} rotation - optional rotation parameter\r\n\t */\r\n\tconst getCroppedImg = async (imageSrc, pixelCrop, rotation = 0) => {\r\n\t\tconst image = await createImage(imageSrc);\r\n\t\tconst canvas = document.createElement(\"canvas\");\r\n\t\tconst ctx = canvas.getContext(\"2d\");\r\n\r\n\t\tconst maxSize = Math.max(image.width, image.height);\r\n\t\tconst safeArea = 2 * ((maxSize / 2) * Math.sqrt(2));\r\n\r\n\t\t// set each dimensions to double largest dimension to allow for a safe area for the\r\n\t\t// image to rotate in without being clipped by canvas context\r\n\t\tcanvas.width = safeArea;\r\n\t\tcanvas.height = safeArea;\r\n\r\n\t\t// translate canvas context to a central location on image to allow rotating around the center.\r\n\t\tctx.translate(safeArea / 2, safeArea / 2);\r\n\t\tctx.rotate(getRadianAngle(rotation));\r\n\t\tctx.translate(-safeArea / 2, -safeArea / 2);\r\n\r\n\t\t// draw rotated image and store data.\r\n\t\tctx.drawImage(\r\n\t\t\timage,\r\n\t\t\tsafeArea / 2 - image.width * 0.5,\r\n\t\t\tsafeArea / 2 - image.height * 0.5\r\n\t\t);\r\n\t\tconst data = ctx.getImageData(0, 0, safeArea, safeArea);\r\n\r\n\t\t// set canvas width to final desired crop size - this will clear existing context\r\n\t\tcanvas.width = pixelCrop.width;\r\n\t\tcanvas.height = pixelCrop.height;\r\n\r\n\t\t// paste generated rotate image with correct offsets for x,y crop values.\r\n\t\tctx.putImageData(\r\n\t\t\tdata,\r\n\t\t\tMath.round(0 - safeArea / 2 + image.width * 0.5 - pixelCrop.x),\r\n\t\t\tMath.round(0 - safeArea / 2 + image.height * 0.5 - pixelCrop.y)\r\n\t\t);\r\n\r\n\t\t// As Base64 string\r\n\t\t// return canvas.toDataURL(\"image/jpeg\");\r\n\r\n\t\t// As a blob\r\n\t\treturn new Promise(resolve => canvas.toBlob(file => resolve(file), \"image/png\"));\r\n\t};\r\n\r\n\treturn { getCroppedImg };\r\n})();\r\n\r\nexport default NewPost;\r\n","import { useEffect, useState } from \"react\";\r\nimport { useParams } from \"react-router\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { db } from \"../../firebase\";\r\nimport { collection, collectionGroup, getDocs, limit, query, where } from \"@firebase/firestore\";\r\nimport { startLoading, stopLoading } from \"../../state/actions/isLoading\";\r\nimport PostWindow from \"./PostWindow\";\r\nimport PostCard from \"./PostCard\";\r\nimport BrokenPage from \"../BrokenPage\";\r\nimport \"./post-page.css\";\r\n\r\nconst PostPage = () =>\r\n{\r\n\tconst { postID } = useParams();\r\n\tconst dispatch = useDispatch();\r\n\tconst [postExists, setPostExists] = useState(false);\r\n\tconst [morePosts, setMorePosts] = useState(null);\r\n\tconst [isSmallScreen, setIsSmallScreen] = useState(false);\r\n\tconst handleResize = () => window.innerWidth < 1024 ? setIsSmallScreen(true) : setIsSmallScreen(false);\r\n\tuseEffect(() =>\r\n\t{\r\n\t\thandleResize();\r\n\t\twindow.addEventListener(\"resize\", handleResize);\r\n\t\treturn () => window.removeEventListener(\"resize\", handleResize);\r\n\t}, []);\r\n\r\n\tconst checkIfPostExists = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tdispatch(startLoading());\r\n\t\t\tconst q = query(collectionGroup(db, \"user_posts\"), where(\"id\", \"==\", postID));\r\n\t\t\tconst querySnapshot = await getDocs(q);\r\n\t\t\tif (!querySnapshot.docs[0]) throw Error(\"Post doesn't exist\");\r\n\t\t\tsetPostExists(true);\r\n\t\t\tgetMorePosts(querySnapshot.docs[0].data());\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tif (err.message === \"Post doesn't exist\")\r\n\t\t\t\tsetPostExists(false);\r\n\t\t}\r\n\t\tdispatch(stopLoading());\r\n\t};\r\n\r\n\tconst getMorePosts = async postData =>\r\n\t{\r\n\t\tconst q = query(collection(db, `users/${postData.user}/user_posts`), where(\"id\", \"!=\", postData.id), limit(6));\r\n\t\tconst morePosts = await getDocs(q).then(querySnapshot => querySnapshot.docs.map(doc => doc.data()).sort((a, b) => a.timestamp.seconds < b.timestamp.seconds ? 1 : -1));\r\n\t\tconsole.error(morePosts);\r\n\t\tsetMorePosts(morePosts);\r\n\t};\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tsetPostExists(false);\r\n\t\tcheckIfPostExists();\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, [postID]);\r\n\r\n\tif (!postExists) return <BrokenPage/>;\r\n\telse return(\r\n\t\t<div className=\"post-page\">\r\n\t\t\t{\r\n\t\t\t\tisSmallScreen\r\n\t\t\t\t\t? <PostWindow postID={postID} isVertical/>\r\n\t\t\t\t\t: <PostWindow postID={postID}/>\r\n\t\t\t}\r\n\t\t\t<div className=\"more-posts\">\r\n\t\t\t\t<header>More posts from this user</header>\r\n\t\t\t\t{ morePosts &&\r\n\t\t\t\t\t<div className=\"post-cards-container\">\r\n\t\t\t\t\t\t{ morePosts.map(post => <PostCard postID={post.id} key={post.id}/>) }\r\n\t\t\t\t\t</div>\r\n\t\t\t\t}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default PostPage;\r\n","import { Link } from \"react-router-dom\";\r\n\r\nconst Message = ({messageInfo, userInfo, noPhoto, isSent}) =>\r\n{\r\n\treturn(\r\n\t\t<div className={`message ${isSent ? \"sent\" : \"\"}`}>\r\n\t\t\t{ noPhoto\r\n\t\t\t\t? <span className=\"dummy\" style={{width: 32, height: 32}}></span>\r\n\t\t\t\t: <Link to={`/${userInfo.username}`} className=\"profile-pic\"><img src={userInfo.profilePic} alt={`${userInfo.username}'s profile pic`}></img></Link>\r\n\t\t\t}\r\n\t\t\t<span className=\"text outlined round\">{messageInfo.message}</span>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Message;\r\n","import { useEffect, useRef, useState } from \"react\";\r\nimport { useHistory } from \"react-router\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { db } from \"../../firebase\";\r\nimport { collection, doc, getDoc, getDocs, onSnapshot, orderBy, query, serverTimestamp, setDoc, updateDoc } from \"@firebase/firestore\";\r\nimport { nanoid } from \"nanoid\";\r\nimport Message from \"./Message\";\r\n\r\nconst Room = ({roomID}) =>\r\n{\r\n\tconst history = useHistory();\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst messageRef = useRef();\r\n\tconst [otherUser, setOtherUser] = useState(null);\r\n\tconst [messages, setMessages] = useState(null);\r\n\tconst [isLoading, setIsLoading] = useState(false);\r\n\r\n\tconst getOtherUserInfo = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tconst roomInfo = await getDoc(doc(db, \"chats\", roomID)).then(doc => doc.data());\r\n\t\t\tif (!roomInfo) throw new Error(\"Room doesn't exist\");\r\n\t\t\tconst otherUserUid = roomInfo.members.filter(member => member !== currentUser.info.uid)[0];\r\n\t\t\tconst otherUser = await getDoc(doc(db, \"users\", otherUserUid)).then(doc => doc.data());\r\n\t\t\tsetOtherUser(otherUser);\r\n\t\t\treturn otherUser;\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t\tif (err.message === \"Room doesn't exist\")\r\n\t\t\t\thistory.push(\"/direct/inbox\");\r\n\t\t}\r\n\t};\r\n\r\n\tconst getMessages = async () =>\r\n\t{\r\n\t\ttry\r\n\t\t{\r\n\t\t\tconst q = query(collection(db, \"chats\", roomID, \"messages\"), orderBy(\"timestamp\", \"asc\"));\r\n\t\t\tconst messagesArray = await getDocs(q)\r\n\t\t\t\t.then(querySnapshot => querySnapshot.docs.map(doc => doc.data()));\r\n\t\t\tsetMessages(messagesArray);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t}\r\n\t};\r\n\r\n\tconst sendMessage = async e =>\r\n\t{\r\n\t\te.preventDefault();\r\n\t\ttry\r\n\t\t{\r\n\t\t\tsetIsLoading(true);\r\n\t\t\tconst message = messageRef.current.value;\r\n\t\t\tconst id = nanoid(32);\r\n\t\t\tif (message.trim() === \"\") throw new Error(\"Message is empty\");\r\n\r\n\t\t\tawait Promise.all(\r\n\t\t\t\t[\r\n\t\t\t\t\tsetDoc(doc(db, \"chats\", roomID, \"messages\", id),\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tid,\r\n\t\t\t\t\t\t\tmessage,\r\n\t\t\t\t\t\t\tuser: currentUser.user.uid,\r\n\t\t\t\t\t\t\ttimestamp: serverTimestamp(),\r\n\t\t\t\t\t\t}),\r\n\t\t\t\t\tupdateDoc(doc(db, \"chats\", roomID),\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tlastMessage: {id, message},\r\n\t\t\t\t\t\t\tlastUpdated: serverTimestamp(),\r\n\t\t\t\t\t\t})\r\n\t\t\t\t]\r\n\t\t\t);\r\n\r\n\t\t\tmessageRef.current.value = \"\";\r\n\t\t\tsetIsLoading(false);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect(() => document.title = \"Instadicey  Chats\");\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst q = query(collection(db, \"chats\", roomID, \"messages\"), orderBy(\"timestamp\", \"asc\"));\r\n\t\tconst unsubscribe = onSnapshot(q, querySnapshot => setMessages(querySnapshot.docs.map(doc => doc.data())));\r\n\r\n\t\treturn () => unsubscribe();\r\n\t}, [roomID]);\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst getData = async () =>\r\n\t\t{\r\n\t\t\tif (getOtherUserInfo())\r\n\t\t\t{\r\n\t\t\t\tgetMessages();\r\n\t\t\t}\r\n\t\t};\r\n\t\tgetData();\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, [roomID]);\r\n\r\n\tif (!otherUser || !messages) return null;\r\n\treturn(\r\n\t\t<div className=\"chat-room\">\r\n\t\t\t<header><Link to={`/${otherUser.username}`} style={{display: \"flex\", alignItems: \"center\"}}><span className=\"profile-pic\" style={{marginRight: \"1rem\"}}><img src={otherUser.profilePic} alt={`${otherUser.username}'s pic`}></img></span>{otherUser.username}</Link></header>\r\n\t\t\t<div className=\"messages\">\r\n\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tmessages.map((message, i, messagesArray) => \r\n\t\t\t\t\t\t\tmessage.user === currentUser.user.uid \r\n\t\t\t\t\t\t\t\t? <Message messageInfo={message} userInfo={currentUser.info} noPhoto isSent key={message.id}/> \r\n\t\t\t\t\t\t\t\t: messagesArray[i + 1] \r\n\t\t\t\t\t\t\t\t\t? messagesArray[i].user === messagesArray[i + 1].user\r\n\t\t\t\t\t\t\t\t\t\t? <Message messageInfo={message} userInfo={otherUser} noPhoto key={message.id}/>\r\n\t\t\t\t\t\t\t\t\t\t: <Message messageInfo={message} userInfo={otherUser} key={message.id}/>\r\n\t\t\t\t\t\t\t\t\t: <Message messageInfo={message} userInfo={otherUser} key={message.id}/>\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"send-message-container\">\r\n\t\t\t\t<form className=\"outlined round\" onSubmit={sendMessage}>\r\n\t\t\t\t\t<input className={`${isLoading ? \"disabled\" : \"\"}`} placeholder=\"Message...\" ref={messageRef}/>\r\n\t\t\t\t\t<button className=\"text\">Send</button>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Room;\r\n","export default __webpack_public_path__ + \"static/media/send-message.3a6be95e.png\";","import { useEffect, useState } from \"react\";\r\nimport { Route, useParams } from \"react-router\";\r\nimport { NavLink, Switch } from \"react-router-dom\";\r\nimport { useMediaQuery } from \"react-responsive\";\r\nimport { useSelector } from \"react-redux\";\r\nimport { db } from \"../../firebase\";\r\nimport { collection, doc, getDoc, getDocs, onSnapshot, query, where } from \"@firebase/firestore\";\r\nimport { formatDistanceToNowStrict, fromUnixTime } from \"date-fns\";\r\nimport Room from \"./Room\";\r\nimport FollowWindow from \"../FollowWindow\";\r\nimport LoadingPage from \"../LoadingPage\";\r\nimport SendMessage from \"../../assets/misc/send-message.png\";\r\nimport \"./inbox.css\";\r\n\r\nconst Inbox = () =>\r\n{\r\n\tconst { roomID } = useParams();\r\n\tconst currentUser = useSelector(state => state.currentUser);\r\n\tconst [currentUserFollows, setCurrentUserFollows] = useState(null);\r\n\tconst [recentChats, setRecentChats] = useState(null);\r\n\tconst [isNewMessageBoxOpen, setIsNewMessageBoxOpen] = useState(false);\r\n\tconst closeNewMessageBox = () => setIsNewMessageBoxOpen(false);\r\n\tconst phoneQuery = useMediaQuery({query: \"(max-width: 600px)\"});\r\n\r\n\tconst formatDate = date =>\r\n\t{\r\n\t\tlet dateStringArray = date.split(\" \");\r\n\t\tdateStringArray[1] = dateStringArray[1].slice(0, 1);\r\n\t\tconst dateString = dateStringArray.join(\" \");\r\n\t\treturn dateString;\r\n\t};\r\n\r\n\tconst getChats = async () =>\r\n\t{\r\n\t\tif (!currentUser) return;\r\n\t\ttry\r\n\t\t{\r\n\t\t\tconst q = query(collection(db, \"chats\"), where(\"members\", \"array-contains\", currentUser.user.uid));\r\n\t\t\tlet chats = await getDocs(q)\r\n\t\t\t\t.then(querySnapshot => querySnapshot.docs.map(doc => doc.data()))\r\n\t\t\t\t.then(chats => chats.filter(chat => chat.lastMessage ? chat : false))\r\n\t\t\t\t.then(chats => chats.sort((a,b) => a.lastUpdated < b.lastUpdated ? 1 : -1))\r\n\t\t\t\t.then(chats => Promise.all(chats.map(async chat =>\r\n\t\t\t\t{\r\n\t\t\t\t\tconst otherUser = await getDoc(doc(db, \"users\", chat.members.filter(user => user !== currentUser.user.uid)[0])).then(doc => doc.data());\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...chat,\r\n\t\t\t\t\t\totherUser,\r\n\t\t\t\t\t};\r\n\t\t\t\t})));\r\n\t\t\tsetRecentChats(chats);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t}\r\n\t};\r\n\r\n\tconst getUsersFollows = async () =>\r\n\t{\r\n\t\tif (!currentUser) return;\r\n\t\ttry\r\n\t\t{\r\n\t\t\tconst currentUserFollows = await getDocs(collection(db, \"users\", currentUser.user.uid, \"user_follows\")).then(querySnapshot => Object.assign({}, ...querySnapshot.docs.map(doc => doc.data())));\r\n\t\t\tif (!currentUserFollows.following)\r\n\t\t\t\tcurrentUserFollows.following = [];\r\n\t\t\tif (!currentUserFollows.followers)\r\n\t\t\t\tcurrentUserFollows.followers = [];\r\n\t\t\tsetCurrentUserFollows(currentUserFollows);\r\n\t\t} catch (err)\r\n\t\t{\r\n\t\t\tconsole.error(err);\r\n\t\t}\r\n\t};\r\n\t\r\n\tuseEffect(() => document.title = \"Inbox  Chats\");\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\tuseEffect(() => getUsersFollows(), [currentUser]);\r\n\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\tuseEffect(() => getChats(), [currentUser]);\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tif (!currentUser) return;\r\n\t\tconst q = query(collection(db, \"chats\"), where(\"members\", \"array-contains\", currentUser.user.uid));\r\n\t\tconst unsubscribe = onSnapshot(q, async querySnapshot =>\r\n\t\t{\r\n\t\t\tconst chats = querySnapshot.docs.map(doc => doc.data()).filter(chat => chat.lastMessage ? chat : false).sort((a, b) => a.lastUpdated < b.lastUpdated ? 1 : -1);\r\n\t\t\tconst recentChats = await Promise.all(chats.map(async chat =>\r\n\t\t\t{\r\n\t\t\t\tconst otherUser = await getDoc(doc(db, \"users\", chat.members.filter(user => user !== currentUser.user.uid)[0])).then(doc => doc.data());\r\n\t\t\t\treturn {\r\n\t\t\t\t\t...chat,\r\n\t\t\t\t\totherUser,\r\n\t\t\t\t};\r\n\t\t\t}));\r\n\t\t\tsetRecentChats(recentChats);\r\n\t\t});\r\n\r\n\t\treturn () => unsubscribe();\r\n\t}, [currentUser]);\r\n\r\n\tif (!currentUser || !recentChats) return <LoadingPage/>;\r\n\tif (phoneQuery)\r\n\t\treturn(\r\n\t\t\t<div className=\"inbox-window outlined\">\r\n\t\t\t\t{ isNewMessageBoxOpen &&\r\n\t\t\t\t\t\t<FollowWindow title=\"New Message\" uids={[...currentUserFollows.following, ...currentUserFollows.followers]} closeFollowListWindow={closeNewMessageBox} newMessage/>\r\n\t\t\t\t}\r\n\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t<Switch>\r\n\t\t\t\t\t\t<Route exact path=\"/direct/inbox\">\r\n\t\t\t\t\t\t\t<div className=\"recent-chats left\">\r\n\t\t\t\t\t\t\t\t<header>{currentUser.info.username}<button className=\"icon\" onClick={() => setIsNewMessageBoxOpen(true)}><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M8.071 21.586l-7.071 1.414 1.414-7.071 14.929-14.929 5.657 5.657-14.929 14.929zm-.493-.921l-4.243-4.243-1.06 5.303 5.303-1.06zm9.765-18.251l-13.3 13.301 4.242 4.242 13.301-13.3-4.243-4.243z\"/></svg></button></header>\r\n\t\t\t\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\trecentChats.map(chat =>\r\n\t\t\t\t\t\t\t\t\t\t\t<NavLink to={`/direct/t/${chat.id}`} activeClassName=\"selected\" key={chat.id}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<li key={chat.otherUser.uid}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"profile-pic\"><img src={chat.otherUser.profilePic} alt={`${chat.otherUser.currentUser}'s profile pic`}></img></span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"info\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"username\">{chat.otherUser.username}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"message\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div>{chat.lastMessage.message}</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span> {formatDate(formatDistanceToNowStrict(fromUnixTime(chat.lastUpdated ? chat.lastUpdated.seconds : 0)))}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t\t\t</NavLink>\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Route>\r\n\t\t\t\t\t\t<Route path=\"/direct/t/:roomID\">\r\n\t\t\t\t\t\t\t<Room roomID={roomID}/>\r\n\t\t\t\t\t\t</Route>\r\n\t\t\t\t\t</Switch>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\telse return(\r\n\t\t<div className=\"inbox-window outlined\">\r\n\t\t\t{ isNewMessageBoxOpen &&\r\n\t\t\t\t\t<FollowWindow title=\"New Message\" uids={[...currentUserFollows.following, ...currentUserFollows.followers]} closeFollowListWindow={closeNewMessageBox} newMessage/>\r\n\t\t\t}\r\n\t\t\t<div className=\"container\">\r\n\t\t\t\t<div className=\"recent-chats left\">\r\n\t\t\t\t\t<header>{currentUser.info.username}<button className=\"icon\" onClick={() => setIsNewMessageBoxOpen(true)}><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fillRule=\"evenodd\" clipRule=\"evenodd\"><path d=\"M8.071 21.586l-7.071 1.414 1.414-7.071 14.929-14.929 5.657 5.657-14.929 14.929zm-.493-.921l-4.243-4.243-1.06 5.303 5.303-1.06zm9.765-18.251l-13.3 13.301 4.242 4.242 13.301-13.3-4.243-4.243z\"/></svg></button></header>\r\n\t\t\t\t\t<ul>\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\trecentChats.map(chat =>\r\n\t\t\t\t\t\t\t\t<NavLink to={`/direct/t/${chat.id}`} activeClassName=\"selected\" key={chat.id}>\r\n\t\t\t\t\t\t\t\t\t<li key={chat.otherUser.uid}>\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"profile-pic\"><img src={chat.otherUser.profilePic} alt={`${chat.otherUser.currentUser}'s profile pic`}></img></span>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"info\">\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"username\">{chat.otherUser.username}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"message\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div>{chat.lastMessage.message}</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span> {formatDate(formatDistanceToNowStrict(fromUnixTime(chat.lastUpdated ? chat.lastUpdated.seconds : 0)))}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t</NavLink>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</ul>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"chat-window right\">\r\n\t\t\t\t\t<Switch>\r\n\t\t\t\t\t\t<Route exact path=\"/direct/inbox\">\r\n\t\t\t\t\t\t\t<div style={{height: \"100%\", display: \"flex\", flexDirection: \"column\", justifyContent: \"center\", alignItems: \"center\", gap: \"0.75rem\"}}>\r\n\t\t\t\t\t\t\t\t<div style={{height: 175}}><img src={SendMessage} alt=\"Send a message\"/></div>\r\n\t\t\t\t\t\t\t\t<span style={{fontWeight: 500, fontSize: \"1.25em\"}}>Your Messages</span>\r\n\t\t\t\t\t\t\t\t<span style={{color: \"#8e8e8e\", fontSize: \"0.95em\"}}>Send private photos and messages to a friend or group.</span>\r\n\t\t\t\t\t\t\t\t<button style={{width: \"initial\"}} onClick={() => setIsNewMessageBoxOpen(true)}>Send Message</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Route>\r\n\t\t\t\t\t\t<Route path=\"/direct/t/:roomID\"><Room roomID={roomID}/></Route>\r\n\t\t\t\t\t</Switch>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Inbox;\r\n","import { useEffect, useState } from \"react\";\r\nimport { Route, Switch, useLocation } from \"react-router\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { auth, db } from \"./firebase\";\r\nimport { onAuthStateChanged } from \"@firebase/auth\";\r\nimport { doc, getDoc } from \"@firebase/firestore\";\r\nimport { Snackbar, Slide, Alert } from \"@mui/material\";\r\nimport { stopLoading } from \"./state/actions/isLoading\";\r\nimport { setUser } from \"./state/actions/currentUser\";\r\nimport { closeSnackbar } from \"./state/actions/snackbar\";\r\n\r\nimport Navbar from \"./components/Navbar\";\r\nimport LoadingPage from \"./components/LoadingPage\";\r\n\r\nimport SignUpPage from \"./components/AccountAuth/SignUpPage\";\r\nimport PasswordReset from \"./components/AccountAuth/PasswordReset\";\r\nimport LoginPage from \"./components/AccountAuth/LoginPage\";\r\nimport AccountVerification from \"./components/AccountAuth/AccountVerification\";\r\nimport AccountEdit from \"./components/AccountEdit/AccountEdit\";\r\n\r\nimport HomePage from \"./components/HomePage\";\r\nimport UserProfile from \"./components/UserProfile\";\r\nimport newPost from \"./components/Posts/NewPost\";\r\nimport PostPage from \"./components/Posts/PostPage\";\r\n\r\nimport Inbox from \"./components/Inbox/Inbox\";\r\n\r\nimport BrokenPage from \"./components/BrokenPage\";\r\nimport \"./styles/App.css\";\r\n\r\nconst App = () =>\r\n{\r\n\tconst dispatch = useDispatch();\r\n\tconst location = useLocation();\r\n\tconst [navbarVisibility, setNavbarVisibility] = useState(true);\r\n\tconst isLoggedIn = useSelector(state => state.currentUser);\r\n\tconst isLoading = useSelector(state => state.loading);\r\n\tconst snackbar = useSelector(state => state.snackbar);\r\n\tsnackbar.handleClose = () => dispatch(closeSnackbar());\r\n\r\n\tuseEffect(() =>\r\n\t{\r\n\t\tconst url = location.pathname;\r\n\t\tif (url === \"/create/style\")\r\n\t\t\tsetNavbarVisibility(false);\r\n\t\telse setNavbarVisibility(true);\r\n\t}, [location.pathname]);\r\n\r\n\tconst checkIfLoggedIn = () =>\r\n\t{\r\n\t\tonAuthStateChanged(auth, async user =>\r\n\t\t{\r\n\t\t\tif (user && user.emailVerified)\r\n\t\t\t{\r\n\t\t\t\tconst info = await getDoc(doc(db, \"users\", user.uid)).then(doc => doc.data());\r\n\t\t\t\tdispatch(setUser({user, info}));\r\n\t\t\t\tdispatch(stopLoading());\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tdispatch(setUser(null));\r\n\t\t\t\tdispatch(stopLoading());\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\tuseEffect(checkIfLoggedIn, [dispatch]);\r\n\r\n\treturn (\r\n\t\t<div className=\"App\" style={isLoggedIn && navbarVisibility ? { paddingTop: \"75px\" } : null}>\r\n\t\t\t{ isLoggedIn && navbarVisibility ? <Navbar/> : null }\r\n\t\t\t{\r\n\t\t\t\tisLoading\r\n\t\t\t\t\t? <Route path=\"/\" component={LoadingPage}></Route>\r\n\t\t\t\t\t: null\r\n\t\t\t}\r\n\r\n\t\t\t<Switch>\r\n\t\t\t\t<Route exact path=\"/\">\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tisLoggedIn\r\n\t\t\t\t\t\t\t? <HomePage/>\r\n\t\t\t\t\t\t\t: <LoginPage/>\r\n\t\t\t\t\t}\r\n\t\t\t\t</Route>\r\n\t\t\t\t<Route exact path=\"/accounts/email-signup\" component={SignUpPage}></Route>\r\n\t\t\t\t<Route exact path=\"/accounts/password-reset\" component={PasswordReset}></Route>\r\n\t\t\t\t<Route path=\"/accounts/verify\" component={AccountVerification}></Route>\r\n\t\t\t\t\r\n\t\t\t\t<Route exact path=\"/accounts/edit\" component={AccountEdit}></Route>\r\n\t\t\t\t<Route exact path=\"/accounts/password/change\" component={AccountEdit}></Route>\r\n\r\n\t\t\t\t<Route exact path=\"/direct/inbox\" component={Inbox}></Route>\r\n\t\t\t\t<Route exact path=\"/direct/t/:roomID\" component={Inbox}></Route>\r\n\r\n\t\t\t\t<Route exact path=\"/:username\" component={UserProfile}></Route>\r\n\t\t\t\t<Route exact path=\"/:username/saved\" component={UserProfile}></Route>\r\n\t\t\t\t<Route exact path=\"/create/style\" component={newPost}></Route>\r\n\r\n\t\t\t\t<Route exact path=\"/p/:postID\" component={PostPage}></Route>\r\n\r\n\t\t\t\t<Route path=\"/\" component={BrokenPage}/>\r\n\t\t\t</Switch>\r\n\r\n\t\t\t<Snackbar\r\n\t\t\t\topen={snackbar.open}\r\n\t\t\t\tmessage={snackbar.message}\r\n\t\t\t\tautoHideDuration={5000}\r\n\t\t\t\tonClose={snackbar.handleClose}\r\n\t\t\t\tanchorOrigin={{ vertical: \"bottom\", horizontal: \"center\" }}\r\n\t\t\t\tTransitionComponent={Slide}\r\n\t\t\t\tclassName=\"snackbar\"\r\n\t\t\t>\r\n\t\t\t\t<Alert onClose={snackbar.handleClose} severity={snackbar.severity} icon={false}>{snackbar.message}</Alert>\r\n\t\t\t</Snackbar>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default App;\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { HashRouter as Router } from \"react-router-dom\";\r\nimport { Provider } from \"react-redux\";\r\nimport store from \"./state\";\r\nimport App from \"./App\";\r\nimport \"./styles/index.css\";\r\n\r\nReactDOM.render(\r\n\t<Router>\r\n\t\t<Provider store={store}>\r\n\t\t\t<React.StrictMode>\r\n\t\t\t\t<App />\r\n\t\t\t</React.StrictMode>\r\n\t\t</Provider>\r\n\t</Router>,\r\n\tdocument.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}